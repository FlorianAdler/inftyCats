\section{Category theory}\label{sec:CategoryTheory}
We assume you are familiar with categories, functors, natural transformations and the Yoneda lemma. In fact, you will probably be familiar with most of the stuff in this section, so we'll leave out many proofs (but give them later in the $\infty$-categorical context).

\subsection{Adjunctions}
\begin{defi}\label{def:1Adjunction}
	Let $L\colon \Cc\rightarrow \Dd$ be a functor.
	\begin{alphanumerate}
		\item Let $y\in \Dd$. An object $x\in \Cc$ is a \emph{right adjoint object to $y$ under $L$} if there exists an equivalence
		\begin{equation*}
			\Hom_\Cc\!\left(-,x\right)\simeq \Hom_\Dd\lef(L(-),y\righ)
		\end{equation*}
		in the functor category $\Fun\left(\Cc^\op,\cat{Set}\right)$.
		\item A functor $R\colon \Dd\rightarrow \Cc$ is a \emph{right adjoint of $L$} if there exists an equivalence
		\begin{equation*}
			\Hom_\Cc\lef(-,R(-)\righ)\simeq \Hom_\Dd\lef(L(-),-\righ)
		\end{equation*}
		in the functor category $\Fun(\Cc^\op\times \Dd,\cat{Set})$. In this case we write $L\dashv R$.
	\end{alphanumerate}
\end{defi}
\begin{lem}[\enquote{Adjoints can be constructed pointwise}]\label{lem:1Adjunction}
	A functor $L\colon \Cc\rightarrow \Dd$ has a right adjoint if and only if every $y\in \Dd$ has a right adjoint object $x\in \Cc$.
\end{lem}
\begin{proof}
	One implication is trivial: If $R\colon \Dd\rightarrow \Cc$ is a right adjoint of $L$, then $R(y)$ is a right adjoint object of $y$ for every $y\in \Dd$. The other implication is left as an exercise. We'll prove an $\infty$-categorical variant in \cref{lem:Adjunction}.
\end{proof}
\begin{con}\label{con:1Unit}
	Let $L\colon \Cc \shortdoublelrmorphism \Dd\noloc R$ be an adjunction. For every $x\in \Cc$, the identity $\id_{L(x)}\colon L(x)\rightarrow L(x)$ is adjoint to a morphism $u_x\colon x\rightarrow RL(x)$. One can show that these morphisms assemble into a natural transformation $u\colon \id_\Cc\Rightarrow RL$, called the \emph{unit} of the adjunction. Dually, there is a \emph{counit} $c\colon LR\Rightarrow \id_\Dd$.
\end{con}
\begin{lem}[Triangle identities]\label{lem:1TriangleIdentities}
	Let $L\colon \Cc\shortdoublelrmorphism \Dd\noloc R$ be an adjunction. Then the diagrams 
	\begin{equation*}
		\begin{tikzcd}
			L \doublear["Lu"{black,above=0.1em}]{r}\doublear["\id_L"'{black}]{dr} & LRL\doublear["cL"{black,right=0.1em}]{d}\dar[phantom,""{name=A}]\arrow[from=1-1,to=A,commutes,pos=0.7]\\
			& L
		\end{tikzcd}\quad\text{and}\quad
		\begin{tikzcd}
			R \doublear["uR"{black,above=0.1em}]{r}\doublear["\id_R"'{black}]{dr} & RLR\doublear["Rc"{black,right=0.1em}]{d}\dar[phantom,""{name=A}]\arrow[from=1-1,to=A,commutes,pos=0.7]\\
			& R
		\end{tikzcd}
	\end{equation*}
	commute. Conversely, if $L$, $R$ are functors and $u:\id_\Cc\Rightarrow RL$, $c\colon LR\Rightarrow \id_\Dd$ are natural transformations such that the diagrams above commute, then $L$ and $R$ determine an adjunction. 
\end{lem}
\begin{proof}
	Exercise. We'll prove an $\infty$-categorical variant in \cref{lem:TriangleIdentities}.
\end{proof}
\begin{cor}\label{cor:1FunctorCategoryAdjunctions}
	Let $L\colon \Cc \shortdoublelrmorphism \Dd\noloc R$ be an adjunction and let $\Ii$ be another category. Then the pre- and postcomposition functors determine adjunctions
	\begin{align*}
		L\circ-\colon \Fun(\Ii,\Cc)&\doublelrmorphism \Fun(\Ii,\Dd)\noloc R\circ -\,,\\
		{-}\circ {R}\colon \Fun(\Cc,\Ii)&\doublelrmorphism \Fun(\Dd,\Ii)\noloc {-}\circ {L}\,.
	\end{align*}
\end{cor}
\begin{proof}
	By \cref{lem:1TriangleIdentities}, we only need to construct unit and a counit transformations satisfying the triangle identities. These are immediately inherited from the adjunction $L\dashv R$.
\end{proof}
\subsection{Limits and colimits}
\begin{defi}\label{def:1Colimits}
	Let $F\colon \Ii\rightarrow \Cc$ be a functor. A \emph{limit of $F$}, denoted $\limit F$ (or sometimes $\limit_{i\in\Ii}F(i)$), is a right adjoint object of $F$ under the functor $\operatorname{const}\colon\Ii\rightarrow \Fun(\Ii,\Cc)$ that sends $i\in\Ii$ to the constant functor with value $i$. Dually, a \emph{colimit of $F$}, denoted $\colimit F$ (or sometimes $\colimit_{i\in\Ii}F(i)$), is a left adjoint object of $F$ under $\operatorname{const}$.
\end{defi}
Concretely, \cref{def:1Colimits} means that we have the following natural bijections for all $x,y\in \Cc$:
\begin{align*}
	\Hom_\Cc(x,\limit F)&\cong \Hom_{\Fun(\Ii,\Cc)}(\operatorname{const}x,F)\,,\\ \Hom_\Cc(\colimit F,y)&\cong \Hom_{\Fun(\Ii,\Cc)}(F,\operatorname{const}y)\,.
\end{align*}
\begin{lem}\label{lem:1AdjointsPreserveColimits}
	Left adjoint functors preserve colimits and right adjoint functors preserve limits.
\end{lem}
\begin{proof}
	Let $L\colon \Cc \shortdoublelrmorphism \Dd\noloc R$ be an adjunction and let $\Ii$ be another category. By \cref{cor:1FunctorCategoryAdjunctions}, the postcomposition functors $L_*\coloneqq L\circ -$ and $R_*\coloneqq R\circ -$ determine an adjunction
	\begin{equation*}
		L_*\colon \Fun(\Ii,\Cc)\doublelrmorphism \Fun(\Ii,\Dd)\noloc R_*
	\end{equation*}
	Now let $F\colon \Ii\rightarrow \Cc$ be a functor admitting a colimit $\colimit F$. Since left adjoint functors clearly preserve left adjoint objects, we see that $L(\colimit F)$ is a left adjoint object of $F$ under $\const R(-)$. But $\const R(-)\simeq R_*\const\colon \Dd\rightarrow \Fun(\Ii,\Cc)$. A left adjoint object of $F$ under $R_*\const$ is also a left adjoint object of $L_*F$ under $\const\colon \Dd\rightarrow \Fun(\Ii,\Dd)$ by the adjunction above. In summary, this proves that $L(\colimit F)$ is a left adjoint object of $L_*F$ under $\const$, which is precisely what we want. The case of limits is analogous.
\end{proof}
\begin{lem}[\enquote{Colimits in functor categories are computed pointwise.}]\label{lem:1ColimitsInFunctorCategories}
	Let $\Cc$, $\Dd$, and $\Ii$ be categories such that $\Dd$ has all $\Ii$-shaped colimits; that is, all functors $\Ii\rightarrow \Dd$ admit colimits. Then $\Fun(\Cc,\Dd)$ has again all $\Ii$-shaped colimits and the evaluation functor 
	\begin{equation*}
		\ev_x\colon \Fun(\Cc,\Dd)\longrightarrow \Fun\lef(\{x\},\Dd\righ)\simeq \Dd
	\end{equation*}
	preserves $\Ii$-shaped colimits for all $x\in \Cc$. A dual assertion holds for limits.
\end{lem}
\begin{proof}
	By \cref{lem:1Adjunction}, the condition that $\Dd$ has all $\Ii$-shaped colimits implies that the functor $\const\colon \Dd\rightarrow \Fun(\Ii,\Dd)$ has a left adjoint $\colimit\colon \Fun(\Ii,\Dd)\rightarrow \Dd$. Under the \enquote{currying} equivalence
	\begin{equation*}
		\Fun\lef(\Ii,\Fun(\Cc,\Dd)\righ)\simeq \Fun\lef(\Cc,\Fun(\Ii,\Dd)\righ)\,,
	\end{equation*}
	the functor $\const\colon \Fun(\Cc,\Dd)\rightarrow \Fun(\Ii,\Fun(\Cc,\Dd))$ corresponds to the postcomposition functor $\const_*\colon \Fun(\Cc,\Dd)\rightarrow \Fun(\Cc,\Fun(\Ii,\Dd))$. By \cref{cor:1FunctorCategoryAdjunctions}, we have an adjunction
	\begin{equation*}
		{\colimit}_*\colon \Fun\lef(\Cc,\Fun(\Ii,\Dd)\righ)\doublelrmorphism\Fun(\Cc,\Dd)\noloc \const_*\,.
	\end{equation*}
	Hence $\const\colon \Fun(\Cc,\Dd)\rightarrow \Fun(\Ii,\Fun(\Cc,\Dd))$ has a left adjoint too, which proves that $\Fun(\Cc,\Dd)$ has $\Ii$-shaped colimits. The additional assertion that $\ev_x$ preserves $\Ii$-shaped colimits follows by unravelling how $\colimit$ is constructed from $\colimit_*$.
\end{proof}
\subsection{Kan extensions}
\begin{numpar}[Setup]\label{par:1KanExtensionSetup}
	Suppose we are given functors $f$ and $F$ as follows:
	\begin{equation*}
		\begin{tikzcd}
			\Cc\rar["F"]\dar["f"'] & \Dd\\
			\Cc'\urar[dashed] &
		\end{tikzcd}
	\end{equation*}
	Often one would like to extend $F$ to a functor $F'\colon \Cc'\rightarrow\Dd$. Of course, in general there's no such functor making the diagram above commute, and if there is, it might not be unique.
\end{numpar}
\begin{defi}\label{def:1KanExtensions}
	In the situation of Setup~\cref{par:1KanExtensionSetup}, a \emph{left Kan extension of $F$ along $f$}, denoted $\Lan_fF\colon \Cc'\rightarrow \Dd$, is a left adjoint object of $F$ under $f^*=-\circ f\colon \Fun(\Cc',\Dd)\rightarrow \Fun(\Cc,\Dd)$. Dually, a \emph{right Kan extension of $F$ along $f$}, denoted $\Ran_fF\colon \Cc'\rightarrow\Dd$, is a right adjoint object of $F$ under $f^*$.
\end{defi}
\begin{warn}\label{warn:KanDoesntExtend}
	In general, even if the respective Kan extensions exist, the diagrams
	\begin{equation*}
		\begin{tikzcd}
			\Cc\dar["f"']\rar["F",""{name=B,sloped}]& \Dd\arrow[from=B,to=2-1,draw=none,"\Longleftarrow"{sloped,marking,pos=0.5}]\\
			\Cc'\urar["\Lan_fF"']
		\end{tikzcd}
		\quad\text{and}\quad
		\begin{tikzcd}
			\Cc\dar["f"']\rar["F",""{name=B,sloped}]& \Dd\arrow[from=B,to=2-1,draw=none,"\Longrightarrow"{sloped,marking,pos=0.5}]\\
			\Cc'\urar["\Ran_fF"']
		\end{tikzcd}
	\end{equation*}
	only commute up to the indicated natural transformations. Indeed, the defining property from \cref{def:1KanExtensions} says that there are natural bijections
	\begin{align*}
		\Hom_{\Fun(\Cc',\Dd)}(\Lan_fF,F')&\cong \Hom_{\Fun(\Cc,\Dd)}(F,F'\circ f)\,,\\
		\Hom_{\Fun(\Cc',\Dd)}(F',\Ran_fF)&\cong \Hom_{\Fun(\Cc,\Dd)}(F'\circ f,F)\,,
	\end{align*}
	for all $F'\colon \Cc'\rightarrow \Dd$. Plugging in $F'=\Lan_fF$ , then taking the image of $\id_{\Lan_fF}$ produces the indicated natural transformation; and likewise for $\Ran_fF$ (so in other words, we're considering the unit of the adjunction $\Lan_f\dashv f^*$ and the counit of $f^*\dashv\Ran_f$, respectively).
	%		\begin{equation*}
		%			\begin{tikzcd}
			%				\Cc\drar["f"',""{name=A,sloped}]\rar["r"] & f/\Ee\dar["t"',""{name=B,sloped}]\rar["s"]& \Cc\dlar["f"]\arrow[from=1-3,to=B,draw=none,"\Longleftarrow"{sloped,marking,pos=0.7},"\eta"{swap,pos=0.65}]\arrow[from=A,to=1-2,phantom,"\scriptscriptstyle/\!/\!/"]\\
			%				& \Ee &
			%			\end{tikzcd}
		%		\end{equation*}
\end{warn}
\begin{exm}\label{exm:1ColimitAsKanExtension}
	Let $\Cc'=*$, then $\Fun(\Cc',\Dd)\simeq \Dd$ and we see immediately that $\Lan_fF$ corresponds to $\colimit F$ (if either exists). Likewise, $\Ran_fF$ corresponds to $\limit F$.
\end{exm}
Next we set out to answer the question when Kan extensions exist. To this end, we need to introduce two constructions that will feature prominently throughout the text.
\begin{con}\label{con:1ArrowCategory}
	Let $\Cc$ be a category and let $[1]\coloneqq \{\InlineDelta\}$ be the category with two objects and one non-identity morphism. The \emph{arrow category of $\Cc$} is the category
	\begin{equation*}
		\Ar(\Cc)\coloneqq \Fun\lef([1],\Cc\righ)\,.%
		%				\simeq \begin{cases*}
			%				\text{\emph{Objects:} Morphisms $\alpha\colon x\rightarrow y$ in $\Cc$.}\\
			%				\text{\emph{Morphisms:} Commutative diagrams $\begin{tikzcd}[cramped,column sep=small,row sep=small,ampersand replacement=\&,baseline=(ALPHA.base)]
					%						x\dar["\alpha"',"\textstyle \vphantom{x}"{name=ALPHA}]\rar \& x'\dar["\smash{\alpha'}\vphantom{\alpha}"]\\
					%						y\rar \& \smash{y'}\vphantom{y}
					%				\end{tikzcd}$ in $\Cc$.}
			%			\end{cases*}
	\end{equation*}
	Concretely, objects in $\Ar(\Cc)$ are morphisms $\alpha\colon x\rightarrow y$ in $\Cc$, and morphisms in $\Ar(\Cc)$ are commutative diagrams
	\begin{equation*}
		\begin{tikzcd}
			x\dar["\alpha"']\rar\drar[commutes] & x'\dar["\alpha'"]\\
			y\rar & y'
		\end{tikzcd}
	\end{equation*}
	in $\Cc$. There are functors $s,t\colon \Ar(\Cc)\rightarrow \Cc$ (\enquote{source} and \enquote{target} projection) sending an arrow $(\alpha\colon x\rightarrow y)$ to $x$ and $y$, respectively.
\end{con}
\begin{con}\label{con:1SliceCategory}
	Let $f\colon \Cc\rightarrow\Cc'$ be a functor and $x'\in \Cc'$. The \emph{slice category of $\Cc$ over $x'$} is the pullback
	\begin{equation*}
		\begin{tikzcd}
			\Cc_{/x'}\rar\dar\drar[pullback] & \Ar(\Cc')\dar["{(s,t)}"]\\
			\Cc\times\{x'\}\rar["f\times x'"] & \Cc'\times \Cc'
		\end{tikzcd}
	\end{equation*}
	Concretely, objects in the slice category $\Cc_{/x'}$ are pairs $(x,f(x)\rightarrow x')$, where $x\in \Cc$ and $f(x)\rightarrow x'$ is a morphism in $\Cc'$. Morphisms in $\Cc_{/x'}$ are given by morphisms $\alpha\colon x\rightarrow y$ such that
	\begin{equation*}
		\begin{tikzcd}
			f(x)\dar\rar["f(\alpha)"]\drar[commutes] & f(y)\dar\\
			x'\eqar[r] & x'
		\end{tikzcd}
	\end{equation*}
	commutes. Dually, there's also $\Cc_{x'/}$, the \emph{slice category of $\Cc$ under $x'$}.
\end{con}
\begin{lem}[Kan extension formula]\label{lem:1KanExtensionFormula}
	In the situation of Setup~\cref{par:1KanExtensionSetup}, assume that for all $x'\in \Cc'$ the following colimits exist in $\Dd$:
	\begin{equation*}
		\colimit_{(x,f(x)\rightarrow x')\in \Cc_{/x'}}F(x)\coloneqq \colimit\lef(\Cc_{/x'}\longrightarrow \Cc\overset{F}{\longrightarrow}\Dd\righ)
	\end{equation*}
	Then $\Lan_fF$ exists and $\Lan_fF(x')$ is given by that colimit.
\end{lem}
\begin{proof}
	Exercise. We'll prove an $\infty$-categorical variant in \cref{lem:KanExtensionFormula}.
\end{proof}
\begin{cor}%[\enquote{Kan extensions along fully faithful functors behave nicely.}]
	\label{cor:1KanExtensionAlongFullyFaithful}
	In the situation of Setup~\cref{par:1KanExtensionSetup}, assume that $f\colon \Cc\rightarrow \Cc'$ is fully faithful and that the colimits from \cref{lem:1KanExtensionFormula} exist. Then the natural transformation $u_F\colon F\Rightarrow \Lan_fF\circ f$ from \cref{warn:KanDoesntExtend} is an equivalence.
\end{cor}
\begin{proof}
	If $x'=f(y)$ for some $y\in \Cc$, then $f$ being fully faithful implies that the slice category $\Cc_{/f(y)}$ is equivalent to $\Cc_{/y}$ (that is, the slice category formed with respect to $\id_\Cc\colon \Cc\rightarrow\Cc$). The latter has a terminal object, namely $\{\id_y\}$. Hence
	\begin{equation*}
		\Lan_fF\lef(f(y)\righ)\cong \colimit_{(x,f(x)\rightarrow y)\in \Cc_{/f(y)}}F(x)\cong \colimit_{(x\rightarrow y)\in \Cc_{/y}}F(x)\cong F(y).\qedhere
	\end{equation*}
\end{proof}
To finish this subsection, we prove a result about the \emph{category $\PSh(\Cc)\coloneqq \Fun(\Cc^\op,\cat{Set})$ of presheaves on $\Cc$}. This will seem rather technical at first, but, together with its $\infty$-categorical version, it will be invaluable throughout the text.
\begin{thm}[\enquote{$\PSh(\Cc)$ arises by freely adding colimits to $\Cc$.}]\label{thm:1PShFreeCocompletion}
	Let $\Cc$ and $\Dd$ be categories, where $\Dd$ has all colimits. Let $\Yo_\Cc\colon \Cc\rightarrow\PSh(\Cc)$ denote the Yoneda embedding, sending $x\in \Cc$ to $\Hom_\Cc(-,x)\colon \Cc^\op\rightarrow\cat{Set}$. Then restriction along $\Yo_\Cc$ induces an equivalence
	\begin{equation*}
		\Yo_\Cc^*\colon \Fun^{\colimit}\lef(\PSh(\Cc),\Dd\righ)\overset{\simeq}{\longrightarrow}\Fun(\Cc,\Dd)\,.
	\end{equation*}
	Here $\Fun^{\colimit}(\PSh(\Cc),\Dd)\subseteq \Fun(\PSh(\Cc),\Dd)$ is the full subcategory spanned by the colimit-preserving functors. Furthermore, every colimit-preserving functor $\PSh(\Cc)\rightarrow \Dd$ admits a right adjoint.
\end{thm}
To prove \cref{thm:1PShFreeCocompletion}, we send two lemmas in advance.
\begin{lem}[\enquote{Every presheaf is a colimit of representables.}]\label{lem:1PresheafColimitOfRepresentables}
	Let $\Cc$ be a category. For every $E\in \PSh(\Cc)$, the natural morphism
	\begin{equation*}
		\colimit_{(y,\Hom_\Cc(-,y)\rightarrow E)\in \Cc_{/E}}\Hom_\Cc(-,y)\overset{\cong}{\longrightarrow}E
	\end{equation*}
	is an isomorphism.
\end{lem}
\begin{proof}
	Exercise (use Yoneda's lemma). We'll prove an $\infty$-categorical version in \cref{lem:PresheafColimitOfRepresentables}.
\end{proof}
\begin{lem}\label{lem:1LanAlongYonedaHasRightAdjoint}
	Let $\Cc$ and $\Dd$ be categories, where $\Dd$ has all colimits. For every $F\colon \Cc\rightarrow \Dd$, the left Kan extension $\Lan_{\Yo_\Cc}F\colon \PSh(\Cc)\rightarrow\Dd$ \embrace{which exists due to \cref{lem:1KanExtensionFormula}} admits a right adjoint. The right adjoint sends $y\in \Dd$ to $\Hom_\Dd(F(-),y)\colon \Cc^\op\rightarrow\cat{Set}$.
\end{lem}
\begin{proof}
	Exercise. We'll prove an $\infty$-categorical version in \cref{lem:LanAlongYonedaHasRightAdjoint}.
\end{proof}
Furthermore, we need the following general lemma (which will occasionally be useful in the future too).
\begin{lem}\label{lem:1FullyFaithfulConservativeAdjunction}
	Let $\Cc$ and $\Dd$ be categories and let $L\colon \Cc\shortdoublelrmorphism \Dd\noloc R$ be an adjunction.
	\begin{alphanumerate}
		\item \!The left adjoint $L$ is fully faithful if and only if the unit transformation $u\colon \id_\Cc\Rightarrow RL$ is an equivalence.\label{enum:1FullyFaithfulIffUnitEquivalence}
		\item Suppose the condition from \cref{enum:1FullyFaithfulIffUnitEquivalence} is true. Furthermore, suppose that $R$ is conservative \embrace{that is, if $\alpha\colon x\rightarrow y$ is a morphism in $\Dd$ such that $R(\alpha)$ is an isomorphism, then $\alpha$ is an isomorphism too}. Then $L$ and $R$ are inverse equivalences of categories.\label{enum:1Conservative}
	\end{alphanumerate}
\end{lem}
\begin{proof}
	To prove \cref{enum:FullyFaithfulIffUnitEquivalence}, first observe that for all elements $x,y\in\Cc$, the postcomposition map $(u_y)_*\colon \Hom_\Cc(x,y)\rightarrow\Hom_\Cc(x,RL(y))$ is given by
	\begin{equation*}
		(u_y)_*\colon\Hom_\Dd\lef(x,y\righ)\overset{L}{\longrightarrow}\Hom_\Dd\lef(L(x),L(y)\righ)\overset{\cong}{\longrightarrow}\Hom_\Cc\lef(x,RL(y)\righ)\,,
	\end{equation*}
	where the second map is the adjunction bijection. By Yoneda's lemma, 
	$u_y\colon y\rightarrow RL(y)$ is an equivalence if and only if $(u_y)_*\colon \Hom_\Cc(x,y)\rightarrow\Hom_\Cc(x,RL(y))$ is a bijection for all $x$. By the above, this happens if and only if $L\colon \Hom_\Dd\lef(x,y\righ)\rightarrow\Hom_\Dd\lef(L(x),L(y)\righ)$ is a bijection for all $x\in\Cc$. This proves \cref{enum:FullyFaithfulIffUnitEquivalence}.
	
	For \cref{enum:Conservative}, the second of the triangle identities from \cref{lem:1TriangleIdentities} shows that $Rc\colon RLR\Rightarrow R$ is a natural equivalence. Since $R$ is conservative, $c\colon LR\Rightarrow \id_\Dd$ must be an equivalence too. Since $u\colon \id_\Cc\Rightarrow RL$ is an equivalence by assumption, we are done.
\end{proof}
\begin{proof}[Proof of \cref{thm:1PShFreeCocompletion}]
	By \cref{lem:1LanAlongYonedaHasRightAdjoint} and \cref{lem:1AdjointsPreserveColimits}, the adjunction $\Lan_{\Yo_\Cc}\dashv\Yo_\Cc^*$ restricts to an adjunction
	\begin{equation*}
		\Lan_{\Yo_\Cc}\colon \Fun(\Cc,\Dd)\doublelrmorphism\Fun^{\colimit}\lef(\PSh(\Cc),\Dd\righ)\noloc \Yo_\Cc^*\,.
	\end{equation*}
	Since $\Yo_\Cc$ is fully faithful, \cref{cor:1KanExtensionAlongFullyFaithful} implies that the unit $u\colon \id_{\Fun(\Cc,\Dd)}\Rightarrow\Yo_\Cc^*\circ \Lan_{\Yo_\Cc}$ is an equivalence. Furthermore, it's clear that $\Yo_\Cc^*$ is conservative: If a natural transformation $\eta\colon F\Rightarrow G$ between colimit-preserving functors $F,G\colon \PSh(\Cc)\rightarrow\Dd$ is an equivalence when restricted to representable presheaves, then it is an equivalence everywhere, because every presheaf can be written as a colimit of representables (\cref{lem:1PresheafColimitOfRepresentables}). Then \cref{lem:1FullyFaithfulConservativeAdjunction}\cref{enum:1Conservative} finishes the proof.
\end{proof}
\newpage
\section{Simplicial sets}\label{sec:SimplicialSets}
In this section, we'll introduce our model for $\infty$-categories and the main object of interest in \cref{sec:SimplicialSets}, \cref{sec:JoyalLifting}, and \cref{sec:Straightening}: quasi-categories! We'll see some first signs that quasi-categories behave a lot like ordinary categories and we'll define the quasi-category of quasi-categories $\cat{Cat}_\infty$.
\subsection{Definitions and basic examples}
\begin{defi}\label{def:SimplicialSet}
	\begin{alphanumerate}
		\item The \emph{simplex category $\IDelta$} is the category whose objects are finite non-empty totally ordered sets $[n]=\left\{0<1<\dotsb<n\right\}$ for all $n\geqslant 0$ and whose morphisms are order-preserving maps, that is, maps $\alpha\colon [m]\rightarrow [n]$ such that $\alpha(0)\leqslant \alpha(1)\leqslant\dotsb\leqslant \alpha(m)$.\label{enum:SimplexCategory}
		\item A \emph{simplicial set} is a presheaf on $\IDelta$, that is, a functor $X\colon \IDelta^\op\rightarrow\cat{Set}$. The \emph{category of simplicial sets} is the category $\cat{sSet}\coloneqq \PSh(\IDelta)\simeq\Fun(\IDelta^\op,\cat{Set})$ of presheaves on $\IDelta$.\label{enum:SimplicialSet}
	\end{alphanumerate}
\end{defi}
\begin{con}\label{con:FaceDegeneracyMaps}
	For all $i=0,\dotsc,n$ and all $j=0,\dotsc,n-1$ let $d_i\colon [n-1]\rightarrow [n]$ be the unique injective morphism in $\IDelta$ that doesn't hit $i$ and let $s_j\colon [n]\rightarrow[n-1]$ be the unique surjective morphism in $\IDelta$ that hits $j$ twice. It's straightforward to see that every morphism $\alpha\colon [m]\rightarrow[n]$ in $\IDelta$ can be written as a composition of some $s_j$ and some $d_i$. Therefore, a simplicial set can be described by the following data:
	\begin{alphanumerate}
		\item Sets $X_n\coloneqq X([n])$ for all $n\geqslant 0$.
		\item \emph{Face maps} $d_i^*\colon X_n\rightarrow X_{n-1}$ for all $i=0,\dotsc,n$.
		\item \emph{Degeneracy maps} $s_j^*\colon X_{n-1}\rightarrow X_{n}$ for all $j=0,\dotsc,n-1$.
	\end{alphanumerate}
	The face and degeneracy maps satisfy $d_j^*\circ d_i^*=d_{i-1}^*\circ d_j^*$ and $s_j^*\circ s_i^*=s_{i-1}^*\circ s_j^*$ for all $i>j$ as well as
	\begin{equation*}
		d_j^*\circ s_i^*=\begin{cases*}
			s_i^*\circ d_{j-1}^* & if $i<j-1$\\
			\id_{X_{n-1}} & if $i=j-1$ or $i=j$\\
			s_{i-1}^*\circ d_j^* & if $i>j$
		\end{cases*}\,.
	\end{equation*}
	It's customary to call elements of $X_n$ \emph{$n$-simplices of $X$}. An $n$-simplex is called \emph{degenerate} if it is in the image of $s_j\colon X_{n-1}\rightarrow X_n$ for some $j$.
\end{con}
Let's give some first examples of simplicial sets and explain some basic constructions. %with them. Here we'll also see \cref{thm:1PShFreeCocompletion} in action for the first time!

\begin{numpar}[Boundaries and horns.]\label{par:Horns}
	For all $n\geqslant 0$, the functor $\Delta^n\coloneqq\Hom_{\IDelta}(-,[n])\colon \IDelta^\op\rightarrow\cat{Set}$ is a simplicial set, called the \emph{$n$-simplex}. Yoneda's lemma implies that $\Hom_{\cat{sSet}}(\Delta^n,X)\cong X_n$ for all simplicial sets $X$. The maps $d_i\colon [n-1]\rightarrow [n]$ and $s_j\colon [n]\rightarrow[n-1]$ from \cref{con:FaceDegeneracyMaps} induce maps $d_i\colon \Delta^{n-1}\rightarrow \Delta^n$ and $s_j\colon \Delta^n\rightarrow \Delta^{n-1}$ in $\cat{sSet}$. Using these maps, we can define the following sub-simplicial sets of $\Delta^n$:
	\begin{align*}
		\partial \Delta^n&\coloneqq \bigcup_{i=0}^n\im\left(d_i\colon \Delta^{n-1}\rightarrow\Delta^n\right)\subseteq \Delta^n\,\text{, the \emph{boundary of $\Delta^n$},}\\
		\Lambda_j^n&\coloneqq \bigcup_{\substack{i=0\\i\neq j}}^n\im\left(d_i\colon \Delta^{n-1}\rightarrow\Delta^n\right)\subseteq \Delta^n\,\text{, the \emph{$j$-horn in $\Delta^n$}.}
	\end{align*}
	Here the union is taken degree-wise (recall that limits and colimits in functor categories are computed pointwise, see \cref{lem:1ColimitsInFunctorCategories}). It's customary to call horns $\Lambda_j^n$ \emph{inner horns} if $0<j<n$ and \emph{outer horns} if $j=0$ or $j=n$.
	
	Concretely, for all $m\geqslant 0$, the $m$-simplices of the boundary $\partial \Delta^n$ and the $j$-horn $\Lambda_j^n$ are given by the following formulas:
	\begin{align*}
		(\partial \Delta^n)_m&=\lef\{\alpha\colon [m]\rightarrow [n]\ \middle|\ [n]\neq \im(\alpha)\righ\}\,,\\
		(\Lambda_j^n)_m&=\lef\{\alpha\colon [m]\rightarrow [n]\ \middle|\ [n]\neq \im(\alpha)\cup\{j\}\righ\}\,.
	\end{align*}
	Here are some pictures in the case $n=2$ (in the bottom line, the dotted lines mark the faces that are missing in the respective horns):
	\begin{gather*}
		\Delta^2=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base), decoration={markings,mark=at position 0.5 with {\arrow{to}}}]
			\path node[outer sep=0.25ex] (0) at (0,0) {$0$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$1$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$2$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path (0) to node[pos=0.5] (05) {} (1);
			\path (05) to node[pos=0.333] {$\scriptscriptstyle/\!/\!/$} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge[postaction={decorate},-] (1)
			(1) edge[postaction={decorate},-] (2)
			(0) edge[postaction={decorate},-] (2);
		\end{tikzpicture}\,,\quad
		\partial\Delta^2=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base), decoration={markings,mark=at position 0.5 with {\arrow{to}}}]
			\path node[outer sep=0.25ex] (0) at (0,0) {$0$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$1$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$2$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge[postaction={decorate},-] (1)
			(1) edge[postaction={decorate},-] (2)
			(0) edge[postaction={decorate},-] (2);
		\end{tikzpicture}\\
		\Lambda_0^2=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base), decoration={markings,mark=at position 0.5 with {\arrow{to}}}]
			\path node[outer sep=0.25ex] (0) at (0,0) {$0$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$1$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$2$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge[postaction={decorate},-] (1)
			(1) edge[dotted,postaction={decorate},-] (2)
			(0) edge[postaction={decorate},-] (2);
		\end{tikzpicture}\,,\quad
		\Lambda_1^2=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base), decoration={markings,mark=at position 0.5 with {\arrow{to}}}]
			\path node[outer sep=0.25ex] (0) at (0,0) {$0$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$1$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$2$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge[postaction={decorate},-] (1)
			(1) edge[postaction={decorate},-] (2)
			(0) edge[dotted,postaction={decorate},-] (2);
		\end{tikzpicture}\,,\quad
		\Lambda_2^2=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base), decoration={markings,mark=at position 0.5 with {\arrow{to}}}]
			\path node[outer sep=0.25ex] (0) at (0,0) {$0$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$1$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$2$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge[dotted,postaction={decorate},-] (1)
			(1) edge[postaction={decorate},-] (2)
			(0) edge[postaction={decorate},-] (2);
		\end{tikzpicture}
	\end{gather*}
\end{numpar}
\begin{numpar}[Geometric Realisation.]\label{par:GeometricRealisation}
	These pictures suggest that we can associate a topological space to every simplicial set. We can make this precise as follows: The \emph{topological $n$-simplex} is the space $\left|\Delta^n\right|\coloneqq\left\{(t_0,\dotsc,t_n)\in\IR^n\ \middle|\ 0\leqslant t_i\leqslant 1, \sum_{i=1}^nt_i=1\right\}$. For all $i=0,\dotsc,n$ and all $j=0,\dotsc,n-1$ we define maps $\left|d_i\right|\colon\left|\Delta^{n-1}\right|\rightarrow\left|\Delta^n\right|$ and $\left|s_j\right|\colon\left|\Delta^{n}\right|\rightarrow\left|\Delta^{n-1}\right|$ via
	\begin{align*}
		\left|d_i\right|(t_0,\dotsc,t_{n-1})&\coloneqq (t_0,\dotsc,t_{i-1},0,t_i,\dotsc,t_n)\\
		\left|s_j\right|(t_0,\dotsc,t_n)&\coloneqq (t_0,\dotsc,t_{i-1},t_i+t_{i+1},t_{i+2},\dotsc,t_n)
	\end{align*}
	For general simplicial sets $X$, we can construct a topological space (in fact, a CW complex) $\left|X\right|$, called the \emph{geometric realisation of $X$}, by taking a topological $n$-simplex $\left|\Delta^n\right|$ for every $\sigma\in X_n$ and gluing them together according to the face and degeneracy maps above. More precisely, we take
	\begin{equation*}
		\left|X\right|\coloneqq\colimit_{(n,\Delta^n\rightarrow X)}\left|\Delta^n\right|\in\cat{Top}\,.
	\end{equation*}
	This agrees with the Kan extension formula from \cref{lem:1KanExtensionFormula}! So $\left|\,\cdot\,\right|\colon \cat{sSet}\rightarrow \cat{Top}$ must be the unique colimit-preserving extension, guaranteed by \cref{thm:1PShFreeCocompletion}, of the functor $\IDelta\rightarrow\cat{Top}$ that sends $[n]\mapsto \left|\Delta^n\right|$.
	
	Furthermore, \cref{thm:1PShFreeCocompletion} guarantees that $\left|\,\cdot\,\right|\colon \cat{sSet}\rightarrow \cat{Top}$ admits a right adjoint $\Sing\colon \cat{Top}\rightarrow\cat{sSet}$. By \cref{lem:1LanAlongYonedaHasRightAdjoint}, it is given by $(\Sing Y)_n\cong \Hom_{\cat{Top}}(\left|\Delta^n\right|,Y)$. So $\Sing Y$ is indeed the construction you know from the definition of singular homology.
\end{numpar}
\begin{numpar}[Nerve and homotopy category.]\label{par:Nerve}
	Every partially ordered set defines a category. In particular, we can regard the totally ordered sets $[n]$ as categories; accordingly, we obtain a functor $U\colon \IDelta\rightarrow \cat{Cat}$ into the category of small categories that simply sends $[n]\mapsto [n]$. For every small category $\Cc$, this allows us to define a simplicial set $\N(\Cc)$, called the \emph{nerve of $\Cc$}, as the composition
	\begin{equation*}
		\N(\Cc)\colon \IDelta^\op\xrightarrow{U^\op}\cat{Cat}^\op\xrightarrow{\Hom_{\cat{Cat}}(-,\,\Cc)}\cat{Set}\,.
	\end{equation*}
	Concretely, $\N(\Cc)_n= \Hom_{\cat{Cat}}([n],\Cc)\cong \left\{x_0\rightarrow \dotsb\rightarrow x_n\text{ in $\Cc$}\right\}$ is the set of all chains of $n$ morphisms in $\Cc$. The face maps $d_i^*\colon \N(\Cc)_n\rightarrow \N(\Cc)_{n-1}$ compose the $(i-1)$\textsuperscript{st} and $i$\textsuperscript{th} morphism in the chain (in the cases $i=0$ or $i=n$, the face map $d_0^*$ just discards $x_0$ and $d_n^*$ just discards $x_n$). The degeneracy maps $s_j^*\colon \N(\Cc)_{n-1}\rightarrow \N(\Cc)_n$ insert an identity at the $j$\textsuperscript{th} position.
	
	Observe that $\N(\Cc)_n\cong\Hom_{\cat{Cat}}([n],\Cc)$ is exactly of the form of a right-adjoint as in \cref{lem:1LanAlongYonedaHasRightAdjoint}. The corresponding left adjoint, which denote $\operatorname{ho}\colon \cat{sSet}\rightarrow\cat{Cat}$, is the unique colimit-preserving extension of the functor $U\colon\IDelta\rightarrow \cat{Cat}$ above (here we use implicitly that $\cat{Cat}$ has all colimits). For a simplicial set $X$, we call $\operatorname{ho}(X)$ the \emph{homotopy category of $X$}. The objects of $\operatorname{ho}(X)$ are the set of $0$-simplices $X_0$. However, the morphisms of $\operatorname{ho}(X)$ are a little more difficult to describe. For example, $\operatorname{ho}(\Lambda_1^2)$ contains a morphism $\alpha\colon 0\rightarrow 1$ and a morphism $\beta\colon 1\rightarrow 2$, induced by $[1]\cong \operatorname{ho}(\Delta^{\{0,1\}})\rightarrow \operatorname{ho}(\Lambda_1^2)$ and $[1]\cong \operatorname{ho}(\Delta^{\{1,2\}})\rightarrow \operatorname{ho}(\Lambda_1^2)$. Hence the category $\operatorname{ho}(\Lambda_1^2)$ must also contain a morphism $\beta\circ\alpha\colon 0\rightarrow 2$, even though there's no $1$-simplex from $0$ to $2$ in $\Lambda_1^2$. So in general, the morphisms in $\operatorname{ho}(X)$ are not just a quotient of the set of $1$-simplices $X_1$ by some equivalence relation. Instead, we have to take \emph{chains} of $1$-simplices and quotient out a suitable equivalence relation. This is not too hard to make precise, but quite technical and we won't pursue it here. We'll see an explicit description in the case of quasi-categories in \cref{par:HomotopyCategory} below; the general description can be found in \cite[Construction/Proposition~II.24]{HigherCatsI}.
\end{numpar}
\begin{numpar}[Mapping simplicial sets.]\label{par:FInternalHom}
	For every $X\in\cat{sSet}$ the functor $-\times X\colon\cat{sSet}\rightarrow\cat{sSet}$ commutes with colimits; this follows from the fact that products in $\cat{Set}$ commute with colimits, combined with the fact that limits and colimits in $\cat{sSet}$ are computed degree-wise by \cref{lem:1ColimitsInFunctorCategories}. Hence, by \cref{thm:1PShFreeCocompletion}, it must be the unique colimit-preserving extension of the functor $\IDelta\rightarrow\cat{sSet}$ sending $[n]\mapsto \Delta^n\times X$. But more importantly, $-\times X$ must have a right adjoint, which we denote $\F(X,-)\colon \cat{sSet}\rightarrow\cat{sSet}$. By the formula in \cref{lem:1LanAlongYonedaHasRightAdjoint}, the right adjoint is given by $\F(X,Y)_n\cong \F(\Delta^n\times X,Y)$.
\end{numpar}

At this point, let's take a moment to appreciate the power of \cref{thm:1PShFreeCocompletion}: It gave us $\left|\,\cdot\,\right|\colon \cat{sSet}\shortdoublelrmorphism\cat{Top}\noloc \Sing$, $\operatorname{ho}\colon \cat{sSet}\shortdoublelrmorphism\cat{Cat}\noloc \N$, and $-\times X\colon \cat{sSet}\shortdoublelrmorphism \cat{sSet}\noloc \F(X,-)$ for free!

\subsection{Quasi-categories and Kan complexes}
In this subsection, we'll introduce \emph{quasi-categories}, a class of simplicial sets that behave very similar to ordinary categories. To motivate the definition, here's a lemma.
\begin{lem}\label{lem:LiftingConditions}
	\begin{alphanumerate}
		\item Let $Y$ be a topological space. For all $n\geqslant 1$ and all $0\leqslant i\leqslant n$, every horn filling problem\label{enum:LiftingSing}
		\begin{equation*}
			\begin{tikzcd}
				\Lambda_i^n\rar\dar & \Sing Y\\
				\Delta^n\urar[dashed]
			\end{tikzcd}
		\end{equation*}
		has a solution.
		\item Let $\Cc$ be a small category. For all $n\geqslant 2$ and all $0<i<n$, every inner horn filling problem\label{enum:LiftingN}
		\begin{equation*}
			\begin{tikzcd}
				\Lambda_i^n\rar\dar & \N(\Cc)\\
				\Delta^n\urar[dashed]
			\end{tikzcd}
		\end{equation*}
		has a unique solution. Furthermore, if $X$ is a simplicial set with this horn filling property, then $X\cong \N(\Cc)$ for some category $\Cc$ \embrace{which is necessarily the homotopy category $\operatorname{ho}(X)$}.
	\end{alphanumerate}
\end{lem}
\begin{proof}[Prook sketch]
	By the adjunction $\left|\,\cdot\,\right|\colon \cat{sSet}\shortdoublelrmorphism\cat{Top}\noloc \Sing$ from \cref{par:GeometricRealisation}, a horn filling problem as in \cref{enum:LiftingSing} is equivalent to
	\begin{equation*}
		\begin{tikzcd}
			\left|\Lambda_i^n\right|\rar\dar & Y\\
			\left|\Delta^n\right|\urar[dashed]
		\end{tikzcd}
	\end{equation*}
	This one always has a solution since $\left|\Lambda_i^n\right|$ is a retract of $\left|\Delta^n\right|$. This proves \cref{enum:LiftingSing}. For \cref{enum:LiftingN}, recall from \cref{par:Nerve} that a morphism $\Delta^n\rightarrow \N(\Cc)$ corresponds to a chain $x_0\rightarrow \dotsb\rightarrow x_n$ in $\Cc$. But the morphisms $x_j\rightarrow x_{j+1}$ are already given by $\Lambda_i^n\rightarrow \N(\Cc)$. This shows the unique horn filling assertion from \cref{enum:LiftingN}. The additional assertion is more or less straightforward if you use the description of the homotopy category from \cref{par:HomotopyCategory} below. For a complete proof, see \cite[Theorem~II.25]{HigherCatsI}.
\end{proof}
Recall that by Grothendieck's \emph{homotopy hypothesis}, topological spaces should be the same as $\infty$-groupoids, so in particular, they should provide examples of $\infty$-categories. Clearly, every ordinary category should be an $\infty$-category too. So if we try to model $\infty$-categories by a specific class of simplicial sets, that class should contain $\Sing Y$ for every topological space $Y$ and $\N(\Cc)$ for every small category $\Cc$. It then feels reasonable to look for a common generalisation of the horn filling conditions from \cref{lem:LiftingConditions}\cref{enum:LiftingSing} and~\cref{enum:LiftingN}, which is precisely what the definition of quasi-categories does:
\begin{defi}[Boardman--Vogt, \cite{BoardmanVogt}]\label{def:QuasiCategory}
	A \emph{quasi-category} is a simplicial set $\Cc$ such that for all $n\geqslant 2$ and all $0<i<n$, every inner horn filling problem
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_i^n\rar\dar & \Cc\\
			\Delta^n\urar[dashed]
		\end{tikzcd}
	\end{equation*}
	has a solution. If, moreover, all horn filling problems for $n\geqslant 1$ and $0\leqslant i\leqslant n$ have solutions, then $\Cc$ is called a \emph{Kan complex}. We let $\cat{Kan}\subseteq\cat{QCat}\subseteq\cat{sSet}$ denote the full subcategories spanned by Kan complexes and quasi-categories.
\end{defi}
The rest of \cref{sec:SimplicialSets} as well as the entirety of \cref{sec:JoyalLifting} and \cref{sec:Straightening} will be spent convincing you that \cref{def:QuasiCategory} is a sensible definition and that quasi-categories really behave like ordinary categories. Let's begin by giving a dictionary of the most basic categorical notions and their counterparts the world of quasi-categories.
\begin{numpar}[Objects and Morphisms.]
	Let $\Cc$ be a quasi-category. We'll use the following suggestive terminology. If $x$ is a $0$-simplex of $\Cc$, we'll say that \emph{$x$ is an object in $\Cc$} and write $x\in\Cc$ instead of $x\in\Cc_0$. We also write $\{x\}\rightarrow \Cc$ for the map $\Delta^0\rightarrow \Cc$ induced by $x$. If $\alpha$ is a $1$-simplex and $x=d_1^*(\alpha)$, $y=d_0^*(\alpha)$, we'll say that \emph{$\alpha\colon x\rightarrow y$ is a morphism in $\Cc$}. For an object $x\in\Cc$, we'll call the degenerate $1$-simplex $s_0^*(x)\in\Cc_1$ the \emph{identity on $x$} and we'll write $\id_x\colon x\rightarrow x$.
\end{numpar}
\begin{numpar}[Functors and natural transformations.]
	A \emph{functor of quasi-categories} is simply a map of simplicial sets. If $\Cc$ and $\Dd$ are quasi-categories, then the construction $\F(\Cc,\Dd)$ from \cref{par:FInternalHom} plays the role of the category of functors from $\Cc$ to $\Dd$. We'll show in \cref{cor:FIsKanComplex} that $\F(\Cc,\Dd)$ is indeed a quasi-category again. Furthermore, if $F,G\colon \Cc\rightarrow \Dd$ are functors of quasi-categories, then a \emph{natural transformation $\eta\colon F\Rightarrow G$} is a functor $\eta\colon \Delta^1\times\Cc\rightarrow \Dd$ such that the following diagram commutes:
	\begin{equation*}
		\begin{tikzcd}
			\{0\}\times \Cc\dar\dar[phantom,""{name=A}]\arrow[from=2-2,to=1-1,commutes,xshift=-1ex]\drar[bend left,"F"]& \\
			\Delta^1\times \Cc\rar["\eta"]& \Dd\\
			\{1\}\times \Cc\uar\uar[phantom,""{name=A}]\arrow[from=2-2,to=3-1,commutes,xshift=-1ex]\urar[bend right, "G"'] & 
		\end{tikzcd}
	\end{equation*}
	By \cref{par:FInternalHom}, we may equivalently view $\eta$ as a $1$-simplex $\Delta^1\rightarrow \F(\Cc,\Dd)$ from $F$ to $G$. That is, natural transformations are morphisms in the functor quasi-category, as they should be (except that we don't know yet that $\F(\Cc,\Dd)$ is a quasi-category again). Further evidence that $\F(\Cc,\Dd)$ is the right construction will be given in \cref{lem:SimplicialHoNerveAdjunction} below.
\end{numpar}
\begin{numpar}[Arrows, slices, and $\Hom$.]\label{par:HomInQuasiCategories}
	We let $\Ar(\Cc)\coloneqq \F(\Delta^1,\Cc)$ denote the \emph{arrow quasi-category} of $\Cc$. The inclusions $\{0\}\rightarrow \Delta^1$ and $\{1\}\rightarrow\Delta^1$ induce a source and a target projection $s,t\colon \Ar(\Cc)\rightarrow \Cc$. Furthermore, for $x,y\in \Cc$, we define the \emph{Hom anima $\Hom_\Cc(x,y)$} and the \emph{slice quasi-category $\Cc_{x/}$} via the pullbacks\label{enum:HomInQuasiCategories}
	\begin{equation*}
		\begin{tikzcd}
			\Hom_\Cc(x,y)\dar\rar\drar[pullback] & \Cc_{x/}\dar\rar\drar[pullback] & \Ar(\Cc)\dar["{(s,t)}"]\\
			\{x\}\times\{y\}\rar & \{x\}\times\Cc\rar & \Cc\times\Cc
		\end{tikzcd}
	\end{equation*}
	We'll prove in \cref{cor:HomAnima} that $\Hom_\Cc(x,y)$ is always an anima in the sense of \cref{def:Anima} below, and in \cref{cor:FIsKanComplex} that $\Ar(\Cc)$ and $\Cc_{x/}$ are quasi-categories. So these constructions live up to their names. Furthermore, it follows from \cref{lem:SimplicialHoNerveAdjunction} below and $\Delta^1\cong\N([1])$ that we have an isomorphism of simplicial sets $\Ar(\N(\Dd))\cong \N(\Ar(\Dd))$ for every ordinary category $\Dd$, so it makes sense to use the same notation as in \cref{con:1ArrowCategory}. Furthermore, since $\N\colon \cat{Cat}\rightarrow \cat{sSet}$ preserves pullbacks (being a right adjoint), it follows that $\N(\Dd)_{y/}\cong \N(\Dd_{y/})$ for all $y\in\Dd$. Finally, it follows that $\Hom_{\N(\Dd)}(x,y)$ is a \emph{discrete simplicial set}, that is, a disjoint union of copies of $\Delta^0$, with the indexing set being $\Hom_\Dd(x,y)$. So our construction of $\Hom$ recovers the usual notion for ordinary categories.
	
	Be aware that $\Cc_{x/}$ is \emph{not} the slice construction from \cite[Proposition~\HTTthm{1.2.9.2}]{HTT} or \cite[Definition~1.4.13]{Land}; instead, it corresponds to their \emph{fat slice} $\Cc^{x/}$. I like our definition better because it is in line with \cref{con:1SliceCategory} and we'll avoid using the other slice construction (or rather hide its unavoidable usages in black boxes). It can be shown that while the two slice constructions are not isomorphic, they are equivalent as quasi-categories  (see \cite[Proposition~\HTTthm{4.2.1.5}]{HTT} or \cite[Proposition~2.5.27]{Land}), so once we're out of the simplicial swamp (that is, starting from \cref{sec:InftyCategoryTheory}), the distinction won't matter.
\end{numpar}
\begin{numpar}[Compositions.]\label{par:Composition}
	Morphisms in a quasi-category can be composed, albeit not uniquely. To explain how this works, let's first describe an equivalence relation on morphisms. For morphisms $\alpha,\alpha'\colon x\rightarrow y$ we say \emph{$\alpha$ and $\alpha'$ are equivalent}, $\alpha\simeq \alpha'$, if the map $\sigma\colon \partial\Delta^2\rightarrow \Cc$ represented by
	\begin{equation*}
		\sigma=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base)]
			\path node[outer sep=0.25ex] (0) at (0,0) {$x$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$y$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$y$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge node[swap] {$\alpha$} (1)
			(1) edge node[swap,text depth=0pt] {$\id_z$} (2)
			(0) edge node {$\alpha'$} (2);
		\end{tikzpicture}
	\end{equation*}
	can be extended to a map $\ov\sigma\colon\Delta^2\rightarrow \Cc$ satisfying $\ov\sigma|_{\partial\Delta^2}=\sigma$. Even though the definition is asymmetric in $\alpha$ and $\alpha'$, it turns out that \enquote{$\simeq$} is an equivalence relation on $\Cc_1$. For reflexivity, we can just take $\ov\sigma_\mathrm{ref}\coloneqq s_1^*(\alpha)$ to be a degenerate simplex. For symmetry and transitivity, consider the maps $\vartheta_\mathrm{sym}\colon \Lambda_1^3\rightarrow \Cc$ and $\vartheta_\mathrm{trans}\colon \Lambda_2^3\rightarrow \Cc$ represented as follows (the missing faces have been highlighted):
	\begin{equation*}
		\vartheta_\mathrm{sym}=\begin{tikzpicture}[commutative diagrams/every diagram, baseline=(mid.base)]
			\path node[outer sep=0.25ex] (0) at (0,0) {$x$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$y$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$y$} ++(180:3.8em) node[outer sep=0.25ex] (3) {$y$};
			\path (0) to coordinate[pos=0] (020) coordinate[pos=1] (021) (2);
			\path (0) to coordinate[pos=0] (030) coordinate[pos=1] (031) (3);
			\path (2) to coordinate[pos=0] (230) coordinate[pos=1] (231) (3);
			\fill[pattern={Lines[xshift=-0.5em,angle=45, line width=0.2em, distance=0.4em]},pattern color=white!93!black] (020) to (021) to[out=150,in=270] (230) to (231) to[out=270,in=30] (031) to (030) to[out=30,in=150] cycle;
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge node[swap] {$\alpha$} (1)
			(1) edge node[swap,text depth=0pt] {$\id_y$} (2)
			(0) edge node[text depth=0pt,swap,xshift=-1.3em] {$\smash{\alpha'}\vphantom{\alpha}$} (2)
			(0) edge node[text depth=0pt] {$\alpha$} (3)
			(2) edge node[swap] {$\id_y$} (3)
			(1) edge[shorten <=2.75em] (3)
			(1) edge[shorten >=2.75em,-] node[text depth=0.15em,pos=0.3,sloped] {$\id_y$} (3);
			\path (0) to node[pos=0.5] (mid) {} (2);
		\end{tikzpicture}\quad\text{and}\quad
		\vartheta_\mathrm{trans}=\begin{tikzpicture}[commutative diagrams/every diagram, baseline=(mid.base)]
			\path node[outer sep=0.25ex] (0) at (0,0) {$x$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$y$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$y$} ++(180:3.8em) node[outer sep=0.25ex] (3) {$y$};
			\path (0) to coordinate[pos=0] (010) coordinate[pos=1] (011) (1);
			\path (0) to coordinate[pos=0] (030) coordinate[pos=1] (031) (3);
			\path (1) to coordinate[pos=0] (130) coordinate[pos=1] (131) (3);
			\fill[pattern={Lines[xshift=-0.75em,angle=25, line width=0.2em, distance=0.4em]}, pattern color=white!93!black] (010) to (011) to[out=90,in=240] (130) to (131) to[out=240,in=30] (031) to (030) to[out=30,in=90] cycle;
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge node[swap] {$\alpha$} (1)
			(1) edge node[swap,text depth=0pt] {$\id_y$} (2)
			(0) edge  node[text depth=0pt,swap,xshift=-1.3em] {$\smash{\alpha'}\vphantom{\alpha}$} (2)
			(0) edge node[text depth=0pt] {$\smash{\alpha''}\vphantom{\alpha}$} (3)
			(2) edge node[swap] {$\id_y$} (3)
			(1) edge[shorten <=2.75em] (3)
			(1) edge[shorten >=2.75em,-] node[text depth=0.15em,pos=0.3,sloped] {$\id_y$} (3);
			\path (0) to node[pos=0.5] (mid) {} (2);
		\end{tikzpicture}
	\end{equation*}
	More precisely, the face $\vartheta_\mathrm{sym}|_{\Delta^{\{0,1,2\}}}$ is a $2$-simplex witnessing $\alpha\simeq \alpha'$, whereas the faces $\vartheta_\mathrm{sym}|_{\Delta^{\{0,1,3\}}}=s_1^*(\alpha)$ and $\vartheta_\mathrm{sym}|_{\Delta^{\{1,2,3\}}}=s_1^*(\id_y)=s_1^*s_0^*(y)$ are degenerate simplices. Likewise, the faces $\vartheta_\mathrm{trans}|_{\Delta^{\{0,1,2\}}}$ and $\vartheta_\mathrm{trans}|_{\Delta^{\{0,2,3\}}}$ are $2$-simplices witnessing $\alpha\simeq \alpha'$ and $\alpha'\simeq \alpha''$, respectively, whereas the face $\vartheta_\mathrm{trans}|_{\Delta^{\{1,2,3\}}}=s_1^*(\id_y)=s_1^*s_0^*(y)$ is a degenerate simplex. By \cref{def:QuasiCategory}, the horns $\vartheta_\mathrm{sym}$ and $\vartheta_\mathrm{trans}$ can be extended to $3$-simplices $\ov\vartheta_\mathrm{sym},\ov\vartheta_\mathrm{trans}\colon \Delta^3\rightarrow \Cc$ satisfying $\ov\vartheta_\mathrm{sym}|_{\Lambda_1^3}=\vartheta_\mathrm{sym}$ and $\ov\vartheta_\mathrm{trans}|_{\Lambda_2^3}=\vartheta_\mathrm{trans}$. Now the face $\ov\sigma_\mathrm{sym}\coloneqq \ov\vartheta_\mathrm{sym}|_{\Delta^{0,2,3}}$ is a $2$-simplex witnessing $\alpha'\simeq \alpha$ and $\ov\sigma_\mathrm{trans}\coloneqq \ov\vartheta_\mathrm{trans}|_{\Delta^{0,1,3}}$ witnesses $\alpha\simeq \alpha''$, proving symmetry and transitivity.
	
	
	Now let's define compositions. For morphisms $\alpha\colon x\rightarrow y$ and $\beta\colon y\rightarrow z$ in $\Cc$, consider the map $\sigma\colon\Lambda_1^2\rightarrow \Cc$ represented by
	\begin{equation*}
		\sigma=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base)]
			\path node[outer sep=0.25ex] (0) at (0,0) {$x$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$y$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$z$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge node[swap] {$\alpha$} (1)
			(1) edge node[swap,text depth=0pt] {$\beta$} (2)
			(0) edge[dotted] (2);
		\end{tikzpicture}
	\end{equation*}
	By \cref{def:QuasiCategory}, this horn admits a filler, that is, a morphism $\ov\sigma\colon \Delta^2\rightarrow\Cc$ such that $\ov\sigma|_{\Lambda_1^2}=\sigma$. If $\gamma\colon x\rightarrow z$ is the morphism in $\Cc$ represented by $\ov\sigma|_{\Delta^{\{0,2\}}}\colon \Delta^{\{0,2\}}\rightarrow \Cc$. Then $\gamma$ is called \emph{a composition of $\alpha$ and $\beta$} and we write $\gamma\simeq\beta\circ\alpha$. In particular, composition of morphisms is not unique in a quasi-category. However, if $\gamma,\gamma'\colon x\rightarrow z$ are any two compositions, then $\gamma$ and $\gamma'$ are equivalent in the sense of \cref{par:Composition} above. Indeed, then we can consider the morphism $\vartheta\colon\Lambda_1^3\rightarrow \Cc$ represented as follows (the missing face has been highlighted again):
	\begin{equation*}
		\begin{tikzpicture}[commutative diagrams/every diagram]
			\path node[outer sep=0.25ex] (0) at (0,0) {$x$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$y$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$z$} ++(180:3.8em) node[outer sep=0.25ex] (3) {$z$};
			\path (0) to coordinate[pos=0] (020) coordinate[pos=1] (021) (2);
			\path (0) to coordinate[pos=0] (030) coordinate[pos=1] (031) (3);
			\path (2) to coordinate[pos=0] (230) coordinate[pos=1] (231) (3);
			\fill[pattern={Lines[xshift=-3em,angle=45, line width=0.2em, distance=0.4em]},pattern color=white!93!black] (020) to (021) to[out=150,in=270] (230) to (231) to[out=270,in=30] (031) to (030) to[out=30,in=150] cycle;
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge node[swap] {$\alpha$} (1)
			(1) edge node[swap,text depth=0pt] {$\beta$} (2)
			(0) edge node[text depth=0pt,swap,xshift=-1.2em] {$\gamma$} (2)
			(0) edge node[text depth=0pt] {$\smash{\gamma'}\vphantom{\gamma}$} (3)
			(2) edge node[swap] {$\id_z$} (3)
			(1) edge[shorten <=2.75em] (3)
			(1) edge[shorten >=2.75em,-] node[text depth=0pt,pos=0.35,swap] {$\beta$} (3);
			%\fill[black,opacity=0.2] (020) to (021) to[out=60,in=0] (230) to (231) to[out=180,in=120] (031) to (030) to[out=300,in=240] cycle;
			%\fill[black,opacity=0.2] (0.center) to (2.center) to (3.center) to cycle;
		\end{tikzpicture}
	\end{equation*}
	Concretely, $\vartheta|_{\Delta^{\{0,1,2\}}}$ and $\vartheta|_{\Delta^{\{0,1,3\}}}$ are $2$-simplices that witness $\gamma$ and $\gamma'$ being compositions of $\alpha$ and $\beta$, whereas $\vartheta|_{\Delta^{\{1,2,3\}}}=s_1^*(\beta)\colon \Delta^{\{1,2,3\}}\rightarrow\Cc$ is a degenerate simplex. By \cref{def:QuasiCategory}, we can extend $\vartheta$ to a map $\ov\vartheta\colon \Delta^3\rightarrow \Cc$ and then the face $\ov\sigma\coloneqq\ov\vartheta|_{\Delta^{\{0,2,3\}}}$ is a $2$-simplex witnessing an equivalence $\gamma\simeq\gamma'$.
\end{numpar}
\begin{numpar}[The homotopy category.]\label{par:HomotopyCategory}
	We can now describe the homotopy category $\operatorname{ho}(\Cc)$ from \cref{par:Nerve} in more explicit terms. As already explained there, the objects of $\operatorname{ho}(\Cc)$ are the $0$-simplices $\Cc_0$, that is, the objects of $\Cc$. We've seen in \cref{par:Nerve} that the morphism may cause some problems since we might need to add compositions. However, by \cref{par:Composition} above, compositions already exist in $\Cc$, they just might not be unique. So we find that the set of morphisms of $\operatorname{ho}(\Cc)$ is given by $\Cc_1/\!\simeq$, the set of $1$-simplices modulo the equivalence condition from \cref{par:Composition}.
	
	To make this argument precise, one would have to check that $\operatorname{ho}(\Cc)$ as described above satisfies the universal property of the colimit $\colimit_{(n,\Delta^n\rightarrow\Cc)}[n]$ in $\cat{Cat}$. This is technical, but straightforward, and we leave the details to you.
\end{numpar}
As a consequence, we can prove that the construction $\F(-,-)$ from \cref{par:FInternalHom} is compatible with the functor category construction for ordinary categories.
\begin{lem}\label{lem:SimplicialHoNerveAdjunction}
	If $\Cc$ is a quasi-category and $\Dd$ is an ordinary category, then there is an isomorphism of simplicial sets
	\begin{equation*}
		\F\lef(\Cc,\N(\Dd)\righ)\cong \N\lef(\Fun(\operatorname{ho}(\Cc),\Dd)\righ)
	\end{equation*}
	In particular, if $\Cc\cong \N(\Cc')$ is the nerve of an ordinary category $\Cc'$, we get an isomorphism $\F(\N(\Cc'),\N(\Dd))\cong \N(\Fun(\Cc',\Dd))$.
\end{lem}
\begin{proof}[Proof sketch]
	For all $n\geqslant 0$, we obtain the following chain of bijections, all of which are compatible with the simplicial structure maps:
	\begin{align*}
		\F\lef(\Cc,\N(\Dd)\righ)_n\cong \Hom_{\cat{sSet}}\lef(\Delta^n\times \Cc,\N(\Dd)\righ)&\cong \Hom_{\cat{Cat}}\lef(\operatorname{ho}(\Delta^n\times \Cc),\Dd\righ)\\
		&\cong \Hom_{\cat{Cat}}\lef(\operatorname{ho}(\Cc)\times[n],\Dd\righ)\\
		&\cong \Hom_{\cat{Cat}}\lef([n],\Fun(\operatorname{ho}(\Cc),\Dd)\righ)\\
		&\cong \N\lef(\Fun(\operatorname{ho}(\Cc),\Dd)\righ)_n\,.
	\end{align*} 
	In the first step, we use the definition of $\F(-,-)$ from \cref{par:FInternalHom}. In the second step, we use the adjunction $\operatorname{ho}\colon\cat{QCat}\shortdoublelrmorphism \cat{Cat}\noloc\N$ from \cref{par:Nerve}. In the third step, we use that $\operatorname{ho}$ commutes with products of quasi-categories, which follows from the description in \cref{par:HomotopyCategory}. In the fourth step, we \enquote{currying} for ordinary categories. Finally, in the fifth step we use the definition of $\N(\Fun(\operatorname{ho}(\Cc),\Dd))$.
	
	To prove the \enquote{in particular}, it suffices to see that the unit $u_{\Cc'}\colon\Cc'\rightarrow \operatorname{ho}\N(\Cc')$ of the adjunction $\operatorname{ho}\dashv \N$ from \cref{par:Nerve} is an isomorphism of categories (and we really need an isomorphism, not just an equivalence of categories). This is easy to check using \cref{lem:LiftingConditions}\cref{enum:LiftingN} and the explicit description of $\operatorname{ho}\N(\Cc)$ from \cref{par:HomotopyCategory}.%(also note that, by \cref{lem:1FullyFaithfulConservativeAdjunction}\cref{enum:1FullyFaithfulIffUnitEquivalence}, this implies that $\N\colon \cat{Cat}\rightarrow\cat{sSet}$ is fully faithful).
\end{proof}
\begin{numpar}[Equivalences in quasicategories.]\label{par:Equivalence}
	We say that a morphism $\alpha\colon x\rightarrow y$ in $\Cc$ is an \emph{equivalence} if it becomes an isomorphism in the homotopy category $\operatorname{ho}(\Cc)$. Equivalently, $\alpha$ is an equivalence if and only if the horns $\sigma_\mathrm{left}\colon\Lambda_0^2\rightarrow\Cc$ and $\sigma_\mathrm{right}\colon\Lambda_2^2\rightarrow \Cc$ represented by\label{enum:Equivalence}
	\begin{equation*}
		\sigma_\mathrm{left}=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base)]
			\path node[outer sep=0.25ex] (0) at (0,0) {$x$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$y$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$x$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge node[swap] {$\alpha$} (1)
			(1) edge[dotted] (2)
			(0) edge node {$\id_y$} (2);
		\end{tikzpicture}
		\quad\text{and}\quad
		\sigma_\mathrm{right}=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base)]
			\path node[outer sep=0.25ex] (0) at (0,0) {$y$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$x$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$y$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge[dotted] (1)
			(1) edge node[swap] {$\alpha$} (2)
			(0) edge node {$\id_y$} (2);
		\end{tikzpicture}
	\end{equation*}
	can be filled, that is, if and only if there are $2$-simplices $\ov\sigma_\mathrm{left},\ov\sigma_\mathrm{right}\colon \Delta^2\rightarrow\Cc$ such that $\ov\sigma_\mathrm{left}|_{\Lambda_0^2}=\sigma_\mathrm{left}$ and $\ov\sigma_\mathrm{right}|_{\Lambda_2^2}=\sigma_\mathrm{right}$. Indeed, by \cref{par:Composition} above, $\ov\sigma_\mathrm{left}$ corresponds to a left inverse of $\alpha$ and $\ov\sigma_\mathrm{right}$ corresponds to a right inverse. We say \emph{$x$ and $y$ are equivalent} and write $x\simeq y$ if there exists an equivalence $\alpha\colon x\rightarrow y$.
\end{numpar}
\begin{numpar}[Sub-quasi-categories.]\label{par:SubQuasiCategories}
	If $\Cc$ is a quasi-category and $S_0\subseteq \Cc_0$ is a set of $0$-simplices, we can define a sub-simplicial set $\Cc[S_0]\subseteq \Cc$ by declaring that a simplex $\Delta^n\rightarrow \Cc$ belongs to $\Cc[S_0]$ if and only if all its vertices $\{i\}\rightarrow\Delta^n\rightarrow\Cc$ for $0\leqslant i\leqslant n$ belong to $S_0$. It's straightforward to check that $\Cc[S_0]$ is a quasi-category again: If $\Lambda_i^n\rightarrow \Cc[S_0]$ is an inner horn, any filler $\Delta^n\rightarrow\Cc$ will automatically belong to $\Cc[S_0]$, because $\Lambda_i^n\rightarrow\Delta^n$ is a bijection on vertices whenever $n\geqslant 2$. We call $\Cc[S_0]$ the \emph{full sub-quasi-category spanned by $S_0$}.\label{enum:SubQuasiCategories}
	
	Similarly, assume $S_1\subseteq \Cc_1$ is a set of $1$-simplices which contains all identities and is closed under the equivalence relation from \cref{par:Composition} as well as under compositions. We can define a sub-simplicial set $\Cc[S_1]\subseteq \Cc$ by declaring that a simplex $\Delta^n\rightarrow \Cc$ belongs to $\Cc[S_1]$ if and only if all its edges $\Delta^{\{i,j\}}\rightarrow\Delta^n\rightarrow\Cc$ for $0\leqslant i,j\leqslant n$ belong to $S_1$. Once again, if $\Lambda_i^n\rightarrow \Cc[S_1]$ is an inner horn, any filler $\Delta^n\rightarrow\Cc$ will automatically belong to $\Cc[S_1]$, because any \enquote{missing} edge in $\Delta^n\smallsetminus \Lambda_i^n$ is a composition of edges in $\Lambda_i^n$. Hence $\Cc[S_1]$ is a quasi-category again, and we call it the \emph{sub-quasi-category spanned by $S_1$} (and usually we'll emphasise that $\Cc[S_1]$ is not full).
\end{numpar}
\begin{numpar}[The opposite quasi-category.]\label{par:Opposite}
	Every quasi-category $\Cc$ admits an \emph{opposite quasi-category} $\Cc^\op$. In fact, this construction works for arbitrary simplicial sets.  Let $(-)^\op\colon \cat{Cat}\rightarrow\cat{Cat}$ be the functor that sends a category to its opposite. Consider the composition
	\begin{equation*}
		\Delta^\op\colon\IDelta\overset{U}{\longrightarrow}\cat{Cat}\xrightarrow{(-)^\op}\cat{Cat}\overset{\N}{\longrightarrow}\cat{sSet}\,,
	\end{equation*}
	where $U$ and $\N$ are the functors from \cref{par:Nerve}. This composition sends $[n]\mapsto\N([n]^\op)\cong \Delta^n$, since there is an isomorphism of categories $[n]^\op\cong [n]$ given by sending $i\mapsto n-i$. Nevertheless, $\Delta^\op$ does \emph{not} coincide with the Yoneda embedding $\Yo_{\IDelta}\colon\IDelta\rightarrow\cat{sSet}$, which also sends $[n]\mapsto\Delta^n$, since the effect on morphisms is different ($\Delta^\op$ \enquote{reverses the order} of face and degeneracy maps). According to \cref{thm:1PShFreeCocompletion}, $\Delta^\op$ admits a unique colimit-preserving extension, which we denote $(-)^\op\colon \cat{sSet}\rightarrow\cat{sSet}$. Intuitively, if $X$ is a simplicial set, then $X^\op$ is given by inverting the direction of every $1$-simplex and by reversing the order of all face and degeneracy maps. It's straightforward to check that $(-)^\op\circ (-)^\op\simeq \id_{\cat{sSet}}$ (so the right adjoint from \cref{thm:1PShFreeCocompletion} is just $(-)^\op$ again) and that $\N(\Dd)^\op\cong \N(\Dd^\op)$ holds for every ordinary category $\Dd$. Furthermore, if $\Cc$ is a quasi-category, then so is $\Cc^\op$, because $(-)^\op$ transforms an inner horn inclusion $\Lambda_i^n\rightarrow \Delta^n$, where $n\geqslant 2$ and $0<i<n$, into $\Lambda_{n-i}^n\rightarrow\Delta^n$, which is again an inner horn inclusion.
\end{numpar}
This finishes our preliminary ordinary-to-quasi-categories dictionary. Next, we'll introduce another notion that will play a central role in these notes.
\begin{defi}\label{def:Anima}
	A quasi-category $\Cc$ is called an \emph{anima} (plural \emph{animae}) if all its morphisms are equivalences in the sense of \cref{par:Equivalence}. For an arbitrary quasi-category, we let $\core(\Cc)\subseteq \Cc$ be the (non-full) sub-quasi-category spanned by the equivalences, as defined in \cref{par:SubQuasiCategories}. Then $\core(\Cc)$ is the largest anima contained in $\Cc$.
\end{defi}
\begin{thm}[Joyal, {\cite[Corollary~\href{https://people.math.rochester.edu/faculty/doug/otherpapers/Joyal-QCKC.pdf\#page=3}{1.4}]{JoyalLifting}}]\label{thm:AnimaeAreKanComplexes}
	A quasi-category $\Cc$ is a Kan complex if and only if it is an anima.
\end{thm}
\begin{proof}
	If $\Cc$ is a Kan complex, then the horns from \cref{par:Equivalence} can be filled, so $\Cc$ is an anima. The converse is much harder to prove and we'll postpone it to \cref{cor:AnimaKanComplexes}.
\end{proof}
So on one hand, by \cref{def:Anima}, animae are the analogue of groupoids in quasi-category theory. In fact, people used (and continue to use) the term \emph{$\infty$-groupoid}, before Beilinson, Clausen, and Scholze decided to invent a new term. Also recall that Grothendieck's \emph{homotopy hypothesis} predicts that the theory of $\infty$-groupoids/animae should essentially be the homotopy theory of topological spaces.

On the other hand, \cref{thm:AnimaeAreKanComplexes} says that animae are the same as \emph{Kan complexes}. We'll see in \cref{sec:SimplicialHomotopyTheory} that for the purposes of homotopy theory, Kan complexes are essentially topological spaces, which fits perfectly with Grothendieck's homotopy hypothesis. We'll keep the terms \emph{anima} and \emph{Kan complex} distinct until we've finished the proof that they coincide (\cref{cor:AnimaKanComplexes}). After that, we'll use the terms interchangeably. Starting from \cref{sec:InftyCategoryTheory}, we try to keep our arguments as model-independent as possible. Accordingly, we'll settle on \emph{anima}, only using \emph{Kan complex} to emphasise that a certain argument takes place in the concrete quasi-categorical model.


\subsection{Simplicially enriched categories}
Until now, we know a good supply of Kan complexes, given by $\Sing Y$ for every topological space $Y$ (see \cref{lem:LiftingConditions}\cref{enum:LiftingSing}). We'll see in \cref{thm:SimplicialApproximation} that these are essentially all Kan complexes. Besides that, our only other examples of quasi-categories are nerves of ordinary categories (see \cref{lem:LiftingConditions}\cref{enum:LiftingN}). These can't possibly be all! The goal of this subsection is to provide a source of non-trivial examples of quasi-categories, using a fancier version of the nerve construction.
\begin{numpar}[\enquote{Definition}.]
	A \emph{simplicially enriched category} $\Cc$ is the same as a category, except that the morphisms sets $\Hom_\Cc(x,y)$ for $x,y\in\Cc$ are replaced by simplicial sets $\F_\Cc(x,y)$. Composition of morphisms is now a map of simplicial sets $\circ\colon \F_\Cc(x,y)\times\F_\Cc(y,z)\rightarrow\F_\Cc(x,z)$ and the identity on any object $x\in\Cc$ is a $0$-simplex $\id_x\in\F_\Cc(x,x)_0$. Composition and identities are supposed to satisfy some straightforward compatibilities that we won't spell out. Furthermore, if $\Cc$ and $\Dd$ are simplicially enriched categories, there is an obvious notion of a \emph{simplicially enriched functor $F\colon \Cc\rightarrow\Dd$}. We let $\cat{Cat}_\Delta$ denote the category of (small) simplicially enriched categories and simplicially enriched functors between them. 
	
	If you would like to see a formal definition of these notions, have a look at \cite[Definitions~1.2.34 and~1.2.35]{Land}.
\end{numpar}
\begin{con}\label{con:SimplicialNerve}
	We'll construct a \enquote{simplicially thickened} versions of the ordinary categories $[n]$ and use them to define a simplicial nerve functor $\N_\Delta\colon\cat{Cat}_\Delta\rightarrow\cat{sSet}$. This is originally due to Cordier and Porter \cite{CordierPorter}.
	
	To start with, the simplicially enriched category $\CC[\Delta^n]$ is given as follows: It's objects are $0,1,\dotsc,n$ and it's morphisms are given by\label{enum:CDeltan}
	\begin{equation*}
		\F_{\CC[\Delta^n]}(i,j)\coloneqq\begin{cases*}
			\emptyset & if $i>j$\\
			\Delta^0 & if $i=j$\\
			\square^{j-i-1} & if $i<j$
		\end{cases*}\,.
	\end{equation*}
	Here $\square^n\coloneqq (\Delta^1)^n$ is the \emph{$n$-cube}. Note the shift by $-1$ in the definition! In particular, $\F_{\CC[\Delta^n]}(i,i)=\Delta^0$ (and that $0$-simplex is necessarily $\id_i$), but also $\F_{\CC[\Delta^n]}(i,i+1)=\square^0\cong \Delta^0$. The composition map $\circ\colon\F_{\CC[\Delta^n]}(i,j)\times \F_{\CC[\Delta^n]}(j,k)\rightarrow \F_{\CC[\Delta^n]}(i,k)$ is given by
	\begin{equation*}
		\square^{j-i-1}\times\square^{k-j-1}\overset{\cong}{\longrightarrow}\square^{j-i-1}\times\{1\}\times\square^{k-j-1}\subseteq \square^{k-i-1}
	\end{equation*}
	if $i<j<k$; in the other cases, there's only one possible composition map. The simplicially enriched categories $\CC[\Delta^n]$ can be assembled into a functor $\CC[-]\colon\IDelta\rightarrow\cat{Cat}_\Delta$. A conceptual construction of this functor is given in \cite[Definition~\HTTthm{1.1.5.3}]{HTT} or \cite[Lemma~1.2.62]{Land}. Since it's quite annoying to unravel said conceptual construction, let us describe the simplicially enriched functors $\CC[d_i]\colon \CC[\Delta^{n-1}]\rightarrow\CC[\Delta^n]$ and $\CC[s_j]\colon \CC[\Delta^n]\rightarrow\CC[\Delta^{n-1}]$ explicitly: On objects, $\CC[d_i]$ and $\CC[s_j]$ are just given by $d_i$ and $s_j$, repectively. For the effect on morphisms, let's first describe $\CC[d_i]\colon \F_{\CC[\Delta^{n-1}]}(k,\ell)\rightarrow \F_{\CC[\Delta^n]}(d_i(k),d_i(\ell))$ in the case $k<i\leqslant\ell$ (in all other cases, we simply get the identity). Then $d_i(k)=k$ and $d_i(\ell)=\ell+1$ and the desired morphism is\label{enum:CDeltanFunctorial}
	\begin{equation*}
		\square^{\ell-k-1}\overset{\cong}{\longrightarrow}\square^{i-k-1}\times\{0\}\times\square^{(\ell+1)-i-1}\subseteq \square^{(\ell+1)-k-1}\,.
	\end{equation*}
	Similarly, $\CC[s_j]\colon \F_{\CC[\Delta^n]}(k,\ell)\rightarrow\F_{\CC[\Delta^{n-1}]}(s_j(k),s_j(\ell))$ is only interesting for $k\leqslant j<\ell$. If $k=j$ or $j+1=\ell$, then the desired morphism $\square^{\ell-k-1}\cong (\Delta^1)^{\ell-k-1}\rightarrow (\Delta^1)^{\ell-k-2}\cong \square^{\ell-k-2}$ is given by forgetting the first or the last factor, respectively. If $k<j$ and $j+1<\ell$, then the desired morphism is
	\begin{equation*}
		\square^{\ell-k-1}\cong \square^{j-k-1}\times\square^2\times\square^{\ell-(j+1)-1}\longrightarrow\square^{j-k-1}\times\Delta^1\times\square^{\ell-(j+1)-1}\cong \square^{\ell-k-2}\,,
	\end{equation*}
	induced by the map $\square^2\rightarrow\Delta^1$ that sends $(0,0)\in\square^2$ to $0\in\Delta^1$ and the other three $0$-simplices of $\square^2$ to $1\in\Delta^1$.
	
	It can be shown that the category $\cat{Cat}_\Delta$ has all colimits (see \cite[Corollary~1.2.45]{Land}). Consequently, by \cref{thm:1PShFreeCocompletion}, the functor above admits a unique colimit-preserving extension $\CC[-]\colon\cat{sSet}\rightarrow \cat{Cat}_\Delta$, which in turn has a right-adjoint $\N_\Delta\colon \cat{Cat}_\Delta\rightarrow\cat{sSet}$, called the \emph{simplicial nerve} or \emph{coherent nerve}. By the formula from \cref{lem:1LanAlongYonedaHasRightAdjoint}, the simplicial nerve is given by
	\begin{equation*}
		\N_\Delta(\Cc)_n\cong \Hom_{\cat{Cat}_\Delta}\lef(\CC[\Delta^n],\Cc\righ)\,.
	\end{equation*}
\end{con}
\begin{lem}[Cordier--Porter, {\cite[Theorem~2.1]{CordierPorter}}]\label{lem:SimplicialNerveYieldsQuasiCategories}
	Let $\Cc$ be a small simplicially enriched category. If $\Cc$ is even Kan-enriched, that is, if $\F_\Cc(x,y)$ is a Kan complex for all $x,y\in\Cc$, then $\N_\Delta(\Cc)$ is a quasi-category.
\end{lem}
\begin{proof}[Proof sketch]
	By the adjunction $\CC[-]\colon\cat{sSet}\shortdoublelrmorphism\cat{Cat}_\Delta\noloc\N_\Delta$ from \cref{con:SimplicialNerve}, an inner horn filling problem for $\N_\Delta(\Cc)$ as in \cref{def:QuasiCategory} is equivalent to an extension problem
	\begin{equation*}
		\begin{tikzcd}
			\CC[\Lambda_i^n]\rar["f"]\dar & \Cc\\
			\CC[\Delta^n]\urar[dashed]
		\end{tikzcd}
	\end{equation*}
	of simplicially enriched categories. The morphism $\CC[\Lambda_i^n]\rightarrow\CC[\Delta^n]$ is a bijection on objects and an isomorphism on all but one simplicial sets of morphisms. The only difference is that $\F_{\CC[\Lambda_i^n]}(0,n)\rightarrow\F_{\CC[\Delta^n]}(0,n)\cong \square^{n-1}$ is given by deleting the interior and the bottom $i$-face of the $(n-1)$-cube $\square^{n-1}$. More precisely, if $\partial \square^{n-1}\coloneqq \bigcup_{j=1}^{n-1}\square^{j-1}\times(\{0\}\sqcup\{1\})\times\square^{n-j-1}$ is the \emph{boundary of the $(n-1)$-cube}, then $\F_{\CC[\Lambda_i^n]}(0,n)\rightarrow\F_{\CC[\Delta^n]}(0,n)$ can be identified with the inclusion of simplicial sets
	\begin{equation*}
		\partial \square^{n-1}\smallsetminus \left(\square^{i-1}\times\{0\}\times\square^{n-i-1}\right)\subseteq \square^{n-1}\,.
	\end{equation*}
	To make this precise, one has to show that the description of $\CC[\Lambda_i^n]$ given above satisfies the universal property of $\colimit_{(m,\Delta^m\rightarrow\Lambda_i^n)}\CC[\Delta^m]$ in $\cat{Cat}_\Delta$. This is not hard, but technical. A full argument is in \cite[Lemma~1.2.69]{Land}.
	
	So to solve the extension problem of simplicially enriched categories above, it's enough to solve the extension problem
	\begin{equation*}
		\begin{tikzcd}
			\partial \square^{n-1}\smallsetminus \left(\square^{i-1}\times\{0\}\times\square^{n-i-1}\right)\rar["f"]\dar & \F_\Cc\lef(f(0),f(n)\righ)\\
			\square^{n-1}\urar[dashed]
		\end{tikzcd}
	\end{equation*}
	of simplicial sets. This can be done by successive horn filling (or by applying the upcoming \cref{lem:AnodynePushout}, which is also proved by successive horn filling), using the fact that $\F_\Cc\lef(f(0),f(n)\righ)$ is a Kan complex, as $\Cc$ is supposed to be Kan-enriched. A complete argument is in \cite[Lemma~1.2.70]{Land}.
\end{proof}
\begin{exm}\label{exm:SimplicialNerve}
	The category of simplicial sets can be turned into a simplicially enriched category $\cat{sSet}_\Delta$ by putting $\F_{\cat{sSet}_\Delta}(X,Y)\coloneqq \F(X,Y)$. This can be used to construct some interesting quasi-categories as follows:
	\begin{alphanumerate}
		\item Restricting to the full subcategory $\cat{Kan}\subseteq \cat{sSet}$ yields a simplicial enrichment $\cat{Kan}_\Delta$. Note that $\cat{Kan}_\Delta$ is actually a Kan-enriched category, since $\F(X,Y)$ is a Kan complex whenever $Y$ is a Kan complex, as we'll see in \cref{cor:FIsKanComplex}. Up to set-theoretic difficulties that we'll not address here, \cref{lem:SimplicialNerveYieldsQuasiCategories} shows that\label{enum:An}
		\begin{equation*}
			\cat{An}\coloneqq \N_\Delta(\cat{Kan}_\Delta)
		\end{equation*}
		is a quasi-category; we call it the \emph{quasi-category of animae}.
		\item For quasi-categories $\Cc$ and $\Dd$, the simplicial set $\F(\Cc,\Dd)$ is a quasi-category; once again, this will be shown in \cref{cor:FIsKanComplex}. Then $\core \F(\Cc,\Dd)$ from \cref{def:Anima} is an anima, hence a Kan complex by \cref{thm:AnimaeAreKanComplexes}. So we can turn the category of quasi-categories $\cat{QCat}$ into a Kan-enriched category $\cat{QCat}_\Delta$ by putting $\F_{\cat{QCat}_\Delta}(\Cc,\Dd)\coloneqq \core\F(\Cc,\Dd)$. By \cref{lem:SimplicialNerveYieldsQuasiCategories} (and up to set-theoretic difficulties),\label{enum:CatInfty}
		\begin{equation*}
			\cat{Cat}_\infty\coloneqq \N_\Delta(\cat{QCat}_\Delta)
		\end{equation*}
		is a quasi-category; we call it the \emph{quasi-category of \embrace{small} quasi-categories}.
	\end{alphanumerate}
	Let's unravel how the notions from \cref{par:Composition}, \cref{par:HomotopyCategory}, and \cref{par:Equivalence} look like in the cases of $\cat{An}$ and $\cat{Cat}_\infty$. A $1$-simplex $\alpha\colon \Delta^1\rightarrow\cat{Cat}_\infty$ is equivalently a simplicially enriched functor $\ov\alpha\colon\CC[\Delta^1]\rightarrow\cat{QCat}_\Delta$. Let $\Cc\coloneqq \ov\alpha(0)$ and $\Dd\coloneqq \ov\alpha(1)$. As we've seen in \cref{con:SimplicialNerve},  $\F_{\CC[\Delta^1]}(0,1)\cong \Delta^0$. Hence $\alpha$ is given by a morphism $\Delta^0\rightarrow\core \F(\Cc,\Dd)$ of simplicial sets. In other words, a morphism in $\cat{Cat}_\infty$ is given by a functor $\Cc\rightarrow\Dd$ of quasi-categories, as we would expect.
	
	Next, let's consider a $2$-simplex $\sigma\colon\Delta^2\rightarrow\cat{Cat}_\infty$, or equivalently, simplicially enriched functors $\ov\sigma\colon \CC[\Delta^2]\rightarrow\cat{QCat}_\Delta$. Let $\Cc\coloneqq \ov\sigma(0)$, $\Dd\coloneqq \ov\sigma(1)$, and $\Ee\coloneqq \ov\sigma(2)$. Furthermore, let $F\colon \Cc\rightarrow\Dd$ and $G\colon \Dd\rightarrow \Ee$ be the functors of quasi-categories corresponding to the $1$-simplices $\sigma|_{\Delta^{\{0,1\}}}=d_2^*(\sigma)$ and $\sigma|_{\Delta^{\{1,2\}}}=d_0^*(\sigma)$. Now $\F_{\CC[\Delta^2]}(0,2)\cong\Delta^1$ by \cref{con:SimplicialNerve}, so $\ov\sigma$ induces a map $\Delta^1\rightarrow\core\F(\Cc,\Ee)$. By definition of the composition in $\CC[\Delta^2]$, we find that $\{0\}\rightarrow \core\F(\Cc,\Dd)$ is $G\circ F\colon \Cc\rightarrow \Ee$, whereas $\{1\}\rightarrow \core\F(\Cc,\Ee)$ is another functor $H\colon \Cc\rightarrow\Ee$. The morphism $\Delta^1\rightarrow\core\F(\Cc,\Ee)$ is an equivalence $G\circ F\simeq H$ in $\F(\Cc,\Ee)$.
	
	Therefore, if $F\colon \Cc\rightarrow\Dd$ and $G\colon \Dd\rightarrow\Ee$ are functors of quasi-categories, hence morphisms in $\cat{Cat}_\infty$, then a composition of $F$ and $G$ in the quasi-category $\cat{Cat}_\infty$, as defined in \cref{par:Composition}, is a functor $H\colon \Cc\rightarrow\Ee$ of quasi-categories together with an equivalence $G\circ F\simeq H$ in $\F(\Cc,\Ee)$. The same analysis can be done for $\cat{An}$. So if $f\colon X\rightarrow Y$ and $g\colon Y\rightarrow Z$ are maps of Kan complexes, corresponding to morphisms in the quasi-category $\cat{An}$, then a composition of $f$ and $g$ in the quasi-category $\cat{An}$ is a morphism $h\colon X\rightarrow Z$ together with a $1$-simplex $\Delta^1\rightarrow \F(X,Z)$ from $g\circ f$ to $h$. By \cref{par:FInternalHom}, such a $1$-simplex $\Delta^1\rightarrow \F(X,Z)$ is equivalently a map $\eta\colon \Delta^1\times X\rightarrow Z$ such that
	\begin{equation*}
		\begin{tikzcd}
			\{0\}\times X\dar\dar[phantom,""{name=A}]\arrow[from=2-2,to=1-1,commutes,xshift=-1ex]\drar[bend left,"g\circ f"]& \\
			\Delta^1\times X\rar["\eta"]& Z\\
			\{1\}\times X\uar\uar[phantom,""{name=A}]\arrow[from=2-2,to=3-1,commutes,xshift=-1ex]\urar[bend right, "h"'] & 
		\end{tikzcd}
	\end{equation*}
	commutes. In other words, $\eta$ is a \emph{homotopy from $g\circ f$ to $h$}. In summary, we obtain the following slogans:
	\begin{quote}
		\hspace{-0.6ex}\emph{\enquote{A composition in $\cat{Cat}_\infty$ is a composition in $\cat{sSet}$ up to equivalence of functors.}}
		
		\emph{\enquote{A composition in $\cat{An}$ is a composition in $\cat{sSet}$ up to homotopy.}}
	\end{quote}
	Furthermore, this analysis shows that two functors of quasicategories $F,G\colon \Cc\rightarrow \Dd$ are equivalent as morphisms in $\cat{Cat}_\infty$ in the sense of \cref{par:Composition} if and only if they are equivalent as objects in $\F(\Cc,\Dd)$. Similarly, two morphisms of animae $f,g\colon X\rightarrow Y$ are equivalent as morphisms in $\cat{An}$ in the sense of \cref{par:Composition} if and only they are homotopic. This somewhat explains the term \emph{homotopy category}.
	
	Finally, we see that an equivalence $\Cc\simeq \Dd$ in the quasi-category $\cat{Cat}_\infty$, as defined in \cref{par:Equivalence}, is given by functors of quasi-categories $F\colon \Cc\rightarrow \Dd$ and $G\colon \Dd\rightarrow \Cc$ together with equivalences $G\circ F\simeq \id_\Cc$ and $F\circ G\simeq \id_\Dd$, exactly as an equivalence of ordinary categories. Analogously, an equivalence $X\simeq Y$ in $\cat{An}$ is given by maps of Kan complexes $f\colon X\rightarrow Y$ and $g\colon Y\rightarrow X$, together with homotopies $g\circ f\simeq\id_X$ and $f\circ g\simeq \id_Y$. In other words, equivalences in $\cat{An}$ are simply \emph{homotopy equivalences}. We'll explore this in much more detail in \cref{sec:SimplicialHomotopyTheory}.
\end{exm}
It's straightforward to see from \cref{exm:SimplicialNerve} that $\cat{An}\subseteq \cat{Cat}_\infty$ is a full sub-quasi-category in the sense of \cref{par:SubQuasiCategories}. In particular, if $X$ and $Y$ are Kan complexes, then $\Hom_{\cat{An}}(X,Y)\rightarrow\Hom_{\cat{Cat}_\infty}(X,Y)$ is an isomorphism of simplicial sets. In general, \cref{thm:CordierPorter} below describes the $\Hom$ anima from \cref{par:HomInQuasiCategories} in a simplicial nerve. A relatively short proof of that theorem was given by Achim Krause and Fabian in \cite{AchimFabian}.
\begin{thm}\label{thm:CordierPorter}
	Let $\Cc$ be a Kan-enriched category. Then there is a homotopy equivalence of Kan complexes
	\begin{equation*}
		\Hom_{\N_\Delta(\Cc)}\!\left(x,y\right)\simeq \F_\Cc\!\left(x,y\right)\,.
	\end{equation*}
	In particular, $\Hom_{\cat{An}}(X,Y)\simeq \F(X,Y)$ for all $X,Y\in\cat{An}$ and $\Hom_{\cat{Cat}_\infty}(\Cc,\Dd)\simeq \core\F(\Cc,\Dd)$ for all $\Cc,\Dd\in\cat{Cat}_\infty$.\hfill$\blacksquare$
\end{thm}

\newpage
\section{Simplicial homotopy theory}\label{sec:SimplicialHomotopyTheory}
The goal of this section is to describe how to do homotopy theory with simplicial sets instead of topological spaces. This doesn't quite work on the nose, since simplicial sets are much more rigid than topological spaces. For example, consider the naive definition of homotopies: Two maps $f,g\colon X\rightarrow Y$ are said to be \emph{homotopic}, $f\simeq g$, if there exists a map $\eta\colon \Delta^1\times X\rightarrow Y$ such that the diagram
\begin{equation*}
	\begin{tikzcd}
		\{0\}\times X\dar\dar[phantom,""{name=A}]\arrow[from=2-2,to=1-1,commutes,xshift=-1ex]\drar[bend left,"f"]& \\
		\Delta^1\times X\rar["\eta"]& Z\\
		\{1\}\times X\uar\uar[phantom,""{name=A}]\arrow[from=2-2,to=3-1,commutes,xshift=-1ex]\urar[bend right, "g"'] & 
	\end{tikzcd}
\end{equation*}
commutes. This relation is \emph{not} an equivalence relation! For example, if $d_1\colon\Delta^0\simeq\{0\}\rightarrow\Delta^1$ and $d_0\colon \Delta^0\simeq\{1\}\rightarrow \Delta^1$ are the two maps from the $0$-simplex to the $1$-simplex, then $d_1\simeq d_0$, but $d_0\not\simeq d_1$. However, as we will see, everything works fine as long as we work with Kan complexes!

So instead of replacing topological spaces by arbitrary simplicial sets as a habitat for homotopy theory, we should replace them with Kan complexes. In view of \cref{thm:AnimaeAreKanComplexes}, this fits perfectly with Grothendieck's \emph{homotopy hypothesis} that $\infty$-groupoids should essentially be topological spaces.

\subsection{Fibrations and lifting properties}\label{subsec:Fibrations}
We start with several definitions that generalise the horn filling properties from \cref{def:QuasiCategory}.
\begin{defi}\label{def:Lifting}
	We say that a map $f\colon X\rightarrow Y$ of simplicial sets \emph{has lifting against $i\colon A\rightarrow B$} if every lifting problem
	\begin{equation*}
		\begin{tikzcd}
			A\rar\dar["i"']& X\dar["f"]\\
			B\rar\urar[dashed] & Y
		\end{tikzcd}
	\end{equation*}
	has a solution.
\end{defi}
\begin{defi}\label{def:Fibration}
	Let $f\colon X\rightarrow Y$ be a map of simplicial sets.
	\begin{alphanumerate}
		\item We call $f$ a \emph{Kan fibration} if it has lifting agains all horn inclusions $\Lambda_i^n\rightarrow \Delta^n$ for $n\geqslant 1$ and $0\leqslant i\leqslant n$. We call $f$ a \emph{left}, \emph{right}, or \emph{inner fibration}, if it has lifting against all horn inclusions for $0\leqslant i<n$, all $0<i\leqslant n$, or $0<i<n$, respectively.\label{enum:KanFibration}
		\item We call $f$ a \emph{trivial fibration} if it has lifting against all boundary inclusions $\partial\Delta^n\rightarrow\Delta^n$ for all $n\geqslant 0$.\label{enum:TrivialFibration}
	\end{alphanumerate}
\end{defi}
\begin{exm}\label{exm:KanFibration}
	A simplicial set $X$ is a Kan complex if and only if $X\rightarrow *$ is a Kan fibration. $X$ is a quasi-category if and only if $X\rightarrow *$ is an inner fibration. Here and in the following we put $*\coloneqq\Delta^0$ for convenience. Furthermore, if $f\colon X\rightarrow Y$ is a Kan fibration and $Y$ is a Kan complex, then $X$ is a Kan complex too. Similarly, if $f$ is an inner fibration and $Y$ is a quasi-category, then $X$ is a quasi-category too.
\end{exm}
To analyse lifting properties, we need to introduce yet another technical notion.
\begin{defi}\label{def:Saturated}
	A class $\Sigma$ of morphisms of simplicial sets is called \emph{saturated} if the following conditions are satisfied:
	\begin{alphanumerate}
		\item $\Sigma$ is \emph{closed under pushouts}: If $(A\rightarrow B)\in\Sigma$ and $A\rightarrow C$ is an arbitrary map of simplicial sets, then $(C\rightarrow B\cup_AC)\in\Sigma$.
		\item $\Sigma$ is \emph{closed under retracts}: If we're given a commutative diagram
		\begin{equation*}
			\begin{tikzcd}
				A'\rar\dar["i'"']\drar[commutes]\ar[rr,bend left=42,"\id_{A'}"{name=A}]\arrow[from=1-2,to=A,commutes,pos=0.46] & A\dar["i"] \rar\drar[commutes] &A'\dar["i'"]\\
				B'\rar\ar[rr,bend right=42,"\id_{B'}"{swap,name=B}]\arrow[from=2-2,to=B,commutes,pos=0.46] & B\rar & B'
			\end{tikzcd}
		\end{equation*}
		such that $(i\colon A\rightarrow B)\in\Sigma$, then also $(i'\colon A'\rightarrow B')\in\Sigma$.
		\item $\Sigma$ is \emph{closed under coproducts}: If $(A_i\rightarrow B_i)\in\Sigma$, then also $\bigl(\coprod A_i\rightarrow\coprod B_i\bigr)\in\Sigma$.
		\item $\Sigma$ is \emph{closed under infinite compositions}: If $A_0\rightarrow A_1\rightarrow A_2\rightarrow \dotsb$ are all in $\Sigma$, then also $(A_0\rightarrow\colimit_{n\geqslant 0}A_n)\in\Sigma$.
	\end{alphanumerate}
	For an arbitrary class $\Sigma$ of morphisms in $\cat{sSet}$, the \emph{saturation of $\Sigma$}, $\operatorname{sat}(\Sigma)$, is the smallest saturated class containing $\Sigma$.
\end{defi}
\begin{lem}\label{lem:LiftingSaturated}
	A morphism $f\colon X\rightarrow Y$ of simplicial sets has lifting against all $(A\rightarrow B)\in\Sigma$ if and only $f$ has lifting against all $(A\rightarrow B)\in\operatorname{sat}(\Sigma)$.
\end{lem}
\begin{proof}[Proof sketch]
	It's straightforward to check that the class of morphisms that $f$ has lifting against is saturated as in \cref{def:Saturated}.
\end{proof}
\begin{defi}\label{def:Anodyne}
	\begin{alphanumerate}
		\item A morphism of simplicial sets is called \emph{anodyne} if it is contained in the saturation of all horn inclusions $\operatorname{sat}\left\{\Lambda_i^n\rightarrow\Delta^n\ \middle|\ n\geqslant 1,\,0\leqslant i\leqslant n\right\}$. Similarly, a morphism is called \emph{left}, \emph{right}, or \emph{inner anodyne} if it is contained in the saturation of those horn inclusions where $0\leqslant i<n$, $0<i\leqslant n$, or $0<i<n$, respectively.
		\item A morphism of simplicial set is a \emph{cofibration} if it is contained in the saturation of all boundary inclusions $\operatorname{sat}\left\{\partial\Delta^n\rightarrow\Delta^n\ \middle|\ n\geqslant 0\right\}$
	\end{alphanumerate}
\end{defi}
\begin{exm}
	Using \cref{lem:LiftingSaturated}, we see that Kan fibrations have lifting against all anodyne morphisms and left/right/inner fibrations have lifting against all left/right/inner anodyne morphisms. Furthermore, trivial fibrations have lifting against all cofibrations.
\end{exm}	
\begin{lem}\label{lem:Cofibration}
	A map $i\colon A\rightarrow B$ is simplicial sets is a cofibration if and only if $i$ is injective in every degree.
\end{lem}
\begin{proof}[Proof sketch]
	It's straightforward to check that degree-wise injectivity is closed under pushouts, retracts, coproducts, and infinite compositions, whence all cofibrations are degree-wise injective. Conversely, a degree-wise injective map can be built from boundary inclusions by successively adding simplices. This successive procedures needs pushouts (to add new simplices), coproducts (to add arbitrarily many simplices at once), and infinite compositions.
\end{proof}
\begin{lem}\label{lem:AnodynePushout}
	If $A\rightarrow B$ is anodyne and $A'\rightarrow B'$ is a cofibration, then
	\begin{equation*}
		A\times B'\cup_{A\times A'}B\times A'\longrightarrow B\times B'
	\end{equation*}
	is anodyne again. Analogous assertions are true for left/right/inner anodyne maps.
\end{lem}
\begin{proof}[Proof sketch]
	Fix $A'\rightarrow B'$ and consider the class $\Sigma$ of all morphisms $A\rightarrow B$ for which $A\times B'\cup_{A\times A'}B\times A'\rightarrow B\times B'$ is anodyne. Then $\Sigma$ is easily checked to be saturated. Hence it suffices to consider the case where $A\rightarrow B$ is a horn inclusion $\Lambda_i^n\rightarrow \Delta^n$. By the same argument, we can reduce to the case where $A'\rightarrow B'$ is a boundary inclusion $\partial \Delta^m\rightarrow \Delta^m$. So it suffices to check that $\Lambda_i^n\times \Delta^m\cup_{\Lambda_i^n\times \partial\Delta^m}\Delta^n\times \partial\Delta^m\rightarrow \Delta^n\times \Delta^m$. This can be done by hand, explicitly writing said map as a sequence of horn inclusions. For a complete proof in all its gory details, see \cite[Lemma~1.3.31]{Land}.
\end{proof}
\begin{cor}\label{cor:FKanFibration}
	If $i\colon A\rightarrow B$ is a cofibration and $f\colon X\rightarrow Y$ is a Kan fibration, then
	\begin{equation*}
		\F(B,X)\longrightarrow\F(B,Y)\times_{\F(A,Y)}\F(A,X)
	\end{equation*}
	is a Kan fibration. If $i\colon A\rightarrow B$ is anodyne, then the map above is even a trivial fibration. Analogous conclusions are true for left/right/inner fibrations and left/right/inner anodyne cofibrations.
\end{cor}
\begin{proof}[Proof sketch]
	By playing around with the universal properties of pushouts and pullbacks as well as the adjunction from \cref{par:FInternalHom}, we find that the following lifting problems are equivalent:
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_i^n\rar\dar & \F(B,X)\dar\\
			\Delta^n\rar\urar[dashed] & \F(B,Y)\times_{\F(A,Y)}\F(A,X)
		\end{tikzcd}\quad\text{and}\quad
		\begin{tikzcd}
			\Lambda_i^n\times B\cup_{\Lambda_i^n\times A}\Delta^n\times A\rar\dar & X\dar["f"]\\
			\Delta^n\times B\urar[dashed]\rar & Y
		\end{tikzcd}
	\end{equation*}
	Since $\Lambda_i^n\times B\cup_{\Lambda_i^n\times A}\Delta^n\times  A\rightarrow \Delta^n\times B$ is anodyne by \cref{lem:AnodynePushout} and $f\colon X\rightarrow Y$ has lifting against all anodyne maps by \cref{lem:LiftingSaturated}, the lifting problem on the right can be solved, proving that $\F(B,X)\rightarrow \F(B,Y)\times_{\F(A,Y)}\F(A,X)$ indeed has lifting against all horn inclusions. If $A\rightarrow B$ is anodyne, then the same argument shows that we even get lifting against all boundary inclusions. The other assertions are entirely analogous.
\end{proof}
\begin{cor}\label{cor:FIsKanComplex}
	Let $X$ be a Kan complex, $\Cc$ a quasi-category, and $B$ an arbitrary simplicial set. Then $\F(B,X)$ is a Kan complex and $\F(B,\Cc)$ is a quasi-category. In particular, $\Ar(\Cc)$ is a quasi-category again, and if $x\in \Cc$ is an object, then the slice $\Cc_{x/}$ from \cref{par:HomInQuasiCategories} is a quasi-category too.
\end{cor}
\begin{proof}
	For the first two assertions, apply \cref{cor:FKanFibration} to the cofibration $\emptyset\rightarrow B$ and the Kan fibration $X\rightarrow *$ or the inner fibration $\Cc\rightarrow *$, respectively. The assertion about $\Ar(\Cc)$ is just the case $B=\Delta^1$. Finally, for $\Cc_{x/}$ we use that $(s,t)\colon \Ar(\Cc)\rightarrow \Cc\times\Cc$ is an inner fibration by \cref{cor:FKanFibration} applied to the cofibration $\partial\Delta^1\rightarrow\Delta^1$. Hence its pullback $\Cc_{x/}\rightarrow \{x\}\times \Cc$ must be an inner fibration too and so $\Cc_{x/}$ is a quasi-category by \cref{exm:KanFibration}.
\end{proof}
We conclude this subsection with an immensely useful lemma.
\begin{lem}[\enquote{Small object argument}]\label{lem:SmallObjectArgument}
	Every morphism of simplicial sets $f\colon X\rightarrow Y$ can be factored as
	\begin{equation*}
		f\colon X\overset{i}{\longrightarrow}\ov X\overset{\ov f}{\longrightarrow}Y\,,
	\end{equation*}
	where $i$ is anodyne and $\ov f$ is a Kan fibration. Similarly, every morphism of simplicial sets can be factored into a left/right/inner anodyne map followed by a left/right/inner fibration, and into a cofibration followed by a trivial fibration.
\end{lem}
\begin{proof}
	We only prove the first assertion; the others are completely analogous. Let
	\begin{equation*}
		\Sigma(f)\coloneqq \left\{\sigma=\begin{tikzcd}[baseline=(A.base)]
			\Lambda_i^n\rar\dar\drar[commutes]\drar[phantom,""{name=A}] & X\dar["f"]\\
			\Delta^n\rar & Y 
		\end{tikzcd}\ \middle|\ n\geqslant 1 ,\,0\leqslant i\leqslant n\right\}
	\end{equation*}
	and consider the simplicial set $S(f)$ defined as the pushout
	\begin{equation*}
		\begin{tikzcd}
			\coprod_{\sigma\in\Sigma(f)}\Lambda_i^n\dar\rar\drar[pushout] & X\dar\\
			\coprod_{\sigma\in\Sigma(f)}\Delta^n\rar & S(f)
		\end{tikzcd}
	\end{equation*}
	Then $X\rightarrow S(f)$ is anodyne, because it is a pushout of a coproduct of horn inclusions, and $f$ factors as $f\colon X\rightarrow S(f)\rightarrow Y$. Let $X_0\coloneqq X$ and $f_0\coloneqq f$. Inductively putting $X_{n+1}\coloneqq S(f_n)$, we get factorisations
	\begin{equation*}
		f\colon X\longrightarrow X_n\overset{f_n}{\longrightarrow}Y
	\end{equation*}
	for all $n\geqslant 0$, where $X\rightarrow X_n$ is anodyne. Now let $\ov X\coloneqq \colimit_{n\geqslant 0}X_n$ and let $\ov f\colon \ov X\rightarrow Y$ be the induced map. Since anodyne maps are closed under infinite compositions, $X\rightarrow \ov X$ is anodyne. So it suffices to show that $\ov f$ is a Kan fibration. Note that $\Lambda_i^n$ is built from finitely many simplices, which are in turn glued along finitely many subsimplices. Hence, for every map $\sigma\colon \Lambda_i^n\rightarrow\ov X$, each of these finitely many simplices must occur at some finite stage of the colimit $\ov X\coloneqq \colimit_{n\geqslant 0}X_n$, and each gluing condition must be satisfied at some finite stage. Consequently, every $\sigma\colon \Lambda_i^n\rightarrow\ov X$ must factor through $X_m\rightarrow\ov X$ for $m\gge 0$. Consequently, by construction of $X_{m+1}$, every lifting problem involving $\sigma$ can be solved as
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_i^n\rar\dar& X_m\rar & X_{m+1}\rar &\ov X\dar["\ov f"]\\
			\Delta^n\ar[rrr]\ar[urr,dashed] & & & Y
		\end{tikzcd}
	\end{equation*}
	which proves that $\ov f\colon \ov X\rightarrow Y$ is a Kan fibration, as desired.
\end{proof}

\subsection{Homotopy groups}
The goal of this subsection is to introduce homotopy groups of Kan complexes (\cref{con:HomotopyGroups}) and to prove an analogue of Whitehead's theorem (\cref{thm:Whitehead}). We start noting that the naive definition of homotopies from the beginning of \cref{sec:SimplicialHomotopyTheory} works fine if $X$ is Kan.
\begin{defi}\label{def:Homotopy}
	Let $X$ be a Kan complex.
	\begin{alphanumerate}
		\item We say that $x,y\in X$ \emph{belong to the same connected component} and write $x\simeq y$ if there is a $1$-simplex $\Delta^1\rightarrow X$ from $x$ to $y$. By \cref{thm:AnimaeAreKanComplexes}, this is an equivalence relation and the notation is compatible with \cref{par:Equivalence}. We let $\pi_0(X)\coloneqq X_0/\!\simeq$ denote the set of \emph{connected components of $X$}.\label{enum:Pi0}
		\item Let $A$ be an arbitrary simplicial set. We say that $f,g\colon A\rightarrow X$ are \emph{homotopic} and write $f\simeq g$ if and only if they belong to the same connected component of $\F(A,X)$, which is a Kan complex by \cref{cor:FIsKanComplex}. A \emph{homotopy} $\eta\colon f\Rightarrow g$ is a $1$-simplex $\Delta^1\rightarrow \F(A,X)$ from $f$ to $g$.\label{enum:Homotopy}
	\end{alphanumerate}
\end{defi}
\begin{con}\label{con:FOfPairs}
	Let $A\subseteq B$ be an inclusion of arbitrary simplicial sets and $X\subseteq Y$ be an inclusion of Kan complexes. Consider the pullback
	\begin{equation*}
		\begin{tikzcd}
			\F\lef((B,A),(Y,X)\righ)\dar\rar\drar[pullback] & \F(B,Y)\dar\\
			\F(A,X)\rar & \F(A,Y)
		\end{tikzcd}
	\end{equation*}
	Note that $\F(B,Y)\rightarrow\F(A,Y)$ is a Kan fibration by \cref{cor:FKanFibration} and $\F(A,X)$ is a Kan complex by \cref{cor:FIsKanComplex}. Therefore $\F\lef((B,A),(Y,X)\righ)$ is a Kan complex too.
\end{con}
\begin{con}\label{con:HomotopyGroups}
	Let $X$ be a Kan complex, $x\in X$ a point, and $n\geqslant 1$. Furthermore, recall from \cref{con:SimplicialNerve} that we use $\square^n$ and $\partial\square^n$ to denote the $n$-cube $(\Delta^1)^n$ and its boundary $\bigcup_{i=1}^n\square^{i-1}\times(\{0\}\sqcup\{1\})\times\square^{n-i}$. We define the \emph{$n$\textsuperscript{th} homotopy group of $X$ with basepoint $x$} as
	\begin{equation*}
		\pi_n(X,x)\coloneqq\pi_0\F\lef((\square^n,\partial\square^n),(X,x)\righ)\,.
	\end{equation*}
	As the name suggests, $\pi_n(X,x)$ is a group, so let's construct a group operation! Given elements $[\alpha],[\beta]\in\pi_n(X,x)$, represented by maps of pairs $\alpha,\beta\colon (\square^n,\partial\square^n)\rightarrow (X,x)$, we can define a map $(\alpha,\beta)\colon \Lambda_1^2\times\square^{n-1}\rightarrow X$ by $(\alpha,\beta)|_{\Delta^{\{0,1\}}\times\square^{n-1}}\coloneqq \alpha$ and $(\alpha,\beta)|_{\Delta^{\{1,2\}}\times\square^{n-1}}\coloneqq \beta$; this is possible since $\alpha$ and $\beta$ agree on the \enquote{overlap} $\square^{n-1}\times\{1\}$, as they're both equal to $\const x$ there. Now consider the extension problem
	\begin{equation*}
		\begin{tikzcd}[column sep=5.2em]
			\Lambda_1^2\times\square^{n-1}\cup_{\Lambda_1^2\times\partial\square^{n-1}}\Delta^2\times\partial\square^{n-1}\dar\rar["{(\alpha,\,\beta)\,\cup\, \const x}"] & X\\
			\Delta^2\times\square^{n-1}\urar[dashed,"\vartheta"',end anchor=202]
		\end{tikzcd}
	\end{equation*}
	Since the vertical arrow is anodyne by \cref{lem:AnodynePushout}, this extension problem has a solution $\vartheta$. By construction, $\vartheta|_{\partial(\Delta^{\{0,2\}}\times\square^{n-1})}=\const x$. We then define $[\alpha]\boldsymbol{\cdot}[\beta]\coloneqq [\vartheta|_{\Delta^{\{0,2\}}\times\square^{n-1}}]$
\end{con}
\begin{lem}\label{lem:HomotopyGroups}
	Let $X$ be a Kan complex, let $x\in X$ be a point, and let $n\geqslant 1$.
	\begin{alphanumerate}
		\item \!The operation $\cdot$ from \cref{con:HomotopyGroups} is well-defined \embrace{that is, independent of the choices of $\alpha$, $\beta$, and $\vartheta$} and defines a group structure on $\pi_n(X,x)$.\label{enum:HomotopyGroupsWellDefined}
		\item Let $n\geqslant 2$. By \enquote{permuting the coordinates} we obtain operations $\boldsymbol{\cdot}_1,\boldsymbol{\cdot}_2,\dotsc,\boldsymbol{\cdot}_n$, where $\boldsymbol{\cdot}_1=\boldsymbol{\cdot}$. Then these operations all coincide and are commutative.\label{enum:EckmannHilton}
	\end{alphanumerate}
\end{lem}
\begin{proof}[Proof sketch]
	All assertions in \cref{enum:HomotopyGroupsWellDefined} can be proved by solving extension problems of the form
	\begin{equation}\label{eq:HomotopyGroups}\tag{$*$}
		\begin{tikzcd}
			A\times\square^{n-1}\cup_{A\times\partial\square^{n-1}}B\times\partial\square^{n-1}\dar\rar & X\\
			B\times\square^{n-1}\urar[dashed,end anchor=202]
		\end{tikzcd}
	\end{equation}
	where $A\rightarrow B$ is anodyne (so that a solution always exists by \cref{lem:AnodynePushout}; also note that the diagram from \cref{con:HomotopyGroups} is of this form too, with $(A\rightarrow B)=(\Lambda_1^2\rightarrow\Delta^2)$).
	
	Let's start with independence of the choice of $\vartheta$. So let $\vartheta'$ be another choice. Using the same idea as in \cref{par:Composition}, we can write down an extension problem \cref{eq:HomotopyGroups}, with $(A\rightarrow B)=(\Lambda_1^3\rightarrow \Delta^3)$. Restricting any solution to $\Delta^{\{0,2,3\}}\times \square^{n-1}$ yields a homotopy of pairs $\vartheta|_{\Delta^{\{0,2\}}\times\square^{n-1}}\simeq\vartheta'|_{\Delta^{\{0,2\}}\times\square^{n-1}}$. To show that the choices of $\alpha$ and $\beta$ don't matter, suppose we're given homotopies of pairs $\alpha\simeq\alpha'$ and $\beta\simeq\beta'$ and let $[\alpha']\boldsymbol{\cdot}[\beta']=[\vartheta'|_{\Delta^{\{0,2\}}\times\square^{n-1}}]$. Using the given homotopies, we can write down an extension problem \cref{eq:HomotopyGroups}, with $(A\rightarrow B)=(\Delta^1\times\Lambda_1^2\rightarrow \Delta^1\times\Delta^2)$. Restricting to $\Delta^1\times\Delta^{\{0,2\}}\times\square^{n-1}$ yields a homotopy  of pairs $\vartheta|_{\Delta^{\{0,2\}}\times\square^{n-1}}\simeq\vartheta'|_{\Delta^{\{0,2\}}\times\square^{n-1}}$. This shows well-definedness. To show associativity, choose $(A\rightarrow B)=(\Delta^{\{0,1\}}\cup\Delta^{\{1,2\}}\cup\Delta^{\{2,3\}}\rightarrow\Delta^3)$. A neutral element is $\const x\colon (\square^n,\partial\square^n)\rightarrow (X,x)$; to show $[\alpha]\boldsymbol{\cdot}[\const x]=[\alpha]=[\const x]\boldsymbol{\cdot}[\alpha]$ for all $\alpha$, simply solve the corresponding lifting problem via degenerate simplices. Finally, to construct inverses, we take inspiration from \cref{par:Equivalence} and write down extension problems \cref{eq:HomotopyGroups} with $(A\rightarrow B)=(\Lambda_0^2\rightarrow\Delta^2)$ and $(A\rightarrow B)=(\Lambda_2^2\rightarrow\Delta^2)$ to construct a left and a right inverse. This finishes the proof sketch of \cref{enum:HomotopyGroupsWellDefined}.
	
	For \cref{enum:EckmannHilton}, we use the \emph{Eckmann--Hilton trick}: We can show simultaneously that $\boldsymbol{\cdot}_1=\boldsymbol{\cdot}_2$ and that both operations are commutative by verifying the identity
	\begin{equation*}
		\lef([\alpha]\boldsymbol{\cdot}_1[\beta]\righ)\boldsymbol{\cdot}_2\lef([\alpha']\boldsymbol{\cdot}_1[\beta']\righ)=\lef([\alpha]\boldsymbol{\cdot}_2[\alpha']\righ)\boldsymbol{\cdot}_1\lef([\beta]\boldsymbol{\cdot}_2[\beta']\righ)\,.
	\end{equation*}
	for all $\alpha$, $\alpha'$, $\beta$, and $\beta'$ (if you haven't seen this trick before, this will probably blow your mind). To show the Eckmann--Hilton identity, consider the extension problem
	\begin{equation*}
		\begin{tikzcd}[column sep=8.5em]
			\Lambda_1^2\times\Lambda_1^2\times\square^{n-2}\cup_{\Lambda_1^2\times\Lambda_1^2\times\partial\square^{n-2}}\Delta^2\times\Delta^2\times\partial\square^{n-2}\dar\rar["{((\alpha,\,\beta),\,(\alpha',\,\beta'))}\,\cup\,{\const x}"] & X\\
			\Delta^2\times\Delta^2\times\square^{n-1}\urar[dashed,"\rho"',end anchor=202]
		\end{tikzcd}
	\end{equation*}
	which has a solution by \cref{lem:AnodynePushout}. Then observe that for any solution $\rho$, both sides of the Eckmann--Hilton identity are given by $[\rho|_{\Delta^{\{0,2\}}\times \Delta^{\{0,2\}}\times\square^{n-2}}]$.
\end{proof}
%The rest of this subsection will be devoted to prove an analogue of Whitehead's theorem for Kan complexes.
\begin{thm}[\enquote{Whitehead's theorem for Kan complexes}]\label{thm:Whitehead}
	Let $f\colon X\rightarrow Y$ be a morphism of Kan complexes. Then $f$ is a homotopy equivalence if and only if it induces a bijection $\pi_0(X)\cong \pi_0(Y)$ and isomorphisms $\pi_n(X,x)\cong \pi_n(Y,f(x))$ for all $x\in X$ and all $n\geqslant 1$.
\end{thm}
The proof of \cref{thm:Whitehead} will occupy the rest of this subsection. The first step is an analogue of the long exact sequence of a Serre fibration.
\begin{lem}[\enquote{Long exact sequence of a fibration}]\label{lem:FibrationSequence}\label{lem:LongExactFibrationSequence}
	Let $f\colon X\rightarrow Y$ be a Kan fibration between Kan complexes. Let $x\in X$, let $y\coloneqq f(x)$ be its image, and let $F\coloneqq f^{-1}\{y\}=\{y\}\times_YX$ be the fibre over $y$. Then there exists a long exact sequence of groups/pointed sets
	\begin{multline*}
		\dotsb\longrightarrow\pi_n(F,x)\longrightarrow \pi_n(X,x)\longrightarrow\pi_n(Y,y)\overset{\partial}{\longrightarrow}\pi_{n-1}(F,x)\longrightarrow\dotsb\\
		\dotsb\longrightarrow\pi_1(X,x)\longrightarrow\pi_1(Y,y)\overset{\partial}{\longrightarrow}\pi_0(F)\longrightarrow\pi_0(X)\longrightarrow\pi_0(Y)\,.
	\end{multline*}
	In low degrees, exactness means the following:
	\begin{alphanumerate}
		\item \!There is an action $\pi_1(Y,y)\times\pi_0(F)\rightarrow\pi_0(F)$ such that $\pi_1(Y,y)\rightarrow \pi_0(F)$ is given by acting on $[x]\in \pi_0(F)$, the stabiliser of $[x]$ is precisely the image of $\pi_1(X,x)\rightarrow\pi_1(Y,y)$, and two elements of $\pi_0(F)$ map to the same element in $\pi_0(X)$ if and only if they lie in the same orbit of the $\pi_1(Y,y)$-action.\label{enum:ActionOfPi1}
		\item An element in $\pi_0(X)$ maps to the class $[y]\in\pi_0(Y)$ if and only if it lies in the image of $\pi_0(F)\rightarrow \pi_0(X)$.
	\end{alphanumerate}
\end{lem}
\begin{proof}[Proof sketch]
	You can take any proof of the long exact sequence of a Serre fibration, like \cite[Theorem~\href{https://pi.math.cornell.edu/~hatcher/AT/AT.pdf\#page=385}{4.41}]{Hatcher} and adapt the arguments to the simplicial setting. So we'll only explain how to construct the boundary map $\partial$. So let $[\alpha]\in\pi_{n+1}(Y,y)$, where $\alpha\colon(\square^{n+1},\partial\square^{n+1})\rightarrow(Y,y)$ is a map of pairs as usual. Consider the lifting problem
	\begin{equation*}
		\begin{tikzcd}
			\{0\}\times\square^n\cup_{\{0\}\times\square^n}\Delta^1\times\partial\square^n\rar["\const x"]\dar & X\dar["f"]\\
			\Delta^1\times\square^n\rar["\alpha"]\urar[dashed,"\vartheta"'] & Y
		\end{tikzcd}
	\end{equation*}
	which has a solution $\vartheta$ by \cref{lem:AnodynePushout}. Then $\vartheta|_{\{1\}\times\square^n}\colon \{1\}\times\square^n\rightarrow X$ factors over $F\rightarrow X$ and it maps $\{1\}\times \partial\square^n$ to $x$. Thus we can define $\partial[\alpha]\coloneqq [\vartheta|_{\{1\}\times\square^n}]\in\pi_n(F,x)$.
\end{proof}
\begin{rem}\label{rem:ExactnessInLowDegrees}
	We will often use \cref{lem:FibrationSequence} in conjunction with the five lemma to deduce that a map of Kan complexes induces a bijection on $\pi_0$ and isomorphisms on $\pi_n$ for all basepoints and all $n\geqslant 1$ (and is thus a homotopy equivalence by \cref{thm:Whitehead}). But the five lemma only applies for exact sequences of groups, not pointed sets. However, these arguments can be saved using the group action from \cref{lem:FibrationSequence}\cref{enum:ActionOfPi1}. We will usually skip the verification in low degrees and just cite the five lemma.
\end{rem}
We also need an alternative description of homotopy groups. This is how Goerss and Jardine define them in \cite[\S \href{http://dodo.pdmi.ras.ru/~topology/books/goerss-jardine.pdf\#page=37}{I.7}]{GoerssJardine}; we chose the cubical approach since it makes the group multiplication easier to visualise.
\begin{lem}\label{lem:HomotopyGroupsSimplex}
	Let $X$ be a Kan complex, let $x\in X$, and let $n\geqslant 0$. Then there is a bijection
	\begin{equation*}
		\pi_n(X,x)\cong \pi_0\F\lef((\Delta^n,\partial\Delta^n),(X,x)\righ)\,.
	\end{equation*}
\end{lem}
\begin{proof}[Proof sketch]
	By cutting out a single $n$-simplex from $\square^n$, we can obtain a sub-simplicial set $C^n\subseteq\square^n$ such that $\partial\square^n\subseteq C^n$ is anodyne (more precisely, it can be written as an iterated pushout of horn inclusions) and $\square^n/C^n\cong \Delta^n/\partial\Delta^n$. For example, in the case $n=2$, we can take
	\begin{equation*}
		\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base), decoration={markings,mark=at position 0.5 with {\arrow{to}}}]
			\path node[outer sep=0.25ex] (00) at (0,0) {$\bullet$} ++(3.8em,0) node (10) {$\bullet$} ++ (0,3.8em) node (11) {$\bullet$} ++(-3.8em,0) node (01) {$\bullet$};
			\path[commutative diagrams/.cd, every arrow, every label]
			(00) edge[-,postaction={decorate}] node[below=1ex] {$\displaystyle\partial\square^2$} (10)
			(10) edge[-,postaction={decorate}] (11)
			(00) edge[-,postaction={decorate}] (01)
			(01) edge[-,postaction={decorate}] (11);
		\end{tikzpicture}\subseteq
		\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base), decoration={markings,mark=at position 0.5 with {\arrow{to}}}]
			\path node[outer sep=0.25ex] (00) at (0,0) {$\bullet$} ++(3.8em,0) node (10) {$\bullet$} ++ (0,3.8em) node (11) {$\bullet$} ++(-3.8em,0) node (01) {$\bullet$};
			\path[commutative diagrams/.cd, every arrow, every label]
			(00) edge[-,postaction={decorate}] node[below=1ex] {$\displaystyle C^2$} (10)
			(10) edge[-,postaction={decorate}] (11)
			(00) edge[-,postaction={decorate}] (01)
			(01) edge[-,postaction={decorate}] (11)
			(00) edge[-,postaction={decorate}] (11);
			\path
			(01) to node[pos=0.25] {$\scriptscriptstyle/\!/\!/$} (10);
		\end{tikzpicture}\subseteq
		\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base), decoration={markings,mark=at position 0.5 with {\arrow{to}}}]
			\path node[outer sep=0.25ex] (00) at (0,0) {$\bullet$} ++(3.8em,0) node (10) {$\bullet$} ++ (0,3.8em) node (11) {$\bullet$} ++(-3.8em,0) node (01) {$\bullet$};
			\path[commutative diagrams/.cd, every arrow, every label]
			(00) edge[-,postaction={decorate}] node[below=1ex] {$\displaystyle \square^2$} (10)
			(10) edge[-,postaction={decorate}] (11)
			(00) edge[-,postaction={decorate}] (01)
			(01) edge[-,postaction={decorate}] (11)
			(00) edge[-,postaction={decorate}] (11);
			\path
			(01) to node[pos=0.25] {$\scriptscriptstyle/\!/\!/$} node[pos=0.75] {$\scriptscriptstyle/\!/\!/$} (10);
		\end{tikzpicture}
	\end{equation*}
	In general, the $n$-simplex $\Delta^n\rightarrow \square^n$ sends the vertex $\{i\}$ to the vertex $\{1\}^i\times\{0\}^{n-i}$. Now observe that since $x$ is just a point, we have $\F((B,A),(X,x))\cong \F((B/A,*),(X,x))$ for every inclusion $A\subseteq B$ of simplicial sets. Since $\square^n/C^n\cong \Delta^n/\partial\Delta^n$, we only need to prove $\pi_0\F((\square^n,\partial\square^n),(X,x))\cong\pi_0\F((\square^n,C^n),(X,x))$. This follows from a more general claim:
	\begin{alphanumerate}\itshape
		\item[\boxtimes] Let $A'\subseteq A$ be anodyne and let $A\subseteq B$ be any inclusion of simplicial sets. Then we have a bijection $\pi_0\F((B,A),(X,x))\cong \pi_0\F((B,A'),(X,x))$.\label{claim:Annoying}
	\end{alphanumerate}
	To prove \cref{claim:Annoying}, put $F\coloneqq \F((B,A),(X,x))$ and $F'\coloneqq \F((B,A'),(X,x))$ for short. Consider the pullback $P\coloneqq \F(A',\{x\})\times_{\F(A',X)}\F(A,X)$. Then $F'\rightarrow P$ is a Kan fibration, since it is a pullback of $\F(B,X)\rightarrow\F(A,X)$, which is Kan by \cref{cor:FKanFibration}. Manipulating pullbacks, we find $F\cong \F(A,\{x\})\times_PF'$. Now $\F(A,\{x\})\cong *$ is just a point, so $F$ is a fibre of the Kan fibration $F'\rightarrow F$. Furthermore, $P\rightarrow \F(A',\{x\})\cong *$ is a trivial fibration, since it is a pullback of $\F(A,X)\rightarrow\F(A',X)$, which is a trivial fibration by \cref{cor:FKanFibration}. By \cref{lem:TrivialFibrationHomotopyEquivalence} below, this means that $P\rightarrow *$ is a homotopy equivalence and so all homotopy groups of $P$ vanish. Using the long exact sequence from \cref{lem:LongExactFibrationSequence} (for every basepoint in $F'$; a single basepoint won't suffice), we can conclude $\pi_0(F)\cong \pi_0(F')$, as claimed. Note that this works even though we only have an exact sequence of pointed sets on $\pi_0$. This finishes the proof. Another proof of (a more general version of) \cref{claim:Annoying} is in \cite[Lemma~V.3.13]{HigherCatsI}.
\end{proof}
\begin{lem}\label{lem:TrivialFibrationHomotopyEquivalence}
	If $f\colon X\rightarrow Y$ is a trivial fibration between Kan complexes, then $f$ is a homotopy equivalence. Similarly, if $F\colon \Cc\rightarrow\Dd$ is a trivial fibration between quasi-categories, then $F$ is an equivalence as in \cref{exm:SimplicialNerve}.
	
	The same would be true for any trivial fibration of simplicial sets, except that we haven't defined what a \embrace{homotopy} equivalence of simplicial sets would be in general.
\end{lem}
\begin{proof}
	Since trivial fibrations have lifting against all cofibrations, we can use the lifting problems
	\begin{equation*}
		\begin{tikzcd}
			\emptyset\rar\dar & X\dar["f"]\\
			Y\eqar[r]\urar[dashed,"g"'] & Y
		\end{tikzcd}\quad\text{and}\quad
		\begin{tikzcd}
			\{0\}\times X\sqcup \{1\}\times X\ar[rr,"{(g\circ f,\,\id_X)}"]\dar & & X\dar["f"]\\
			\Delta^1\times X\rar\ar[urr,dashed,"\eta"',end anchor=202] & X\rar["f"] &Y
		\end{tikzcd}
	\end{equation*}
	to first construct a map $g\colon Y\rightarrow X$ such that $f\circ g=\id_Y$ and then to construct a homotopy $\eta\colon g\circ f\Rightarrow \id_X$. Similarly, if $F\colon \Cc\rightarrow \Dd$ is a trivial fibration between quasi-categories, we get a functor $G\colon \Dd\rightarrow\Cc$ such that $F\circ G=\id_\Dd$ and a natural transformation $\eta\colon G\circ F\Rightarrow \id_\Cc$. To show that $\eta$ is an equivalence in $\F(\Cc,\Cc)$ (and thus prove that $F$ and $G$ are mutually inverse equivalences of quasi-categories), we lift furthermore against $\Delta^1\times\Cc\rightarrow\N(J)\times \Cc$, where $J\coloneqq \left\{\InlineJ\right\}$ is the \enquote{free-living isomorphism}, the category with two objects and a pair of mutually inverse isomorphisms between them. 
\end{proof}
The crucial step in the proof of \cref{thm:Whitehead} is to show a \enquote{compression lemma}, as in the proof of Whitehead's theorem in topology (compare to \cite[Lemma~\href{https://pi.math.cornell.edu/~hatcher/AT/AT.pdf\#page=356}{4.6}]{Hatcher}). 
\begin{lem}[\enquote{Compression lemma}]\label{lem:CompressionLemma}
	Let $X$ be a connected Kan complex \embrace{that is, $\pi_0(X)=*$} such that $\pi_n(X,x)\cong0$ for all $x\in X$ and all $n\geqslant 1$. Let $A\subseteq B$ be an inclusion of simplicial sets, $f\colon B\rightarrow X$ a map and $\eta\colon \Delta^1\times A\rightarrow X$ a homotopy from $f|_A$ to $\const x$. Then $\eta$ can be extended to a homotopy $\ov\eta\colon \Delta^1\times B\rightarrow X$ from $f$ to $\const x$.
\end{lem}
\begin{proof}
	We can construct $\ov\eta$ simplex by simplex, so it suffices to treat the case $A=\partial\Delta^n$ and $B=\Delta^n$ for some $n\geqslant 0$. Consider the extension problem
	\begin{equation*}
		\begin{tikzcd}
			\{0\}\times\Delta^n\cup_{\{0\}\times\partial\Delta^n}\Delta^1\times\partial\Delta^n\rar["{(f,\,\eta)}"]\dar & X\\
			\Delta^1\times\Delta^n\urar[dashed,"\vartheta"'] & 
		\end{tikzcd}
	\end{equation*}
	which has a solution $\vartheta$ by \cref{lem:AnodynePushout}. Then $\vartheta|_{\{1\}\times\partial\Delta^n}=\const x$, hence $\vartheta|_{\{1\}\times\Delta^n}$ defines an element in $\pi_0\F((\Delta^n,\partial\Delta^n),(X,x))\cong \pi_n(X,x)\cong0$ using \cref{lem:HomotopyGroupsSimplex} and our assumption on $X$. Hence there is a homotopy $\vartheta'\colon \Delta^1\times\Delta^n\rightarrow X$ such that $\vartheta'|_{\Delta^1\times\partial\Delta^n}=\const x$ as well as $\vartheta'|_{\{0\}\times\Delta^n}=\vartheta|_{\{1\}\times\Delta^n}$ and $\vartheta'|_{\{1\}\times\Delta^n}=\const x$. To construct $\ov\eta$, we can now simply compose the homotopies $\vartheta$ and $\vartheta'$ (which we do by solving an extension problem along the anodyne map $\Lambda_1^2\times\Delta^n\rightarrow\Delta^2\times\Delta^n$ and then restricting to $\Delta^{\{0,2\}}\times \Delta^n$).
\end{proof}
\begin{lem}\label{lem:ContractibleKanComplex}
	If $X$ is a Kan complex as in \cref{lem:CompressionLemma}, then $X\rightarrow *$ is a trivial fibration.
\end{lem}
\begin{proof}
	We have to show that every extension problem of the following form is solvable:
	\begin{equation*}
		\begin{tikzcd}
			\partial\Delta^n\rar["\sigma"]\dar& X\\
			\Delta^n\urar[dashed] &
		\end{tikzcd}
	\end{equation*}
	Using \cref{lem:CompressionLemma} (applied to $A=\emptyset$ and $B=\partial\Delta^n$), there is a homotopy $\eta\colon \Delta^1\times\partial\Delta^n\rightarrow X$ from $\sigma$ to $\const x$. Now consider the extension problem
	\begin{equation*}
		\begin{tikzcd}[column sep=4em]
			\Delta^1\times\partial\Delta^n\cup_{\{1\}\times\partial\Delta^n}\{1\}\times\Delta^n\dar\rar["{(\eta,\,\const x)}"] & X\\
			\Delta^1\times\Delta^n\urar[dashed,"\vartheta"',end anchor=202] &
		\end{tikzcd}
	\end{equation*}
	which has a solution $\vartheta$ by \cref{lem:AnodynePushout} as usual. Then $\vartheta|_{\{0\}\times\Delta^n}$ provides a solution of the original extension problem.
\end{proof}
\begin{lem}\label{lem:TrivialFibration}
	Let $f\colon X\rightarrow Y$ be a Kan fibration between Kan complexes and assume $f$ satisfies the condition from \cref{thm:Whitehead}. Then $f$ is a trivial fibration.
\end{lem}
\begin{proof}
	We have to show that every extension problem of the following form is solvable:
	\begin{equation*}
		\begin{tikzcd}
			\partial\Delta^n\rar["\ov\sigma"]\dar& X\dar["f"]\\
			\Delta^n\urar[dashed]\rar["\sigma"] & Y
		\end{tikzcd}
	\end{equation*}
	Let $\eta\colon\Delta^1\times\Delta^n\rightarrow\Delta^n$ be a homotopy from $\id_{\Delta^n}$ to $\const n$ (such a homotopy can easily be constructed by hand). Then $\sigma\circ \eta\colon\Delta^1\times\Delta^n\rightarrow Y$ is a homotopy from $\sigma$ to $\const y$, where $y=\sigma(n)$. Now let $F\coloneqq f^{-1}\{y\}=\{y\}\times_YX$ be the fibre over $y$ and consider the lifting problem
	\begin{equation*}
		\begin{tikzcd}[column sep=huge]
			\{0\}\times\partial\Delta^n\rar["\ov\sigma"]\dar & X\dar["f"]\\
			\Delta^1\times\partial\Delta^n\urar[dashed,"\vartheta"']\rar["\sigma\circ\eta|_{\Delta^1\times\partial\Delta^n}"] & Y
		\end{tikzcd}
	\end{equation*}
	which can be solved by \cref{lem:AnodynePushout}. Then $\vartheta|_{\{1\}\times\partial\Delta^n}\colon \{1\}\times\partial\Delta^n\rightarrow X$ factors over $F\rightarrow X$. Using the long exact sequence from \cref{lem:FibrationSequence} and the assumption on $f$, we see $\pi_n(F,x)\cong0$ for all $x\in F$ and all $n\geqslant 0$. Hence $F\rightarrow *$ is a trivial fibration by \cref{lem:ContractibleKanComplex} and so $\vartheta|_{\{1\}\times\partial\Delta^n}\colon \{1\}\times\partial\Delta^n\rightarrow F$ can be extended to a map $\ov\vartheta\colon \{1\}\times\Delta^n\rightarrow F$. Finally, consider the lifting problem
	\begin{equation*}
		\begin{tikzcd}
			\Delta^1\times\partial\Delta^n\cup_{\{1\}\times\partial\Delta^n}\{1\}\times\Delta^n\rar["{(\vartheta,\,\ov\vartheta)}"]\dar & X\dar["f"]\\
			\Delta^1\times\Delta^n\urar[dashed,"\rho"']\rar & Y
		\end{tikzcd}
	\end{equation*}
	which can be solved by \cref{lem:AnodynePushout}. Then $\rho|_{\{0\}\times\Delta^n}$ provides a solution for the original lifting problem and we're done.
\end{proof}
\begin{proof}[Proof of \cref{thm:Whitehead}]
	Let's first assume that $f\colon X\rightarrow Y$ is a homotopy equivalence. Then $f$ clearly induces a bijection $\pi_0(X)\cong \pi_0(Y)$. But to get isomorphisms $\pi_n(X,x)\cong \pi_n(Y,y)$ for all $x\in X$, $y=f(x)$, and all $n\geqslant 1$, we have to show that $f\colon (X,x)\rightarrow(Y,y)$ is also a pointed homotopy equivalence, which is not entirely trivial. 
	
	It suffices to show that $\pi_0\F((Y,y),(Z,z))\rightarrow \pi_0\F((X,x),(Z,z))$ is surjective for every pointed Kan complex $(Z,z)$. Indeed, if this is true, then plugging in $(Z,z)=(X,x)$ yields a pointed map $g\colon (Y,y)\rightarrow (X,x)$ together with a pointed homotopy $g\circ f\simeq\id_{(X,x)}$. In particular, $g$ is a homotopy equivalence too. Repeating the argument with $g$, we obtain $h\colon (X,x)\rightarrow (Y,y)$ together with $h\circ g\simeq\id_{(Y,y)}$. Then $g$ is a pointed homotopy equivalence and thus $f$ must be a pointed homotopy equivalence too. To show that $f^*$ is surjective
	
	To show that $\pi_0\F((Y,y),(Z,z))\rightarrow \pi_0\F((X,x),(Z,z))$ is surjective, first note that we have Kan fibrations
	\begin{equation*}
		\ev_x\colon \F\!\left(X,Z\right)\longrightarrow\F\lef(\{x\},Z\righ)\cong Z\quad\text{and}\quad\ev_y\colon \F\!\left(Y,Z\right)\longrightarrow \F\lef(\{y\},Z\righ)\cong Z
	\end{equation*}
	by \cref{cor:FKanFibration}. Using \cref{con:FOfPairs}, we see that the fibres of these fibrations are given by $\ev_x^{-1}\{z\}\cong \F((X,x),(Z,z))$ and $\ev_y^{-1}\{z\}\cong \F((Y,y),(Z,z))$. Using \cref{lem:FibrationSequence}, we obtain exact sequences
	\begin{equation*}
		\begin{tikzcd}
			\dotsb\rar & \pi_1\!\left(Z,z\right)\eqar[d]\rar & \pi_0\F\lef((Y,y),(Z,z)\righ)\dar\rar & \pi_0\F\!\left(Y,Z\righ)\dar["\cong"] \rar & \pi_0\!\left(Z\right)\rar\eqar[d] & \dotsb\\
			\dotsb\rar & \pi_1\!\left(Z,z\right)\rar & \pi_0\F\lef((X,x),(Z,z)\righ)\rar & \pi_0\F\!\left(X,Z\righ)\rar & \pi_0\!\left(Z\right)\rar& \dotsb
		\end{tikzcd}
	\end{equation*}
	Since we assume $f\colon X\rightarrow Y$ to be an unpointed homotopy equivalence, it induces a bijection $\pi_0\F(Y,Z)\cong\pi_0\F(X,Z)$, as indicated above. Then a diagram chase involving \cref{lem:FibrationSequence}\cref{enum:ActionOfPi1} shows that $\pi_0\F((Y,y),(Z,z))\rightarrow \pi_0\F((X,x),(Z,z))$ is surjective. As argued above, this is what we need.
	
	Conversely, assume that $f\colon X\rightarrow Y$ induces a bijection $\pi_0(X)\cong \pi_0(Y)$ and isomorphisms $\pi_n(X,x)\cong \pi_n(Y,y)$ for all $x\in X$, $y=f(x)$, and all $n\geqslant 1$. \cref{lem:SmallObjectArgument} allows us to choose a factorisation
	\begin{equation*}
		f\colon X\overset{i}{\longrightarrow} \ov X\overset{\ov f}{\longrightarrow}Y
	\end{equation*}
	where $i$ is anodyne and $\ov f$ is a Kan fibration. Then $i$ and $\ov f$ are homotopy equivalences. Indeed, \cref{cor:FKanFibration} shows that $\F(\ov X,Z)\rightarrow\F(X,Z)$ is a trivial fibration for every Kan complex $Z$, hence a bijection on $\pi_0$ by \cref{lem:TrivialFibrationHomotopyEquivalence}. Plugging in $Z=X$ and $Z=\ov X$ shows that $i$ is a homotopy equivalence, as claimed.  The Kan fibration $\ov f\colon \ov X\rightarrow Y$ is a trivial fibration by \cref{lem:TrivialFibration}, hence a homotopy equivalence by \cref{lem:TrivialFibrationHomotopyEquivalence}. We are done!
\end{proof}

\subsection{Simplicial approximation and model categories}

\begin{thm}[Simplicial approximation]\label{thm:SimplicialApproximation}
	For every Kan complex $X$ we have a bijection $\pi_0(X)\cong \pi_0(\left|X\right|)$ and isomorphisms $\pi_n(X,x)\cong \pi_n(\left|X\right|,x)$ for all $x\in X$ and all $n\geqslant 1$. Similarly, for every topological space $Y$ we have a bijection $\pi_0(Y)\cong \pi_0(\Sing Y)$ and isomorphisms $\pi_n(Y,y)\cong \pi_n(\Sing Y,y)$ for all $y\in Y$ and all $n\geqslant 1$. In particular, the adjunction
	\begin{equation*}
		\left|\,\cdot\,\right|\colon \cat{Kan}\doublelrmorphism \cat{Top}\noloc \Sing
	\end{equation*}
	from \cref{par:GeometricRealisation} induces homotopy equivalences $u_X\colon X\overset{\simeq}{\longrightarrow} \Sing\left|X\right|$ for all Kan complexes $X$ and weak equivalences $c_Y\colon \left|\Sing Y\right|\rightarrow Y$ for every topological space $Y$.\hfill$\blacksquare$
\end{thm}
The proof of \cref{thm:SimplicialApproximation} is a technical headache. For a full proof, have a look at Fabian's and Christoph Winges' lecture notes \cite[\S V.5]{HigherCatsI}; several versions of this theorem can also be found in \cite[\S \href{https://pi.math.cornell.edu/~hatcher/AT/AT.pdf\#page=186}{2.C}]{Hatcher}.

\cref{thm:SimplicialApproximation} is an incarnation of Grothendieck's \emph{homotopy hypothesis}. It tells us, essentially, that as long as we're only interested in topological up to weak equivalence, or CW complexes up to homotopy equivalence, we can safely pass to the category of Kan complexes, or better yet, to the quasi-category $\cat{An}$ from \cref{exm:SimplicialNerve}\cref{enum:An}. In particular, everything we would ever like to know about homotopy groups (or homology groups etc.) will be captured by $\cat{An}$! We'll see through many examples how this point of view leads to clean, abstract, and conceptually satisfying proofs of many classical topological results and ultimately to a deeper understanding of homotopy theory.

At this point it seems natural to leave a few words about \emph{model categories}. Historically, these have played a dominating role in the development of $\infty$-category theory and to this day they are an indispensible tool in the foundations of the topic (especially in the proof of Lurie's straightening/unstraightening equivalence, \cref{thm:Straightening}) as well as in many other areas of topology. So dismissing them as a tool of the past would be blatantly ignorant and outright disrespectful. Still, model categories run contrary to the modern point of view that I'm trying to get across in these notes, and so I'll try to avoid them entirely (which is not least achieved by conveniently hiding their unavoidable uses in black boxes). But at the very least, I should tell you the definition.	
\begin{defi}\label{def:ModelCategory}
	Let $\Aa$ be a category with finite limits and colimits. A \emph{model structure on $\Aa$} consists of 3 classes of morphisms $C$, $F$, and $W$ (\emph{cofibrations}, \emph{fibrations}, and \emph{weak equivalences}) satisfying the following properties:
	\begin{alphanumerate}
		\item All isomorphisms of $\Aa$ are contained in each of $C$, $F$, $W$, and all of them are closed under retracts.
		\item $W$ is closed under $2$-out-of-$3$. That is, if two of $f$, $g$, and $g\circ f$ are weak equivalences, then so is the third.
		\item A lifting problem
		\begin{equation*}
			\begin{tikzcd}
				a\rar\dar["i"'] & x\dar["f"]\\
				b\urar[dashed]\rar & y
			\end{tikzcd}
		\end{equation*}
		with $i\in C$ a cofibration and $f\in F$ a fibration has a solution if $i$ is a \emph{trivial cofibration} (a cofibration that is also a weak equivalence) or if $f$ is a \emph{trivial fibration} (a fibration that is also a weak equivalence).
		\item Every morphism in $\Aa$ can be factored into a cofibration followed by a trivial fibration and into a trivial cofibration followed by a fibration. That is, if $a\rightarrow y$ is a morphism in $\Aa$, then there exist factorisations
		\begin{equation*}
			a\longrightarrow x\longrightarrow y\quad\text{and}\quad a\longrightarrow b\longrightarrow y\,,
		\end{equation*}
		where $(a\rightarrow x)\in C$ and $(x\rightarrow y)\in F\cap W$ as well as $(a\rightarrow b)\in C\cap W$ and $(b\rightarrow y)\in F$. Sometimes these factorisations are required to be functorial.
	\end{alphanumerate}
	A category $\Aa$ equipped with a model structure is called a \emph{model category}. If $\Aa$ is a model category, then $x\in \Aa$ is called \emph{cofibrant} if the map from the initial object to $x$ is a cofibration, and \emph{fibrant} if the map from $x$ to the terminal object is a fibration. We call $x$ \emph{bifibrant} if it is both fibrant and cofibrant.
\end{defi}
\begin{exm}\label{exm:KanQuillenModelStructure}
	Basically, the entirety of \cref{subsec:Fibrations} can be summarised by saying that $\cat{sSet}$ carries a model structure in which cofibrations are exactly that, fibrations are Kan fibrations, and weak equivalences are morphisms that can be factored into an anodyne map followed by a trivial fibration. This model structure is called the \emph{Kan--Quillen model structure}.
\end{exm}
\begin{exm}\label{exm:JoyalModelStructure}
	As the Kan--Quillen model structure \enquote{models} the quasi-category $\cat{An}$ from  \cref{exm:SimplicialNerve}, it seems natural to ask whether there is another model structure on $\cat{sSet}$ that \enquote{models} $\cat{Cat}_\infty$. The naive attempt would be to ask that fibrations be inner fibrations and that trivial cofibrations be inner anodyne maps. But there are examples of cofibrations between quasi-categories that are equivalences in $\Cat_\infty$, but not inner anodyne; for example, the functor $\{0\}\rightarrow \N(J)$, where $J=\left\{\InlineJ\right\}$ is the \enquote{free-living isomorphism}. It was an insight of Joyal that this can be fixed: There is a model structure on $\cat{sSet}$, called the \emph{Joyal model structure} such that cofibrations are just that and weak equivalences are those maps $A\rightarrow B$ such that $\pi_0\core\F(B,\Cc)\rightarrow \pi_0\core\F(A,\Cc)$ is bijective for every quasi-category $\Cc$. Here $\pi_0\core$ means the set of equivalence classes of objects; once we've proved the hard part of \cref{thm:AnimaeAreKanComplexes}, this notation will be consistent with \cref{def:Homotopy}\cref{enum:Pi0}. Weak equivalences in the Joyal model structure are called \emph{Joyal equivalences}. We'll give another characterisation in \cref{lem:JoyalEquivalence} below.
	
	Fibrant objects in the Joyal model structure are precisely quasi-categories. General fibrations in the Joyal model structure are harder to pin down. However, fibrations between quasi-categories are characterised by a lifting property: They are those inner fibrations that also have lifing against $\{0\}\rightarrow\N(J)$. We'll call these \emph{isofibrations} and we'll meet them again in model category fact~\cref{par:HomotopyPullback}\cref{enum:HomotopyPullbackOfQuasicategories}. For proofs see \cite[Theorem~\href{https://mat.uab.cat/~kock/crm/hocat/advanced-course/Quadern45-2.pdf\#page=153}{6.12}]{JoyalQuasiCategoriesAndApplications} or \cite[Theorem~VIII.23]{HigherCatsII}.
\end{exm}
\begin{lem}\label{lem:JoyalEquivalence}
	A map $A\rightarrow B$ of simplicial sets is a Joyal equivalence if and only if $\F(B,\Cc)\rightarrow\F(A,\Cc)$ is an equivalence in $\cat{Cat}_\infty$ for every quasi-category $\Cc$.
\end{lem}
\begin{proof}
	The \enquote{if} part is trivial, so assume $A\rightarrow B$ is a Joyal equivalence as in \cref{exm:JoyalModelStructure}.  By \cref{lem:SmallObjectArgument}, we may choose an inner anodyne map $B\rightarrow\Bb$ into a quasi-category and a factorisation $A\rightarrow\Aa\rightarrow\Bb$ into an inner anodyne map followed by an inner fibration. Then $\Aa$ is a quasi-category too. Note that $\F(\Aa,\Cc)\rightarrow \F(A,\Cc)$ is a trivial fibration by \cref{cor:FKanFibration} and thus an equivalence of quasi-categories by \cref{lem:TrivialFibrationHomotopyEquivalence}; the same is true for $\F(\Bb,\Cc)\rightarrow \F(B,\Cc)$. So it's enough to show that $\F(\Bb,\Cc)\rightarrow\F(\Aa,\Cc)$ is an equivalence of quasi-categories, and for this, it's enough to show that our functor $F\colon \Aa\rightarrow\Bb$ is an equivalence of quasi-categories.
	
	We know that $F^*\colon \pi_0\core\F(\Bb,\Cc)\rightarrow\pi_0\core\F(\Aa,\Cc)$ is bijective for every quasi-category $\Cc$. Plugging in $\Cc=\Aa$ and choosing a preimage of $\id_\Aa$ yields a functor $G\colon \Bb\rightarrow\Aa$ together with an equivalence $G\circ F\simeq \id_\Aa$. Since $F^*$ and $(G\circ F)^*$ are bijective, it follows that $G^*\colon \pi_0\core\F(\Aa,\Cc)\rightarrow\pi_0\core\F(\Bb,\Cc)$ must too be bijective for every quasi-category $\Cc$. By the same argument, we obtain $H\colon \Aa\rightarrow \Bb$ together with an equivalence $H\circ G\simeq \id_\Bb$. Then $G$ must be an isomorphism in $\operatorname{ho}(\cat{Cat}_\infty)$ and so $F$ must be too. This shows that $F$ is an equivalence in $\cat{Cat}_\infty$, as desired.
\end{proof}
\begin{exm}
	There are also several model structures on $\cat{Top}$. For example, there is the \emph{Serre--Quillen model structure}, in which cofibrations are retracts of relative CW inclusions, weak equivalences are just that, and fibrations are Serre fibrations.
	
	An adjunction $L\colon \Aa\shortdoublelrmorphism \Bb\noloc R$ between model categories is called a \emph{Quillen adjunction} if the left adjoint $L$ preserves cofibrations and trivial cofibrations, or equivalently, if the right adjoint $R$ preserves fibrations and trivial fibrations. It is called a \emph{Quillen equivalence} if, additionally, the following conditions hold:
	\begin{alphanumerate}
		\item For every cofibrant object $x\in\Aa$ and every trivial cofibration $i\colon L(x)\rightarrow y$ into a fibrant object in $\Bb$, the composition $R(i)\circ u_x\colon x\rightarrow RL(x)\rightarrow R(y)$ is a weak equivalence in $\Aa$.
		\item For every fibrant object $y\in\Bb$ and every trivial fibration $f\colon x\rightarrow R(y)$ from a cofibrant object in $\Aa$, the composition $c_y\circ L(f)\colon L(x)\rightarrow LR(y)\rightarrow y$ is a weak equivalence in $\Bb$.
	\end{alphanumerate}
	Then one way to understand \cref{thm:SimplicialApproximation} is that the adjunction $\left|\,\cdot\,\right|\colon\cat{sSet}\shortdoublelrmorphism \cat{Top}\noloc \Sing$ from \cref{par:GeometricRealisation} is a Quillen equivalence.
\end{exm}

\newpage
\section{Joyal's lifting theorem}\label{sec:JoyalLifting}
Let's begin by stating the theorem that this section owes its name to. We won't give a proof; the proof is not too difficult, at least compared to our later black box \cref{thm:Straightening}, but it uses some techniques (joins and thin slices) that we've avoided so far and will continue to avoid. If you're interested, Joyal's original proof \cite[Theorem~\href{https://people.math.rochester.edu/faculty/doug/otherpapers/Joyal-QCKC.pdf\#page=5}{2.2}]{JoyalLifting} as well as the accounts in \cite[Theorem~2.1.8]{Land} or \cite[Tag~\href{https://kerodon.net/tag/01H0}{01H0}]{Kerodon} are all very readable.
\begin{thm}[Joyal's lifting theorem]\label{thm:JoyalLifting}
	Let $p\colon \Cc\rightarrow \Dd$ be an inner fibration of quasi-categories. Then for all $n\geqslant 2$, every lifting problem of the form
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_0^n\rar\dar & \Cc\dar["p"]\\
			\Delta^n\rar\urar[dashed] & \Dd
		\end{tikzcd}\quad\text{or}\quad
		\begin{tikzcd}
			\Lambda_n^n\rar\dar & \Cc\dar["p"]\\
			\Delta^n\rar\urar[dashed] & \Dd
		\end{tikzcd}
	\end{equation*}
	in which the $1$-simplex $\Delta^{\{0,1\}}\subseteq \Lambda_0^n\rightarrow\Cc$ or $\Delta^{\{n-1,n\}}\subseteq \Lambda_n^n\rightarrow\Cc$ is sent to an equivalence in $\Cc$, admits a solution.\hfill$\blacksquare$
\end{thm}

\subsection{Consequences of Joyal's lifting theorem}
This subsection is devoted to convincing you what a ridiculously strong result \cref{thm:JoyalLifting} actually is. We begin with some simple corollaries and work our way up to two very non-trivial theorems.
\begin{cor}[\enquote{Animae and Kan complexes are the same}]\label{cor:AnimaKanComplexes}
	A quasi-category $\Cc$ is a Kan complex if and only if it is an anima, that is, if and only if all its morphisms are equivalences.
\end{cor}
\begin{proof}
	We've seen in \cref{thm:AnimaeAreKanComplexes} that Kan complexes are animae. So let's assume $\Cc$ is an anima. Since $\Cc$ is a quasi-category, it suffices to show that all outer horns $\Lambda_0^n\rightarrow \Cc$ and $\Lambda_n^n\rightarrow \Cc$ have fillers. For $n=1$, this is clear, since we can extend $\{0\}\rightarrow \Cc$ or $\{1\}\rightarrow\Cc$ to a degenerate simplex $\Delta^1\rightarrow\Cc$. For $n\geqslant 2$, we can apply \cref{thm:JoyalLifting} to the inner fibration $p\colon \Cc\rightarrow *$.
\end{proof}
\begin{cor}[\enquote{Left fibrations over animae are Kan fibrations}]\label{cor:LeftFibrationsOverAnima}
	Let $Y$ be a Kan complex and let $f\colon X\rightarrow Y$ be a left fibration. Then $f$ is a Kan fibration and thus $X$ is a Kan complex. A dual assertion holds for right fibrations.
\end{cor}
\begin{proof}[Proof sketch]
	We must show that for all $n\geqslant1$ every lifting problem
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_n^n\rar\dar & X\dar["f"]\\
			\Delta^n\rar\urar[dashed] & Y
		\end{tikzcd}
	\end{equation*}
	has a solution. Let's first consider the case $n=1$. Since every morphism of $Y$ is an equivalence by \cref{cor:AnimaKanComplexes}, the map $\Delta^1\rightarrow Y$ extends to a map $\N(J)\rightarrow Y$, where $J\coloneqq \{\InlineJ\}$ is the \enquote{free-living isomorphism}, the category with two objects and a pair of mutually inverse isomorphisms between them. It can be shown via explicit horn filling that $\{1\}\rightarrow \N(J)$ is both left and right anodyne. Since $f$ is a left fibration, we get a lift $\N(J)\rightarrow X$, which yields a solution of our original lifting problem.
	
	Now let $n\geqslant 2$. It suffices to show that every morphism in $X$ is an equivalence, because then \cref{thm:JoyalLifting} will solve our lifting problem. So let $\alpha\colon x\rightarrow y$ be a morphism in $X$ and consider the map $\sigma\colon\Lambda_0^2\rightarrow X$ represented by
	\begin{equation*}
		\sigma=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base)]
			\path node[outer sep=0.25ex] (0) at (0,0) {$x$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$y$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$x$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge node[swap] {$\alpha$} (1)
			(1) edge[dotted] (2)
			(0) edge node {$\id_x$} (2);
		\end{tikzpicture}
	\end{equation*}
	Since $Y$ is an anima, $f(\alpha)$ is an equivalence and so $\vartheta\coloneqq f\circ\sigma \colon \Lambda_0^2\rightarrow Y$ can be extended to a map $\ov\vartheta\colon \Delta^2\rightarrow Y$. Since $f\colon X\rightarrow Y$ is a left fibration, we can lift $\ov\vartheta$ to a map $\ov\sigma\colon \Delta^2\rightarrow X$ such that $\ov\sigma|_{\Lambda_0^2}=\sigma$ and $f\circ \ov\sigma=\ov\vartheta$. The $2$-simplex $\ov\sigma$ shows that $\alpha$ has a left inverse $\beta$. Repeating the argument with $\beta$, we see that $\beta$ itself has a left inverse. Then $\beta$ must be an equivalence. Hence its right inverse $\alpha$ must be an equivalence too. 
\end{proof}
\begin{cor}[\enquote{$\Hom_\Cc$ takes values in animae}]\label{cor:HomAnima}
	Let $\Cc$ be a quasi-category. Then for all $x,y\in\Cc$, the slice category projection $t\colon \Cc_{x/}\rightarrow \Cc$ from \cref{par:HomInQuasiCategories} is a left fibration and $\Hom_\Cc(x,y)$ is an anima.
\end{cor}
\begin{proof}[Proof sketch]
	By \cref{par:HomInQuasiCategories}, $t\colon \Cc_{x/}\rightarrow \Cc$ is a pullback of $(s,t)\colon \Ar(\Cc)\rightarrow \Cc\times\Cc$, which is an inner fibration by \cref{cor:FKanFibration}. Hence $t\colon \Cc_{x/}\rightarrow\Cc$ is an inner fibration too and we only need to solve outer horn lifting problems
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_0^n\rar\dar & \Cc_{x/}\dar["t"]\\
			\Delta^n\urar[dashed]\rar & \Cc
		\end{tikzcd}
	\end{equation*}
	for all $n\geqslant 1$. Write $\Cc_{x/}\cong \{x\}\times_{\Cc,s}\Ar(\Cc)$ as in \cref{par:HomInQuasiCategories}. By the usual adjunction tricks, a horn lifting problem as above is equivalent to an extension problem
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_0^n\times\Delta^1\cup_{\Lambda_0^n\times\{1\}}\Delta^n\times\{1\}\rar["f"]\dar & \Cc\\
			\Delta^n\times\Delta^1\urar[dashed,"\ov f"'] & 
		\end{tikzcd}
	\end{equation*}
	with the additional condition that $f$ satisfies $f|_{\Lambda_0^n\times\{0\}}=\const x$ and the extension must satisfy $\ov f|_{\Delta^n\times\{0\}}=\const x$. Such an extension problem can be written as a sequence of horn filling problems. Each horn is either an inner horn, which can be filled by \cref{def:QuasiCategory}, or a horn whose first edge is sent to $\const x$, which can be filled by \cref{thm:JoyalLifting}, or a horn that can be filled with a degenerate simplex. Up to the horn filling combinatorics, which we skip as usual, this proves that $t\colon \Cc_{x/}\rightarrow\Cc$ is a left fibration. 
	
	To prove that $\Hom_\Cc(x,y)$ is an anima, recall the pullback diagram
	\begin{equation*}
		\begin{tikzcd}
			\Hom_\Cc(x,y)\rar\dar\drar[pullback] & \Cc_{x/}\dar["t"]\\
			\{y\}\rar & \Cc
		\end{tikzcd}
	\end{equation*}
	from \cref{par:HomInQuasiCategories}. It follows that $\Hom_\Cc(x,y)\rightarrow\{y\}$ is a left fibration. Hence $\Hom_\Cc(x,y)$ is a Kan complex by \cref{cor:LeftFibrationsOverAnima}.
\end{proof}
%Next, we'll use \cref{thm:JoyalLifting} to prove some very non-trivial and very useful theorems.
\begin{thm}[\enquote{Equivalences of functors can be checked pointwise}]\label{thm:EquivalencePointwise}
	Let $F,G\colon \Cc\rightarrow\Dd$ be functors of quasi-categories and let $\eta\colon F\Rightarrow G$ be a natural transformation \embrace{that is, a $1$-simplex $\Delta^1\rightarrow\F(\Cc,\Dd)$ from $F$ to $G$}. Then $\eta$ is an equivalence of functors if and only if $\eta_x\colon F(x)\rightarrow G(x)$ is an equivalence in $\Dd$ for all $x\in\Cc$.
\end{thm}
If all $\eta_x\colon F(x)\rightarrow G(x)$ are equivalences, we can choose inverses $\vartheta_x\colon G(x)\rightarrow F(x)$, but already that step is non-canonical, since inverses are no longer unique in quasi-categories. To assemble the $\vartheta_x$ into a natural transformation $\vartheta\colon G\Rightarrow F$ involves infinitely more non-canonical choices, and we have to make them all in a coherent way. This is an impossible task to do by hand, but incredibly, \cref{thm:EquivalencePointwise} does it for us!
\begin{proof}[Proof sketch of \cref{thm:EquivalencePointwise}]
	The \enquote{only if} part is clear. To prove the \enquote{if} part, we start with some general observations. Let $i\colon A\rightarrow B$ be a cofibration of simplicial sets and consider lifting problems of the form
	\begin{equation}\tag*{}\label{toast}
		\tabcolsep0pt
		\noindent\begin{tabularx}{\textwidth}{l X c X c X l X c X}
			$(*)$ & & $\begin{tikzcd}[ampersand replacement=\&]
				\Lambda_0^2\dar\rar \& \F(B,\Dd)\dar\\
				\Delta^2\urar[dashed]\rar \& \F(A,\Dd)
			\end{tikzcd}$ & & or equivalently & & $(**)$ & & $\begin{tikzcd}[ampersand replacement=\&]
				\Lambda_0^2\times B\cup_{\Lambda_0^2\times A}\Delta^2\times A\dar\rar \& \Dd\\
				\Delta^2\times B\urar[dashed]\&
			\end{tikzcd}$ &
		\end{tabularx}
	\end{equation}
	Consider those (\hyperref[toast]{$**$}) for which the $1$-simplices $\Delta^{\{0,1\}}\times\{b\}\rightarrow\Lambda_0^2\times B\rightarrow \Dd$ are equivalences in $\Dd$ for all $b\in B_0$. We claim:
	\begin{alphanumerate}\itshape
		\item[\boxtimes] Let $\Sigma$ be the class of all cofibrations $i\colon A\rightarrow B$ such that every extension problem \embrace{\hyperref[toast]{$**$}}, for which $\Delta^{\{0,1\}}\times\{b\}\rightarrow\Lambda_0^2\times B\rightarrow \Dd$ are equivalences in $\Dd$ for all $b\in B_0$, can be solved. Then $\Sigma$ is saturated and contains $\partial \Delta^n\rightarrow\Delta^n$ for all $n\geqslant 0$.\label{claim:Saturated}
	\end{alphanumerate}
	Saturatedness of $\Sigma$ is straightforward to check. To see that $\Sigma$ contains $\partial \Delta^n\rightarrow\Delta^n$, one uses \cref{thm:JoyalLifting}; as usual, we skip the horn filling combinatorics. A full argument is in Fabian's notes \cite[Lemma~VII.2]{HigherCatsI}.
	
	By \cref{claim:Saturated} and \cref{lem:Cofibration}, $\Sigma$ contains all cofibrations of simplicial sets. In particular, $\Sigma$ contains $i\colon \coprod_{x\in\Cc}\{x\}\rightarrow\Cc$. Now let $\eta\colon F\Rightarrow G$ be a natural transformation such that $\eta_x\colon F(x)\rightarrow G(x)$ is an equivalence for all $x\in \Cc$. To construct a left inverse of $\eta$, consider the map $\sigma\colon\Lambda_0^2\rightarrow\F(\Cc,\Dd)$ represented by
	\begin{equation*}
		\sigma=\begin{tikzpicture}[commutative diagrams/every diagram,baseline=(mid.base)]
			\path node[outer sep=0.25ex] (0) at (0,0) {$F$} ++(0:3.8em) node[text depth=0pt,outer sep=0.25ex] (1) {$G$} ++ (120:3.8em) node[outer sep=0.25ex] (2) {$F$};
			\path (0) to node[pos=0.5] (mid) {} (2);
			\path[commutative diagrams/.cd, every arrow, every label]
			(0) edge[white,double, double equal sign distance,-{implies[black]}] (1)
			(1) edge[white,double, double equal sign distance,-{implies[black]}] (2)
			(0) edge[white,double, double equal sign distance,-{implies[black]}] (2);	\path[commutative diagrams/.cd, every arrow, every label,shift right=0.1em]
			(0) edge[shorten >=0.22em,-] node[swap] {$\eta$} (1)
			(1) edge[dotted,shorten >=0.22em,-] (2)
			(0) edge[shorten >=0.22em,-] (2);
			\path[commutative diagrams/.cd, every arrow, every label,shift left=0.1em]
			(0) edge[shorten >=0.22em,-] (1)
			(1) edge[dotted,shorten >=0.22em,-] (2)
			(0) edge[shorten >=0.22em,-] node {$\id_F$} (2);
		\end{tikzpicture}
	\end{equation*}
	Our assumption on $\eta$ means that its image under $i^*\colon \F(\Cc,\Dd)\rightarrow\F\bigl(\coprod_{x\in\Cc}\{x\},\Dd\bigr)\cong \prod_{x\in\Cc}\Dd$ is an equivalence. Hence $i^*\circ \sigma$ can be extended to a $2$-simplex $\Delta^2\rightarrow \F\bigl(\coprod_{x\in\Cc}\{x\},\Dd\bigr)$ and we obtain a lifting diagram
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_0^2\rar\dar & \F(\Cc,\Dd)\dar\\
			\Delta^2\rar\urar[dashed] & \F\left(\coprod_{x\in\Cc}\{x\},\Dd\right)
		\end{tikzcd}
	\end{equation*}
	which has a solution by what the above arguments. Hence $\eta$ has a left inverse $\vartheta\colon G\Rightarrow F$. Again, $\vartheta_x\colon G(x)\rightarrow F(x)$ must be equivalences for all $x\in\Cc$. Repeating the argument with $\vartheta$ shows that $\vartheta$ must have a left inverse too. Then $\vartheta$ must be an equivalence and so its right inverse $\eta$ must be an equivalence too.
\end{proof}
A similar miracle as \cref{thm:EquivalencePointwise} is the following theorem.

\begin{thm}[\enquote{Fully faithful \&\ essentially surjective implies equivalence}]\label{thm:EquivalenceFullyFaithfulEssentiallySurjective}
	A functor $F\colon \Cc\rightarrow \Dd$ of $\infty$-categories is an equivalence if and only if the following conditions are satisfied:
	\begin{alphanumerate}
		\item $F$ is fully faithful. That is, $F$ induces homotopy equivalences of animae
		\begin{equation*}
			\Hom_\Cc\!\left(x,y\right)\overset{\simeq}{\longrightarrow}\Hom_\Dd\lef(F(x),F(y)\righ)
		\end{equation*}
		for all $x,y\in\Cc$.
		\item $F$ is essentially surjective. That is, $F$ induces a surjection $\pi_0\core (\Cc)\rightarrow\pi_0\core(\Dd)$.
	\end{alphanumerate}
\end{thm}
\begin{rem}\label{rem:FullyFaithfulImpliesInjectiveOnPi0Core}
	The \enquote{only if} part of \cref{thm:EquivalenceFullyFaithfulEssentiallySurjective} is easy. For later use, we remark that $F\colon \Cc\rightarrow\Dd$ being fully faithful implies that $\pi_0\core(\Cc)\rightarrow\pi_0\core(\Dd)$ is injective. %Indeed, we have to show that $x\simeq y$ in $\Cc$ if and only if $F(x)\simeq F(y)$ in $\Dd$, which follows from the homotopy equivalences $\Hom_\Cc(x,x)\simeq \Hom_\Dd(F(x),F(x))$, $\Hom_\Cc(x,y)\simeq \Hom_\Dd(F(x),F(y))$, $\Hom_\Cc(y,y)\simeq \Hom_\Dd(F(y),F(y))$, and $\Hom_\Cc(y,x)\simeq \Hom_\Dd(F(y),F(x))$.
	This is purely an assertion about the homotopy categories of $\Cc$ and $\Dd$ and it follows from the fact that if $F\colon \Cc\rightarrow\Dd$ is a fully faithful functor of quasi-categories, then $\operatorname{ho}(F)\colon \operatorname{ho}(\Cc)\rightarrow \operatorname{ho}(\Dd)$ is a fully faithful functor of ordinary categories. This in turn follows from the fact that $\Hom_{\operatorname{ho}(\Cc)}(x,y)\cong \pi_0\Hom_\Cc(x,y)$, which is straightforward to check from \cref{par:HomotopyCategory}.
\end{rem}
To prove the \enquote{if} part of \cref{thm:EquivalenceFullyFaithfulEssentiallySurjective}, let's first consider the case where $\Cc$ and $\Dd$ are animae.
\begin{lem}\label{lem:FullyFaithfulAnimae}
	Let $F\colon \Cc\rightarrow\Dd$ be a fully faithful and essentially surjective functor of animae. Then $F$ is a homotopy equivalence.
\end{lem}
\begin{proof}
	Since $\Cc$ and $\Dd$ are animae, we have $\Cc=\core(\Cc)$ and $\Dd=\core(\Dd)$. By \cref{rem:FullyFaithfulImpliesInjectiveOnPi0Core} and the fact that $F$ is essentially surjective, we see that $\Cc\rightarrow\Dd$ is a bijection on path components. Hence we may assume without loss of generality that $\Cc$ and $\Dd$ are connected. Now choose $x\in\Cc$ and observe that
	\begin{equation*}
		\pi_{n+1}(\Cc,x)\cong \pi_n\lef(\Hom_\Cc(x,x),\id_x\righ)
	\end{equation*}
	holds for all $n\geqslant 0$. Indeed, by the pullback square from \cref{par:HomInQuasiCategories}, a morphism $(\square^n,\partial\square^n)\rightarrow (\Hom_\Cc(x,x),\id_x)$ is equivalently a morphism $\square^n\times\Delta^1\rightarrow \Cc$ such that $\partial \square^n\times\Delta^1\cup\square^n\times\{0,1\}\rightarrow \Cc$ is constant on $x$. But that's just a map $(\square^{n+1},\partial\square^{n+1})\rightarrow(\Cc,x)$, as claimed.
	
	Hence $F$ being fully faithful implies that $\pi_{n+1}(\Cc,x)\cong\pi_{n+1}(\Dd,F(x))$ is an isomorphism for all $n\geqslant 0$. But then $F$ is a homotopy equivalence by \cref{thm:Whitehead}.
\end{proof}
Furthermore we need:
\begin{lem}\label{lem:NonFullSubcategory}
	Let $\Cc$ be a quasi-category and let $\Cc[S_1]\subseteq \Cc$ be a \embrace{not necessarily full} sub-quasi-category spanned by a collection $S_1\subseteq \Cc_1$ of morphisms as in \cref{par:SubQuasiCategories}. Then for all $x,y\in\Cc$
	\begin{equation*}
		\Hom_{\Cc[S_1]}(x,y)\longrightarrow \Hom_\Cc(x,y)
	\end{equation*}
	is an equivalence onto the set of path components of morphisms from $S_1$.
\end{lem}
\begin{proof}[Proof sketch]
	By unravelling \cref{par:HomInQuasiCategories}, an $n$-simplex $\Delta^n\rightarrow \Hom_\Cc(x,y)$ is the same as a map $\sigma\colon \Delta^1\times\Delta^n\rightarrow \Cc$ such that $\sigma|_{\{0\}\times \Delta^n}=\sigma|_{\{1\}\times\Delta^n}=\const x$. Then $\sigma$ defines an $n$-simplex $\Delta^n\rightarrow \Hom_{\Cc[S_1]}(x,y)$ if and only if $\sigma$ maps all morphisms in $\Delta^1\times\Delta^n$ to $S_1$. Note that all morphisms in $\{0\}\times\Delta^n$ and $\{1\}\times\Delta^n$ are mapped to $\id_x$, which is contained $S_1$ because we assume that $S_1$ contains all identities. So it suffices to check that $\sigma|_{\Delta^1\times\{i\}}\colon \Delta^1\times\{i\}\rightarrow \Cc$ is contained in $S_1$ for all $i=0,\dotsc,n$, because all other morphisms in $\Delta^1\times\Delta^n$ are generated under compositions by these as well as the morphisms in $\{0\}\times \Delta^n$ and $\{1\}\times\Delta^n$. This means that an $n$-simplex $\Delta^n\rightarrow \Hom_\Cc(x,y)$ belongs to $\Hom_{\Cc[S_1]}(x,y)$ if and only if all its vertices correspond to morphisms in $S_1$. In other words, $\Hom_{\Cc[S_1]}(x,y)\subseteq\Hom_\Cc(x,y)$ is the collection of path components of morphisms from $S_1$, as desired.
\end{proof}
\begin{proof}[Proof sketch of \cref{thm:EquivalenceFullyFaithfulEssentiallySurjective}]
	Assume $F$ is fully faithful and essentially surjective. We'll show that $\core \F(K,\Cc)\rightarrow\core\F(K,\Dd)$ is a homotopy equivalence of animae for all simplicial sets $K$ (note that both $\F(K,\Cc)$ and $\F(K,\Dd)$ are indeed quasi-categories by \cref{cor:FIsKanComplex}). Once we have this, plugging in $K=\Dd$ yields a functor $G\colon \Dd\rightarrow\Cc$ with an equivalence $G\circ F\simeq\id_\Cc$. It's straightforward to see that $G$ is again fully faithful and essentially, so repeating the argument with $G$ shows that $G$ has a left inverse too. Then $G$ must be an equivalence and so its right inverse $F$ must be an equivalence too.
	
	\emph{Case $K=\Delta^0$.} In this case $\core \F(\Delta^0,\Cc)\cong \core(\Cc)$ and we must show that $\core(\Cc)\rightarrow\core(\Dd)$ is a homotopy equivalence of animae. By \cref{lem:NonFullSubcategory}, $\Hom_{\core (\Cc)}(x,y)\rightarrow \Hom_\Cc(x,y)$ is an equivalence onto those path components that correspond to equivalences from $x$ to $y$. The same is true for $\Dd$, whence $\core (\Cc)\rightarrow\core(\Dd)$ is fully faithful again. Clearly, it is essentially surjective too, so \cref{lem:FullyFaithfulAnimae} shows that $\core (\Cc)\rightarrow\core(\Dd)$ must be a homotopy equivalence.
	
	\emph{Case $K=\Delta^n$, $n\geqslant1$.} Let $I^n\coloneqq\bigcup_{i=0}^{n-1}\Delta^{\{i-1,i\}}\subseteq \Delta^n$. It's straightforward to check that $I^n\rightarrow\Delta^n$ is inner anodyne, so $\F(\Delta^n,\Cc)\rightarrow\F(I^n,\Cc)$ is a trivial fibration by \cref{cor:FKanFibration}. The same is true for $\Dd$. We may thus replace $K=\Delta^n$ by $K=I^n$. Now we claim:
	\begin{alphanumerate}\itshape
		\item[\boxtimes] If $i\colon A\rightarrow B$ is a cofibration of simplicial sets, then $i^*\colon\core \F(B,\Cc)\rightarrow\core\F(A,\Cc)$ is a Kan fibration. Furthermore, for all $x_0,x_1,\dotsc,x_n\in\Cc$, the following diagram is a pullback diagram of Kan complexes and its vertical arrows are Kan fibrations:\label{claim:Pullback}
		\begin{equation*}
			\begin{tikzcd}
				\Hom_\Cc(x_0,x_1)\times\dotsb \times\Hom_\Cc(x_{n-1},x_n)\dar\rar\drar[pullback] & \core \F(I^n,\Cc)\dar\\
				\{x_0\}\times\dotsb\times\{x_n\}\rar & \core (\Cc)\times\dotsb\times\core (\Cc)
			\end{tikzcd}
		\end{equation*}
	\end{alphanumerate}
	We know that $F$ induces a homotopy equivalence $(\core (\Cc))^{n+1}\simeq(\core(\Dd))^{n+1}$ by the case $K=*$ above as well as homotopy equivalences $\prod_{j=1}^n\Hom_\Cc(x_{j-1},x_j)\simeq \prod_{j=1}^n\Hom_\Dd(F(x_{j-1}),F(x_j))$ since we assume $F$ to be fully faithful. So if we believe \cref{claim:Pullback} (and its analogue for $\Dd$), then \cref{lem:FibrationSequence} plus the five lemma (plus \cref{rem:ExactnessInLowDegrees}) show that $\core \F(I^n,\Cc)\rightarrow\core \F(I^n,\Dd)$ induces a bijection on $\pi_0$ and isomorphisms on $\pi_n$ for all basepoints and all $n\geqslant1$. Hence $\core \F(I^n,\Cc)\rightarrow\core \F(I^n,\Dd)$ must be a homotopy equivalence by \cref{thm:Whitehead}.
	
	To prove \cref{claim:Pullback}, first note that $\F(B,\Cc)\rightarrow \F(A,\Cc)$ is an inner fibration by \cref{cor:FKanFibration}. Furthermore, if $m\geqslant 2$ and $\sigma\colon\Lambda_j^m\rightarrow \core \F(B,\Cc)$ is any $m$-dimensional horn (we allow $j=0$ or $j=m$), then any $m$-simplex $\ov\sigma\colon \Delta^m\rightarrow \F(B,\Cc)$ with $\ov\sigma|_{\Lambda_j^m}=\sigma$ is already contained in $\core \F(B,\Cc)$. Indeed, equivalences in $\Cc$ are closed under $2$-out-of-$3$, hence the edges of $\Delta^m\smallsetminus\Lambda_j^m$ will automatically be mapped to equivalences too. This observation immediately shows that $i^*\colon \core\F(B,\Cc)\rightarrow \F(A,\Cc)$ is an inner fibration again. Furthermore, \cref{thm:JoyalLifting} shows that $i^*$ has lifting agains $\Lambda_0^m\rightarrow\Delta^m$ and $\Lambda_m^m\rightarrow \Delta^m$ for all $m\geqslant 2$. It remains to deal with the case $m=1$, that is, to show lifting agains $\{0\}\rightarrow\Delta^1$ and $\{1\}\rightarrow\Delta^1$. Let's sketch how to prove the former; the latter is analogous. Building $B$ from $A$ by successively attaching simplices, we can reduce to the case where $i\colon \partial \Delta^k\rightarrow\Delta^k$ is a simplex boundary inclusion. The case $k=0$ is trivial. For $k\geqslant 1$, the map $\partial\Delta^k\rightarrow\Delta^k$ is bijective on $0$-simplices and so it suffices to show that any extension problem
	\begin{equation*}
		\begin{tikzcd}
			\partial\Delta^k\times\Delta^1\cup_{\partial\Delta^k\times\{0\}}\Delta^k\times\{0\}\rar["\sigma"]\dar & \Cc\\
			\Delta^k\times\Delta^1\urar[dashed,"\ov\sigma"'] & 
		\end{tikzcd}
	\end{equation*}
	in which $\sigma|_{\{j\}\times\Delta^1}\colon \{j\}\times\Delta^1\rightarrow\Cc$ is an equivalence in $\Cc$ for every $0$-simplex $j\in(\partial\Delta^k)_0$, admits a solution. Indeed, it follows from \cref{thm:EquivalencePointwise} that any extension $\ov\sigma\colon \Delta^k\times\Delta^1\rightarrow\Cc$ will automatically define a map $\Delta^1\rightarrow\core\F(\Delta^k,\Cc)$. To construct the desired extension, write it as a sequence of horn filling problems; each inner horn can be filled by \cref{def:QuasiCategory} and each outer horn by \cref{thm:JoyalLifting}. As usual, we skip the horn filling combinatorics. This finishes the proof that $i^*\colon \core\F(B,\Cc)\rightarrow\F(A,\Cc)$ is a Kan fibration.
	
	Choosing $i$ to be the cofibration $\{0\}\sqcup\dotsb\sqcup\{n\}\rightarrow I^n$, we see that $\core\F(I^n,\Cc)\rightarrow (\core(\Cc))^{n+1}$ is indeed a Kan fibration. It remains to show that we get a pullback diagram. Without $\core$ everywhere, it's easy to see from \cref{par:HomInQuasiCategories} that we get a pullback. It follows from \cref{cor:AnimaKanComplexes} that $\core\colon \cat{QCat}\rightarrow\cat{Kan}$ is a right adjoint to the inclusion $\cat{Kan}\subseteq\cat{QCat}$. Hence $\core$ preserves pullbacks; however, it's not clear why (and, in general, not true that) pullbacks in $\cat{QCat}$ or $\cat{Kan}$ would be the same as pullbacks in $\cat{sSet}$. However, we've seen that $\F(I^n,\Cc)\rightarrow\Cc^{n+1}$ is an inner fibration and $\core \F(I^n,\Cc)\rightarrow(\core (\Cc))^{n+1}$ is a Kan fibration. Hence in this case the pullbacks in $\cat{sSet}$ do coincide with the pullbacks in $\cat{QCat}$ and $\cat{Kan}$, respectively, and we conclude that
	\begin{equation*}
		\begin{tikzcd}
			\core\lef(\Hom_\Cc(x_0,x_1)\times\dotsb \times\Hom_\Cc(x_{n-1},x_n)\righ)\dar\rar\drar[pullback] & \core \F(I^n,\Cc)\dar\\
			\core\lef(\{x_0\}\times\dotsb\times\{x_n\}\righ)\rar & \core (\Cc)\times\dotsb\times\core (\Cc)
		\end{tikzcd}
	\end{equation*}
	is a pullback of simplicial sets. But $\{x_0\}\times\dotsb\times\{x_n\}$ and $\Hom_\Cc(x_0,x_1)\times\dotsb\times\Hom_\Cc(x_{n-1},x_n)$ are Kan complexes (the latter by \cref{cor:HomAnima}), hence coincide with their cores. This shows that we get a pullback as desired, thus finishing the proof of \cref{claim:Pullback} and the case $K=\Delta^n$.
	
	\emph{Case $K$ is finite-dimensional.} A simplicial set $K$ is called \emph{finite-dimensional} if it has non-degenerate simplices in only finitely many degrees. We use induction on maximal dimension $d$ of a non-degenerate simplex.  The case $d=0$ follows from the case $K=\Delta^0$ above. For the inductive step, we can write a $(d+1)$-dimensional simplicial set $K$ as a pushout of some $d$-dimensional simplicial set along a disjoint union $\coprod\partial\Delta^{d+1}\rightarrow\coprod\Delta^{d+1}$ of simplex boundary inclusions. Accordingly, $\F(K,\Cc)$ and $\F(K,\Dd)$ can be written as pullbacks. By arguments as in \cref{claim:Pullback}, we still get pullbacks after applying $\core$ and the legs $\core \F\bigl(\coprod\Delta^{d+1},\Cc\bigr)\rightarrow\F\bigl(\coprod\partial\Delta^{d+1},\Cc\bigr)$ and $\core \F\bigl(\coprod\Delta^{d+1},\Dd\bigr)\rightarrow\F\bigl(\coprod\partial\Delta^{d+1},\Dd\bigr)$ are Kan fibrations. Using the inductive hypothesis and the case $K=\Delta^{d+1}$ together with \cref{lem:FibrationSequence} and the five lemma (plus \cref{rem:ExactnessInLowDegrees}), we see that $\core\F(K,\Cc)\rightarrow\core\F(K,\Dd)$ induces a bijection on $\pi_0$ and isomorphisms on $\pi_n$ for all basepoints and all $n\geqslant 1$. Hence $\core\F(K,\Cc)\rightarrow\core\F(K,\Dd)$ must be a homotopy equivalence by \cref{thm:Whitehead}.
	
	\emph{General case.} Write $K\cong \colimit_{d\geqslant 0}\operatorname{sk}_dK$, where $\operatorname{sk}_dK$ is the \emph{$d$-skeleton of $K$}. It is defined as the left Kan extension 
	\begin{equation*}
		\operatorname{sk}_dK\coloneqq \Lan_{\IDelta_{\leqslant d}^\op\rightarrow\IDelta^\op}K|_{\IDelta_{\leqslant d}^\op}\,,
	\end{equation*}
	where $\IDelta_{\leqslant d}^\op\subseteq\IDelta^\op$ is the full subcategory spanned by $[0],\dotsc,[d]$. It's straightforward to see, using the Kan extension formula from \cref{lem:1KanExtensionFormula}, that $\operatorname{sk}_dK$ is $d$-dimensional and the transition maps $\operatorname{sk}_dK\rightarrow\operatorname{sk}_{d+1}K$ are cofibrations. By the finite-dimensional case, $F$ induces equivalences $\core \F(\operatorname{sk}_dK,\Cc)\overset{\simeq}{\longrightarrow}\core\F(\operatorname{sk}_dK,\Dd)$ for all $d\geqslant 0$.
	
	By the colimit above, $\F(K,\Cc)\cong\limit_{d\geqslant 0}\F(\operatorname{sk}_dK,\Cc)$. This limit is preserved by $\core$. Indeed, \cref{claim:Pullback} shows that $\core \F(\operatorname{sk}_{d+1}K,\Cc)\rightarrow \core \F(\operatorname{sk}_dK,\Cc)$ is a Kan fibration and we can apply an argument as above. The same applies to $\Dd$ instead of $\Cc$. So it remains to see that equivalences of Kan complexes are preserved under limits along Kan fibrations. This can be shown using a Milnor sequence for homotopy groups, for example, or by hand, using a straightforward, but technical argument. See \cite[Lemma~VII.12]{HigherCatsI} for example.
\end{proof}

\subsection{Localisations of \texorpdfstring{$\infty$}{Infinity}-categories}
\begin{con}\label{con:Localisation}
	Let $\Cc$ be a quasi-category and $W\subseteq \Cc_1$ a subset of morphisms. We wish to construct the localisation $\Cc\rightarrow\Cc[W^{-1}]$, that is, the universal functor of quasi-categories that sends the morphisms from $W$ to equivalences. To do so, consider the the pushout
	\begin{equation*}
		\begin{tikzcd}
			\coprod_W\Delta^1\rar\dar\drar[pushout] & \Cc\dar\\
			\coprod_W\N(J)\rar & \ov\Cc
		\end{tikzcd}
	\end{equation*}
	in simplicial sets, where $J\coloneqq \{\InlineJ\}$ is the \enquote{free-living isomorphism}, the category with two objects and a pair of mutually inverse isomorphisms between them. By \cref{lem:SmallObjectArgument}, we can choose an inner anodyne map $\ov\Cc\rightarrow\Cc[W^{-1}]$ into a quasi-category. We call the composition $p\colon \Cc\rightarrow\Cc[W^{-1}]$ the \emph{localisation of $\Cc$ at $W$}. We'll check in a moment that $p$ is independent of the choices (up to equivalence), so the definite article is justified.
\end{con}
\begin{lem}\label{lem:Localisation}
	For every quasi-category $\Dd$, the functor $p\colon \Cc\rightarrow\Cc[W^{-1}]$ from \cref{con:Localisation} above induces an equivalence
	\begin{equation*}
		p^*\colon \Hom_{\cat{Cat}_\infty}\bigl(\Cc[W^{-1}],\Dd\bigr)\overset{\simeq}{\longrightarrow}\Hom_{\cat{Cat}_\infty}^W\!\left(\Cc,\Dd\right)\subseteq \Hom_{\cat{Cat}_\infty}\!\left(\Cc,\Dd\right)
	\end{equation*}
	onto the collection of path components of those functors $F\colon \Cc\rightarrow\Dd$ that send $W$ to equivalences in $\Dd$.
\end{lem}
\begin{proof}
	Let $\F^W(\Cc,\Dd)\subseteq\F(\Cc,\Dd)$ be the full sub-quasi-category (as in \cref{par:SubQuasiCategories}) spanned by those functors $F\colon \Cc\rightarrow\Dd$ that send $W$ to equivalences in $\Dd$. We know from \cref{thm:CordierPorter} that $\Hom_{\cat{Cat}_\infty}\lef(\Cc[W^{-1}],\Dd\righ)\simeq \core\F\lef(\Cc[W^{-1}]\righ)$ and $\Hom_{\cat{Cat}_\infty}\lef(\Cc,\Dd\righ)\simeq \core\F\lef(\Cc,\Dd\righ)$; using the second equivalence, it's straightforward to check that
	\begin{equation*}
		\Hom_{\cat{Cat}_\infty}^W\!\left(\Cc,\Dd\right)\simeq \core\F^W\!\left(\Cc,\Dd\right)\,.
	\end{equation*}
	Since $\ov\Cc\rightarrow\Cc[W^{-1}]$ is inner anodyne by \cref{con:Localisation}, $\F(\Cc[W^{-1}],\Dd)\rightarrow\F(\ov\Cc,\Dd)$ is a trivial fibration by \cref{cor:FKanFibration}.
	
	We'll show that $\core\F(\ov\Cc,\Dd)\rightarrow\core\F^W\!\left(\Cc,\Dd\right)$ is a trivial fibration too to finish the proof. The pushout from \cref{con:Localisation} shows that
	\begin{equation*}
		\begin{tikzcd}
			\F\!\left(\ov\Cc,\Dd\right)\rar\dar\drar[pullback] & \F\!\left(\Cc,\Dd\right)\dar\\
			\prod_W\F\lef(\N(J),\Dd\righ)\rar & \prod_W\F\bigl(\Delta^1,\Dd\bigr)
		\end{tikzcd}
	\end{equation*}
	is a pullback of simplicial sets. Note that $\F(\ov\Cc,\Dd)\rightarrow \F(\Cc,\Dd)$ factors through the full sub-quasi-category $\F^W(\Cc,\Dd)\subseteq \F(\Cc,\Dd)$ and $\F(\N(J),\Dd)\rightarrow\F(\Delta^1,\Dd)$ factors through the full sub-quasi-category $\F^{\{0\rightarrow 1\}}(\Delta^1,\Dd)\subseteq \F(\Delta^1,\Dd)$. Since pullbacks behave well under passing to sub-simplicial sets, the following diagram is a pullback too:
	\begin{equation*}
		\begin{tikzcd}
			\F\!\left(\ov\Cc,\Dd\right)\rar\dar\drar[pullback] & \F^W\!\left(\Cc,\Dd\right)\dar\\
			\prod_W\F\lef(\N(J),\Dd\righ)\rar & \prod_W\F^{\{0\rightarrow 1\}}\bigl(\Delta^1,\Dd\bigr)
		\end{tikzcd}
	\end{equation*}
	Claim~\cref{claim:Pullback} in the proof of \cref{thm:EquivalenceFullyFaithfulEssentiallySurjective} shows that the map $\core \F(\N(J),\Dd)\rightarrow\core\F(\Delta^1,\Dd)$ is a Kan fibration. Hence $\core \F(\N(J),\Dd)\rightarrow\core\F^{\{0\rightarrow 1\}}(\Delta^1,\Dd)$ is a Kan fibration too. By the same arguments as in the proof of \cref{thm:EquivalenceFullyFaithfulEssentiallySurjective}, the diagram stays a pullback after applying $\core$ everywhere. Since $\N(J)$ is an anima, we get $\core \F\lef(\N(J),\Dd\righ)\cong \core\F\lef(\N(J),\core(\Dd)\righ)$. Since $\core(\Dd)$ is a Kan complex by \cref{cor:AnimaKanComplexes}, $\F\lef(\N(J),\core(\Dd)\righ)$ is a Kan complex by \cref{cor:FIsKanComplex} and so $\core\F\lef(\N(J),\core(\Dd)\righ)\cong \F\lef(\N(J),\core(\Dd)\righ)$. By analogous arguments, we get isomorphisms $\core\F^{\{0\rightarrow 1\}}(\Delta^1,\Dd)\cong \core\F^{\{0\rightarrow 1\}}(\Delta^1,\core (\Dd))\cong \F(\Delta^1,\core(\Dd))$. In total, we obtain a pullback diagram
	\begin{equation*}
		\begin{tikzcd}
			\core\F\!\left(\ov\Cc,\Dd\right)\rar\dar\drar[pullback] & \core\F^W\!\left(\Cc,\Dd\right)\dar\\
			\prod_W\F\lef(\N(J),\core(\Dd)\righ)\rar & \prod_W\F^{\{0\rightarrow 1\}}\bigl(\Delta^1,\core(\Dd)\bigr)
		\end{tikzcd}
	\end{equation*}
	of simplicial sets. Now $\Delta^1\rightarrow \N(J)$ is anodyne (in fact, both left and right anodyne) by an explicit horn filling argument. Hence $\F(\N(J),\core(\Dd))\rightarrow\F(\Delta^1,\core(\Dd))$ is a trivial fibration by \cref{cor:FKanFibration}. The pullback above shows that $\core\F(\ov\Cc,\Dd)\rightarrow\core\F^W\!\left(\Cc,\Dd\right)$ is a trivial fibration too and we're done.
\end{proof}
\begin{numpar}[Corollary/Warning.]\label{cor:Localisation}\itshape
	If $\Cc$ is a \embrace{small} ordinary category and $W$ a collection of morphisms in $\Cc$, then the localisation $\N(\Cc)[W^{-1}]$ from \cref{con:Localisation} is not necessarily the nerve of an ordinary category. But the homotopy category $\operatorname{ho}\N(\Cc)[W^{-1}]$ is equivalent to the localisation of $\Cc$ at $W$ in the world of ordinary categories.
\end{numpar}
\begin{proof}[Proof sketch]
	For counterexamples see \cref{thm:AnAsALocalisation} or the discussion in \cref{con:DerivedCategoryI} below. The assertion about $\operatorname{ho}\N(\Cc)[W^{-1}]$ follows easily from a combination of \cref{lem:Localisation} and \cref{lem:SimplicialHoNerveAdjunction} as well as the universal property of localisations in ordinary category theory.
\end{proof}

So localisations provide another way to construct non-trivial examples of quasi-categories. In fact, both $\cat{An}$ and $\cat{Cat}_\infty$ can be constructed in this way:
\begin{thm}\label{thm:AnAsALocalisation}
	If $\cat{Kan}_\Delta$ and $\cat{QCat}_\Delta$ are the Kan-enriched categories from \cref{exm:SimplicialNerve}, then there are canonical equivalences of quasi-categories
	\begin{align*}
		\N(\cat{Kan})\left[\left\{\text{homotopy equivalences}\right\}^{-1}\right]&\overset{\simeq }{\longrightarrow}\N_\Delta(\cat{Kan}_\Delta)=\cat{An}\,,\\
		\N(\cat{QCat})\left[\left\{\text{equivalences of quasi-categories}\right\}^{-1}\right]&\overset{\simeq }{\longrightarrow}\N_\Delta(\cat{QCat}_\Delta)=\cat{Cat}_\infty\,.\hfill\equationblackbox
	\end{align*}
\end{thm}
It's not hard to construct the functors in \cref{thm:AnAsALocalisation}: By a direct inspection of their constructions, we can build a map $\N(\cat{Kan})\rightarrow\N_\Delta(\cat{Kan}_\Delta)$ of simplicial sets (or rather simplicial \emph{classes}, but we'll ignore the set-theoretic difficulties). Using \cref{lem:Localisation}, we only need to check that this map sends homotopy equivalences in $\cat{Kan}$ to equivalences in $\N_\Delta(\cat{Kan}_\Delta)$, which is clear from the unravelling in \cref{exm:SimplicialNerve}. The same argument works for $\N_\Delta(\cat{QCat}_\Delta)$.

However, proving that these functors are equivalences is not easy. There is a general notion of \emph{simplicial model categories}: These are model categories $\Aa$ (\cref{def:ModelCategory}) together with a simplicial enrichment $\Aa_\Delta$ that interacts with the model structure in a certain way. One can show that the model structures on $\cat{sSet}$ from \cref{exm:KanQuillenModelStructure,exm:JoyalModelStructure} can be made into simplicial model structures. In general, if $\Aa$ is a simplicial model category and $\Aa^\mathrm{cf}\subseteq \Aa$ is spanned by the bifibrant objects, there is an equivalence of quasi-categories
\begin{equation*}
	\Aa^\mathrm{cf}\left[\left\{\text{weak equivalences}\right\}^{-1}\right]\overset{\simeq}{\longrightarrow}\N_\Delta(\Aa_\Delta^\mathrm{cf})\,.
\end{equation*}
A proof can be found in \cite[Theorem~\HAthm{1.3.4.20}]{HA} (also see \cite[Remark~\HAthm{1.3.4.16}]{HA} for an argument why it doesn't matter whether we invert weak equivalences in $\Aa^\mathrm{cf}$ or in the full subcategory $\Aa^\mathrm{c}\subseteq\Aa$ spanned by the cofibrant objects).

\newpage
\section{Lurie's straightening equivalence}\label{sec:Straightening}
We knew from the very beginning (see~\cref{par:HomInQuasiCategories}) what $\Hom_\Cc(x,y)$ in a quasi-category $\Cc$ is supposed to be. In this section we'll explain how to assembles these values into a Hom functor $\Hom_\Cc\colon \Cc^\op\times\Cc\rightarrow\cat{An}$ (where $\Cc^\op$ is as in \cref{par:Opposite}) and prove the Yoneda lemma. To do this, we'll use Lurie's \emph{straightening/unstraightening equivalence}, which deals with the problem of constructing functors $F\colon \Cc\rightarrow\cat{An}$ and $F\colon \Cc\rightarrow\cat{Cat}_\infty$. In the end, this will not only allow us to prove Yoneda's lemma, but the statement itself will be indispensible for developing quasi-category theory as a higher analogue of ordinary category theory.

\subsection{Cocartesian fibrations and the straightening equivalence}
%\setcounter{theorem}{-1}
\begin{numpar}[Some informal motivation.]\label{par:StraighteningMotivation}
	Let's think about what a functor $F\colon \Cc\rightarrow\cat{Cat}_\infty$ looks like. Suppose $x,y\in \Cc$ are objects and $\alpha\colon x\rightarrow y$ is a morphism then $F(x)$, $F(y)$ will be quasi-categories and $F(\alpha)\colon F(x)\rightarrow F(y)$ will be a functor between them. So for every $u\in F(x)$, there will be an associated object $v\simeq F(\alpha)(u)\in F(y)$. In a picture, this could look as follows:
	\begin{center}
		\vspace{-1ex}
		\begin{tikzpicture}[line cap=round, line join=round, line width=rule_thickness, decoration={markings,mark=at position 0.5 with {\arrow{to}}},scale=0.95]
			\begin{scope}[yshift=-3.5cm]
				\begin{scope}[xscale=0.64,xshift=-0.15cm]
					\draw[dashed,shift={(0,-0.25)},preaction={pattern={Lines[xshift=-0.4em,angle=150, line width=0.2em, distance=0.4em]}}, pattern color=white!93!black] (-0.8,0) to[out=35,in=270] (-0.6,0.2) to[out=90,in=305] (-0.8,0.6) to[out=125,in=180]  (-0.2,1) to[out=0,in=140] (0.4,0.65) to[out=320,in=100] (0.8,0.45) to[out=280,in=45] (0.6,0) to[out=225,in=90] (0.45,-0.3) to[out=270,in=135] (0.5,-0.6) to[out=315,in=90] (0.6,-0.85) to[out=270,in=70] (0.5,-1) to[out=250,in=0] (0.1,-1.2) to[out=180,in=315] (-0.6,-1) to[out=135,in=340] (-0.8,-0.7) to[out=160,in=270] (-0.9,-0.5) to[out=90,in=270] (-0.8,-0.25) to[out=90,in=205] cycle;
				\end{scope}
				\begin{scope}[xscale=0.64,xshift=2.1cm]
					\draw[dashed,shift={(3.5,-0.25)}, dash phase=3,preaction={pattern={Lines[xshift=-0.4em,angle=150, line width=0.2em, distance=0.4em]}}, pattern color=white!93!black] (-0.9,0) to[out=35,in=270] (-0.8,0.2) to[out=90,in=305] (-0.9,0.6) to[out=125,in=180]  (-0.2,1.1) to[out=0,in=140] (0.4,0.8) to[out=320,in=100] (0.85,0.6) to[out=280,in=45] (0.7,0) to[out=225,in=90] (0.6,-0.3) to[out=270,in=90] (0.65,-0.6) to[out=270,in=90] (0.75,-0.85) to[out=270,in=70] (0.65,-1.1) to[out=250,in=0] (0.1,-1.2) to[out=180,in=0] (-0.4,-1.3) to[out=180,in=315] (-0.8,-1) to[out=135,in=340] (-0.9,-0.7) to[out=160,in=270] (-1.1,-0.5) to[out=90,in=270] (-1,-0.25) to[out=90,in=205] cycle;
				\end{scope}
				\fill (0,0) circle (0.45ex) node[outer sep=0.5ex] (u) {} node[above left] {$u$};
				\fill (3.5,0) circle (0.45ex) node[outer sep=0.5ex] (v) {} node[above right] {$v$};
				\fill (3.5,-1) circle (0.45ex) node[outer sep=0.5ex] (w) {} node[below right] {$w$};
				\draw[postaction={decorate}] (v) to node[pos=0.5] (mid) {} (w);
				\draw[|-to] (u) to (v);
				\draw[-to] (0.4,-0.5) to node[pos=0.5,below,outer sep=0.25ex] {$\scriptstyle F(\alpha)$} (2.75,-0.5);
				\node at (-1.15,-0.5) {$F(x)$};
				\node at (4.55,-0.5) {$F(y)$};
			\end{scope}
			\draw[dotted] (-4,-5) to[out=90,in=270] (-3.5,-4) to[out=90,in=195] (-3,-3.6) to[out=15,in=290] (-2,-3) to[out=110,in=180] (0,-2.2) to[out=0,in=180] (1.75,-2) to[out=0,in=180] (3,-2.1) to[out=0,in=135] (4.75,-2.5) to[out=315,in=100] (5.4,-2.8) to[out=280,in=85] (5.2,-3.1) to[out=265,in=160] (5.4,-3.3) to[out=340,in=90] (6,-3.5) to[out=270,in=80] (5.7,-3.8) to[out=260,in=90] (6.6,-4.3) to[out=270,in=90] (7.5,-5);
			\node at (-2.9,-3.1) {$\cat{Cat}_\infty$};
			\begin{scope}[yshift=3.65cm]
				\begin{scope}[yscale=0.3,xscale=0.7,shift={(1.2,-12.7)}]
					\draw[dotted] (-3,0) to[out=90,in=270] (-2.4,0.5) to[out=90,in=300] (-2,1) to[out=120,in=270] (-2.2,1.6) to[out=90,in=180] (-0.8,2) to[out=0,in=180] (1,2.5) to[out=0,in=180] (1.95,2.2) to[out=0,in=135] (4.5,1.4) to[out=315,in=160] (4.7,0.8) to[out=340,in=90] (5.7,0) to[out=270,in=60] (4.9,-0.8) to[out=240,in=135] (5.2,-1.2) to[out=315,in=90] (4.7,-1.7) to[out=270,in=90] (4.8,-1.9) to[out=270,in=0] (3.6,-2.2) to[out=180,in=0] (2.75,-2.5) to[out=180,in=305] (0,-2.5) to[out=125,in=275] (-2,-1.75) to [out=95,in=270] (-2.5,-0.75) to[out=90,in=270] cycle;
				\end{scope}
				\node (Cc) at (-1.15,-3.4) {$\Cc$};
				\fill (0,-3.8) circle (0.45ex) node[outer sep=0.5ex] (x) {} node[left=0.5ex] (xlabel) {$x$};
				\fill (3.5,-3.8) circle (0.45ex) node[outer sep=0.5ex] (y) {} node[right=0.5ex] {$\smash{y}\vphantom{x}$};
				\draw[postaction={decorate}] (x) to node[pos=0.5,above,outer sep=0.25ex] (alpha) {$\scriptstyle\alpha$} (y);
				\draw[|-to,shorten >=4.5ex] (x) to (u);
				\draw[|-to,shorten >=4.5ex] (y) to (v);
			\end{scope}
			%\draw[very thick,-to] (alpha) ++ (0,-1) to ++(0,-2);
			%\draw[dotted] (-0.95,0.5) to[out=10,in=180] (-0.25,0.85) to[out=0,in=170] (0.25,0.7) to[out=350,in=190] (2,0.7) to[out=10,in=200] (3.15,0.85) to[out=20,in=180] (3.45,0.95) to[out=0,in=170] (4.2,0.75) to[out=350,in=120] (4.9,0.3) to[out=300,in=90] (5.5,-0.1) to[out=270,in=60] (5,-0.7) to[out=240,in=135] (5.2,-1) to[out=315,in=90] (4.9,-1.3) to[out=270,in=120] (4.95,-1.4) to[out=300,in=350] (3.74,-1.57) to[out=170,in=0] (3.33,-1.65) to[out=180,in=350] (3,-1.5) to[out=170,in=35] (2.2,-1.7) to[out=215,in=0] (0,-1.57) to[out=180,in=285] (-0.78,-1.25) to [out=105,in=270] (-1.2,-0.75) to[out=90,in=270] (-2,-0.2) to[out=90,in=270] (-1.5,0.2) to[out=90,in=300] (-1.3,0.4) to[out=120,in=190] cycle;
			%\begin{scope}[scale=0.9,shift={(0.4,-0.1)}]
			%\draw[dotted] (-3,0) to[out=90,in=270] (-2.4,0.5) to[out=90,in=300] (-2,1) to[out=120,in=270] (-2.2,1.6) to[out=90,in=180] (-0.8,2) to[out=0,in=180] (0,2.2) to[out=0,in=180] (1.75,2) to[out=0,in=135] (4.5,1.4) to[out=315,in=160] (4.7,0.8) to[out=340,in=90] (5.7,0) to[out=270,in=60] (4.9,-0.8) to[out=240,in=135] (5.2,-1.2) to[out=315,in=90] (4.7,-1.7) to[out=270,in=90] (4.8,-1.9) to[out=270,in=0] (3.6,-2.2) to[out=180,in=0] (2.75,-2.5) to[out=180,in=305] (0,-2.5) to[out=125,in=275] (-2,-1.25) to [out=95,in=270] (-2.5,-0.75) to[out=90,in=270] cycle;
			%\end{scope}
			%\draw[|-to] (0,-1.65) to (x);
			%\node (Uu) at (-2,0.75) {$\Uu$};
			%\draw[very thick,-to] (1.75,-2.1) to (alpha);
			%\draw[dashed, shorten <=1.25ex] (-0.9,-0.8) to (x);
			%\draw[dashed, shorten <=0.75ex,dash phase=1.5] (0.6,-1.1) to (x);
			%\draw[dashed,shorten <=1.5ex, dash phase=0] (2.595,-0.8) to (y);
			%\draw[dashed, shorten >=0.75ex,dash phase=0] (y) to (4.245,-1.15);
			%\draw[|-to] (3.5,-1.65) to (y);
		\end{tikzpicture}
	\end{center}
	Now let's turn this picture upside down! Take $F(x)$ and $F(y)$ and place them above $x$ and $y$, respectively. We would like to think of them as the fibres over $x$ and $y$ in some kind of fibration $p\colon \Uu\rightarrow \Cc$:
	\begin{center}
		\vspace{-1ex}
		\begin{tikzpicture}[line cap=round, line join=round, line width=rule_thickness, decoration={markings,mark=at position 0.5 with {\arrow{to}}},scale=0.95]
			\begin{scope}[xscale=0.64,xshift=-0.15cm]
				\draw[dashed,shift={(0,-0.25)},preaction={pattern={Lines[xshift=-0.4em,angle=150, line width=0.2em, distance=0.4em]}}, pattern color=white!93!black] (-0.8,0) to[out=35,in=270] (-0.6,0.2) to[out=90,in=305] (-0.8,0.6) to[out=125,in=180]  (-0.2,1) to[out=0,in=140] (0.4,0.65) to[out=320,in=100] (0.8,0.45) to[out=280,in=45] (0.6,0) to[out=225,in=90] (0.45,-0.3) to[out=270,in=135] (0.5,-0.6) to[out=315,in=90] (0.6,-0.85) to[out=270,in=70] (0.5,-1) to[out=250,in=0] (0.1,-1.2) to[out=180,in=315] (-0.6,-1) to[out=135,in=340] (-0.8,-0.7) to[out=160,in=270] (-0.9,-0.5) to[out=90,in=270] (-0.8,-0.25) to[out=90,in=205] cycle;
			\end{scope}
			\begin{scope}[xscale=0.64,xshift=2.1cm]
				\draw[dashed,shift={(3.5,-0.25)}, dash phase=3,preaction={pattern={Lines[xshift=-0.4em,angle=150, line width=0.2em, distance=0.4em]}}, pattern color=white!93!black] (-0.9,0) to[out=35,in=270] (-0.8,0.2) to[out=90,in=305] (-0.9,0.6) to[out=125,in=180]  (-0.2,1.1) to[out=0,in=140] (0.4,0.8) to[out=320,in=100] (0.85,0.6) to[out=280,in=45] (0.7,0) to[out=225,in=90] (0.6,-0.3) to[out=270,in=90] (0.65,-0.6) to[out=270,in=90] (0.75,-0.85) to[out=270,in=70] (0.65,-1.1) to[out=250,in=0] (0.1,-1.2) to[out=180,in=0] (-0.4,-1.3) to[out=180,in=315] (-0.8,-1) to[out=135,in=340] (-0.9,-0.7) to[out=160,in=270] (-1.1,-0.5) to[out=90,in=270] (-1,-0.25) to[out=90,in=205] cycle;
			\end{scope}
			\fill (0,0) circle (0.45ex) node[outer sep=0.5ex] (u) {} node[above left] {$u$};
			\fill (3.5,0) circle (0.45ex) node[outer sep=0.5ex] (v) {} node[above right] {$v$};
			\fill (3.5,-1) circle (0.45ex) node[outer sep=0.5ex] (w) {} node[below right] {$w$};
			\draw[postaction={decorate}] (u) to node[pos=0.5,above,outer sep=0.25ex] {$\scriptstyle\varphi$} (v);
			\draw[postaction={decorate}] (v) to node[pos=0.5] (mid) {} (w);
			\draw[postaction={decorate}] (u) to (w);
			\begin{scope}[yscale=0.3,xscale=0.7,shift={(1.2,-12.7)}]
				\draw[dotted] (-3,0) to[out=90,in=270] (-2.4,0.5) to[out=90,in=300] (-2,1) to[out=120,in=270] (-2.2,1.6) to[out=90,in=180] (-0.8,2) to[out=0,in=180] (1,2.5) to[out=0,in=180] (1.95,2.2) to[out=0,in=135] (4.5,1.4) to[out=315,in=160] (4.7,0.8) to[out=340,in=90] (5.7,0) to[out=270,in=60] (4.9,-0.8) to[out=240,in=135] (5.2,-1.2) to[out=315,in=90] (4.7,-1.7) to[out=270,in=90] (4.8,-1.9) to[out=270,in=0] (3.6,-2.2) to[out=180,in=0] (2.75,-2.5) to[out=180,in=305] (0,-2.5) to[out=125,in=275] (-2,-1.75) to [out=95,in=270] (-2.5,-0.75) to[out=90,in=270] cycle;
			\end{scope}
			\node at (0,1.25) {$F(x)$};
			\node at (3.5,1.25) {$F(y)$};
			\fill (0,-3.8) circle (0.45ex) node[outer sep=0.5ex] (x) {} node[below=0.5ex] {$x$};
			\fill (3.5,-3.8) circle (0.45ex) node[outer sep=0.5ex] (y) {} node[below=0.5ex] {$y$};
			\draw[postaction={decorate}] (x) to node[pos=0.5,above,outer sep=0.25ex] (alpha) {$\scriptstyle\alpha$} (y);
			\draw[dotted] (-0.95,0.5) to[out=10,in=180] (-0.25,0.85) to[out=0,in=170] (0.25,0.7) to[out=350,in=190] (2,0.7) to[out=10,in=200] (3.15,0.85) to[out=20,in=180] (3.45,0.95) to[out=0,in=170] (4.2,0.75) to[out=350,in=120] (4.9,0.3) to[out=300,in=90] (5.5,-0.1) to[out=270,in=60] (5,-0.7) to[out=240,in=135] (5.2,-1) to[out=315,in=90] (4.9,-1.3) to[out=270,in=120] (4.95,-1.4) to[out=300,in=350] (3.74,-1.57) to[out=170,in=0] (3.33,-1.65) to[out=180,in=350] (3,-1.5) to[out=170,in=35] (2.2,-1.7) to[out=215,in=0] (0,-1.57) to[out=180,in=285] (-0.7,-1.25) to [out=105,in=270] (-1.2,-0.75) to[out=90,in=270] (-2,-0.2) to[out=90,in=270] (-1.5,0.2) to[out=90,in=300] (-1.3,0.4) to[out=120,in=190] cycle;
			%\begin{scope}[scale=0.9,shift={(0.4,-0.1)}]
			%\draw[dotted] (-3,0) to[out=90,in=270] (-2.4,0.5) to[out=90,in=300] (-2,1) to[out=120,in=270] (-2.2,1.6) to[out=90,in=180] (-0.8,2) to[out=0,in=180] (0,2.2) to[out=0,in=180] (1.75,2) to[out=0,in=135] (4.5,1.4) to[out=315,in=160] (4.7,0.8) to[out=340,in=90] (5.7,0) to[out=270,in=60] (4.9,-0.8) to[out=240,in=135] (5.2,-1.2) to[out=315,in=90] (4.7,-1.7) to[out=270,in=90] (4.8,-1.9) to[out=270,in=0] (3.6,-2.2) to[out=180,in=0] (2.75,-2.5) to[out=180,in=305] (0,-2.5) to[out=125,in=275] (-2,-1.25) to [out=95,in=270] (-2.5,-0.75) to[out=90,in=270] cycle;
			%\end{scope}
			%\draw[|-to] (0,-1.65) to (x);
			%\node (Uu) at (-2,0.75) {$\Uu$};
			\node (Uu) at (-1.7,0.55) {$\Uu$};
			\node (Cc) at (-1.15,-3.4) {$\Cc$};
			%\draw[very thick,-to] (1.75,-2.1) to (alpha);
			\draw[dashed, shorten >=0.25ex] (x) to (-0.675,-0.8);
			\draw[dashed] (x) to (0.29,-1.1);
			\draw[dashed,shorten >=0.25ex] (y) to (2.88,-0.8);
			\draw[dashed,shorten >=1.25ex] (y) to (4.06,-1.15);
			\path (u) to node[pos=0.75] {$\scriptscriptstyle/\!/\!/$} (mid);
			%\draw[dashed, shorten <=1.25ex] (-0.9,-0.8) to (x);
			%\draw[dashed, shorten <=0.75ex,dash phase=1.5] (0.6,-1.1) to (x);
			%\draw[dashed,shorten <=1.5ex, dash phase=0] (2.595,-0.8) to (y);
			%\draw[dashed, shorten >=0.75ex,dash phase=0] (y) to (4.245,-1.15);
			%\draw[|-to] (3.5,-1.65) to (y);
		\end{tikzpicture}
	\end{center}
	But, of course, $\Uu$ shouldn't just be a disjoint union of some fibres. Instead, we need to capture somehow that the values $F(x)$ of the functor $F$ \enquote{vary functorially in $x$}. To do this, we connect every $u\in F(x)$ to its image $v\simeq F(\alpha)(u)$ by a new $1$-simplex $\varphi\colon u\rightarrow v$. Then we keep adding further simplices to make sure that the object we end up with is a quasi-category. For example, in our picture we have a morphism $v\rightarrow w$ in $F(y)$, so we have to add a $2$-simplex $\sigma\colon \Delta^2\rightarrow \Uu$ in such a way that $\sigma|_{\Delta^{\{0,2\}}}\colon u\rightarrow w$ is a composition of $\varphi$ and $v\rightarrow w$.
	
	To summarise, we've given some vague motivation why functors $F\colon \Cc\rightarrow\cat{Cat}_\infty$ should correspond to certain fibrations $p\colon \Uu\rightarrow \Cc$, in such a way that the values $F(x)$ correspond to the fibres $p^{-1}\{x\}$. Furthermore, we've motivated that for every $\alpha\colon x\rightarrow y$ in $\Cc$ and every $u\in p^{-1}\{x\}\simeq F(x)$, there should be a special $1$-simplex $\varphi\colon u\rightarrow v$ that connects $u$ to its image under $F(\alpha)$. Every other $1$-simplex from $u$ to an object in $p^{-1}\{y\}$ should arise as a composition with some morphism $v\rightarrow w$ in $p^{-1}\{y\}\simeq F(y)$. These vague ideas are captured in a precise sense by the following definition:
\end{numpar}
\begin{defi}\label{def:Cocartesian}
	Let $p\colon \Uu\rightarrow\Cc$ be an inner fibration of quasi-categories.
	\begin{alphanumerate}
		\item A morphism $\varphi\colon u\rightarrow v$ in $\Uu$ is called \emph{$p$-cocartesian} if, for every $n\geqslant 2$, every lifting problem\label{enum:CocartesianMorphism}
		\begin{equation*}
			\begin{tikzcd}
				\Lambda_0^n\rar\dar & \Uu\dar["p"]\\
				\Delta^n\urar[dashed]\rar & \Cc
			\end{tikzcd}
		\end{equation*}
		in which $\Delta^{\{0,1\}}\subseteq \Lambda_0^n$ is sent to $\varphi$, has a solution.
		\item We call $p$ a \emph{cocartesian fibration} if every lifting problem\label{enum:CocartesianFibration}
		\begin{equation*}
			\begin{tikzcd}
				\{0\}\rar\dar & \Uu\dar["p"]\\
				\Delta^1\urar[dashed]\rar & \Cc
			\end{tikzcd}
		\end{equation*}
		has a solution in which $\Delta^1$ is sent to a $p$-cocartesian morphism.
	\end{alphanumerate}
	There are dual notions of \emph{$p$-cartesian morphisms} and \emph{cartesian fibrations}, in which we use $\Delta^{\{n-1,n\}}\subseteq \Lambda_n^n\rightarrow \Delta^n$ and $\{1\}\rightarrow \Delta^1$ instead.
\end{defi}
It's easy to identify those cocartesian fibrations that correspond to functors $F\colon \Cc\rightarrow \cat{An}$.
\begin{lem}[\enquote{Left fibrations are cocartesian fibrations whose fibres are animae}]\label{lem:CocartesianLeft}
	For a cocartesian fibration $p\colon \Uu\rightarrow\Cc$, the following conditions are equivalent:
	\begin{alphanumerate}
		\item Every morphism in $\Uu$ is $p$-cocartesian.\label{enum:EveryMorphismCocartesian}
		\item $p\colon \Uu\rightarrow \Cc$ is a left fibration.\label{enum:CocartesianLeft}
		\item All fibres $p^{-1}\{x\}$ for $x\in\Cc$ are animae.\label{enum:FibresAreAnimae}
	\end{alphanumerate}
\end{lem}
\begin{proof}[Proof sketch]
	The equivalence \cref{enum:EveryMorphismCocartesian} $\Leftrightarrow$ \cref{enum:CocartesianLeft} is clear and the implication \cref{enum:CocartesianLeft} $\Rightarrow$ \cref{enum:FibresAreAnimae} follows from \cref{cor:LeftFibrationsOverAnima}. To prove \cref{cor:LeftFibrationsOverAnima} $\Rightarrow$ \cref{enum:EveryMorphismCocartesian}, let $\varphi\colon u\rightarrow v$ be a morphism in $\Uu$. We wish to show that $\varphi$ is $p$-cocartesian. Suppose we're given a lifting problem of the sort we're interested in:
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_0^n\rar["\sigma"]\dar & \Uu\dar["p"]\\
			\Delta^n\urar[dashed]\rar & \Cc
		\end{tikzcd}
	\end{equation*}
	such that $\sigma|_{\Delta^{\{0,1\}}}$ is $\varphi\colon u\rightarrow v$. We will construct a new lifting problem
	\begin{equation*}
		\begin{tikzcd}
			\Lambda_0^n\dar\drar[commutes]\rar["d_1"] & \Lambda_1^{n+1}\dar\rar["\ov\sigma"] & \Uu\dar["p"]\\
			\Delta^n\rar["d_1"] & \Delta^{n+1}\urar[dashed]\rar &\Cc
		\end{tikzcd}
	\end{equation*}
	such that $\sigma=\ov\sigma\circ d_1$ (note that $d_1$ maps $\Delta^{\{0,1\}}$ to $\Delta^{\{0,2\}}$, so $\varphi$ is now the image of $\Delta^{\{0,2\}}$ under $\ov\sigma$). Since $p$ is an inner fibration, we'll be able to solve the new lifting problem and get a solution for our original one.
	
	
	Let's construct $\ov\sigma$! By \cref{def:Cocartesian}\cref{enum:CocartesianFibration}, applied to $p(\varphi)\colon \Delta^1\rightarrow \Cc$, we can choose a $p$-cocartesian morphism $\varphi'\colon u\rightarrow v'$ such that $v'\in p^{-1}\{p(v)\}$. By \cref{def:Cocartesian}\cref{enum:CocartesianMorphism}, applied to a suitable $\Lambda_0^2\rightarrow \Uu$, we can find a morphism $\psi\colon v'\rightarrow v$ such that $\varphi\simeq \psi\circ \varphi'$. Note that $\psi$ is an equivalence since $p^{-1}\{p(v)\}$ is an anima by assumption. Now we construct $\ov\sigma$ piece by piece. We put $\ov\sigma|_{d_1(\Lambda_0^n)}\coloneqq \sigma$ and we send $\{1\}$ to $v'$ as well as $\Delta^{\{0,1\}}$ to $\varphi'$. Furthermore, we send $\Delta^{\{0,1,2\}}$ to the $2$-simplex witnessing $\varphi\simeq \psi\circ \varphi'$. The rest of $\Lambda_1^{n+1}\smallsetminus (d_1(\Lambda_0^n)\cup \Delta^{\{0,1,2\}})$ can be filled by a sequence of horn filling problems in which either the first edge is $\varphi'$, so a filler exists by \cref{def:Cocartesian}\cref{enum:CocartesianMorphism}, or the first edge is $\psi\colon v\rightarrow v'$, so a filler exists by Joyal's lifting theorem (\cref{thm:JoyalLifting}) since $\psi$ is an equivalence. As usual, we skip the horn filling combinatorics.
\end{proof}
We can now state the straightening/unstraightening equivalence. As was, unfortunately, clear from the beginning, we won't give a proof here. The most readable proof available is probably due to Gijs Heuts \cite{HeutsStraightening} with contributions by Fabian Hebestreit and Jaco Ruit, based on previous work by Cisinski and Nguyen. Lurie's original proof can be found in \cite[\S\href{https://people.math.harvard.edu/~lurie/papers/HTT.pdf\#section.3.2}{3.2}]{HTT}. There's also another approach by Cisinski \cite{Cisinski} in which straightening/unstraightening is much easier to obtain, but much more work is needed to identify $\cat{An}\subseteq \cat{Cat}_\infty$ with the full sub-quasi-category spanned by the Kan complexes.
\begin{thm}[Straightening/unstraightening]\label{thm:Straightening}
	Let $\Cc$ be a quasi-category.
	\begin{alphanumerate}
		\item Let $\cat{Cocart}(\Cc)\subseteq\cat{Cat}_{\infty/\Cc}$ be the \embrace{non-full!} sub-quasi-category spanned by cocartesian fibrations over $\Cc$ and those maps that preserve cocartesian morphisms \embrace{see \cref{par:SubQuasiCategories}}. Then there are inverse equivalences of quasi-categories\label{enum:CocartesianStraightening}
		\begin{equation*}
			\operatorname{St}^{(\mathrm{cocart})}\colon \cat{Cocart}(\Cc) \underset{\simeq}{\mathrel{\smash{\underset{\smash{\raisebox{0.35em}{$\longleftarrow$}}}{\overset{\smash{\raisebox{-0.35em}{$\overset{\simeq}{\longrightarrow}$}}}{\phantom{\longrightarrow}}}}}}\F\!\left(\Cc,\cat{Cat}_\infty\right)\noloc \operatorname{Un}^{(\mathrm{cocart})}\vphantom{\overset{\simeq}{\overline{x}}}
		\end{equation*}
		called \enquote{straightening} and \enquote{unstraightening}. For a cocartesian fibration $p\colon \Uu\rightarrow \Cc$, the value of $\operatorname{St}^{(\mathrm{cocart})}(p)\colon \Cc\rightarrow\cat{Cat}_\infty$ at $x\in \Cc$ is given by the fibre $p^{-1}\{x\}$. Furthermore, $F\colon \Cc\rightarrow \Dd$ is a functor, then the unstraightening equivalence sends the precomposition functor $-\circ F\colon \F(\Dd,\cat{Cat}_\infty)\rightarrow \F(\Cc,\cat{Cat}_\infty)$ to the pullback $F^*\colon \cat{Cocart}(\Dd)\rightarrow\cat{Cocart}(\Cc)$.
		\item Let $\cat{Left}(\Cc)\subseteq \cat{Cat}_{\infty/\Cc}$ be the full sub-quasi-category spanned by the left fibrations over $\Cc$ \embrace{see \cref{par:SubQuasiCategories}}. Then the equivalences from \cref{enum:CocartesianStraightening} restrict to equivalences\label{enum:LeftStraightening}
		\begin{equation*}
			\operatorname{St}^{(\mathrm{left})}\colon \cat{Left}(\Cc) \underset{\simeq}{\mathrel{\smash{\underset{\smash{\raisebox{0.35em}{$\longleftarrow$}}}{\overset{\smash{\raisebox{-0.35em}{$\overset{\simeq}{\longrightarrow}$}}}{\phantom{\longrightarrow}}}}}}\F\!\left(\Cc,\cat{An}\right)\noloc \operatorname{Un}^{(\mathrm{left})}\vphantom{\overset{\simeq}{\overline{x}}}\,.
		\end{equation*}
	\end{alphanumerate}
	Dually, there are equivalences $\cat{Cart}(\Cc)\simeq \F(\Cc^\op,\cat{Cat}_\infty)$ and $\cat{Right}(\Cc)\simeq \F(\Cc^\op,\cat{An})$. Here $\Cc^\op$ is the quasi-category from \cref{par:Opposite}.\hfill$\blacksquare$
\end{thm}
Most of the time, one can treat \cref{thm:Straightening} as a black box. With a few exceptions at the end of \cref{subsec:Yoneda}, we'll work purely with the statement and we don't need to know how exactly the functors $\operatorname{St}^{(\mathrm{cocart})}$ and $\operatorname{Un}^{(\mathrm{cocart})}$ are constructed!
\begin{exm}\label{exm:Straightening}
	Let $\Cc$ be a quasi-category. The following are examples of cocartesian fibrations and their unstraightenings.
	\begin{alphanumerate}
		\item For every quasi-category $\Dd$, the unique functor $\Dd\rightarrow *$ is a cocartesian fibrations, with the cocartesian morphisms given by the equivalences in $\Dd$. This is an easy application of Joyal's lifting theorem \cref{thm:JoyalLifting}. Furthermore, since cocartesian fibrations are clearly preserved under pullbacks, we see that $\pr_2\colon \Dd\times \Cc\rightarrow\Cc$ is a cocartesian fibration for every quasi-category $\Cc$. The $\pr_2$-cocartesian morphisms in $\Dd\times\Cc$ are precisely those that are equivalences in the $\Dd$-component. The straightening of $\pr_2\colon \Dd\times \Cc\rightarrow\Cc$ is the constant functor $\const \Dd\colon \Cc\rightarrow \cat{Cat}_\infty$; this follows from the pullback statement in \cref{thm:Straightening}\cref{enum:CocartesianStraightening}, but it's probably also pretty clear intuitively.\label{enum:ProjectionsStraightenToConstantFunctors}
		\item For every $x\in \Cc$, we've seen in \cref{cor:HomAnima} that $t\colon \Cc_{x/}\rightarrow \Cc$ is even a left fibration. The fibre of $t$ over $y\in\Cc$ is $\Hom_\Cc(x,y)$ by \cref{par:HomInQuasiCategories}, so we can use the straightening of $t$ as our definition of the Hom functor $\Hom_\Cc(x,-)\colon \Cc\rightarrow \cat{An}$. Analogously, the dual construction $s\colon \Cc_{/y}\rightarrow \Cc$ is a right fibration and its cartesian straightening is, by definition, the contravariant Hom functor $\Hom_\Cc(-,y)\colon \Cc^\op\rightarrow \cat{An}$. This still leaves the question how to construct the two-variable Hom functor $\Hom_\Cc\colon \Cc^\op\times\Cc\rightarrow\cat{An}$, which we'll discuss in \cref{con:HomInTwoVariables} below.\label{enum:SliceLeftFibration}
		\item The target projection $t\colon \Ar(\Cc)\rightarrow \Cc$ from \cref{par:HomInQuasiCategories} is a cocartesian fibration, and its is our definition of the functor $\Cc_{/-}\colon \Cc\rightarrow\cat{Cat}_\infty$ that sends $x\in\Cc$ to the slice quasi-category $\Cc_{/x}$. A morphism $\varphi\colon (\alpha\colon u\rightarrow u')\rightarrow (\beta\colon v\rightarrow v')$ in $\Ar(\Cc)$, that is, a commutative diagram\label{enum:ArCocartesianFibration}
		\begin{equation*}
			\begin{tikzcd}
				u\rar\dar["\alpha"']\drar[commutes] & v\dar["\beta"]\\
				u'\rar & v'
			\end{tikzcd}
		\end{equation*}
		in $\Cc$, is $t$-cocartesian if and only if $u\rightarrow v$ is an equivalence in $\Cc$. Proving this is a somewhat subtle and will lead us on a detour. One way to see the \enquote{if}-part (which is the difficult part) would be to reformulate a lifting problem for $t$ against $\Lambda_0^n\rightarrow \Delta^n$ into a lifting problem for $\Cc\rightarrow *$ against $\Lambda_0^n\times \Delta^1\cup_{\Lambda_0^n\times\{1\}}\Delta^n\times\{1\}\rightarrow \Delta^n\times\Delta^1$, as in the proof of \cref{cor:FKanFibration}. Then one proves, using Joyal's lifting problem (\cref{thm:JoyalLifting}), that a lifting problem of the latter kind is always solvable if the original lifting problem maps $\Delta^{\{0,1\}}\subseteq\Lambda_0^n$ to a morphism $\varphi$ as above.
		
		However, a much nicer proof of the \enquote{if}-part  is provided by \cref{lem:HomInArrowCategories} and \cref{lem:CocartesianMorphisms} below (except that there are some black boxes involved \ldots). For the \enquote{only if}-part, it's enough to write down the correct lifting diagrams; we leave this to you.
	\end{alphanumerate}
\end{exm}
\subsection{Digression: Applications to covering theory}
\begin{numpar}[Coverings of animae.]
	Let $X$ be an anima. A \emph{covering of $X$} is a Kan fibration (or equivalently a left fibration, see \cref{cor:LeftFibrationsOverAnima}) $p\colon X'\rightarrow X$ such that for all $x\in X$, the fibres $p^{-1}\{x\}$ are \emph{discrete}, that is, a disjoint union of points. This notion recovers the usual notion of coverings from topology. More precisely, the adjoint functors $\left|\,\cdot\,\right|\colon \cat{Kan}\doublelrmorphism \cat{Top}\noloc \Sing$ from \cref{par:GeometricRealisation} transform coverings of animae into usual coverings of topological spaces and vice versa. Indeed, suppose $p\colon X'\rightarrow X$ is a covering as above. Using the fact that all fibres of $p$ are discrete together with the lifting properties of Kan fibrations, it's easy to see that for every $\Delta^n\rightarrow X$, the pullback $\Delta^n\times_XX'$ consists of a disjoint union of copies of $\Delta^n$. This means that the preimage of any cell in the CW complex $\left|X\right|$ under $\left|p\right|\colon \left|X'\right|\rightarrow \left|X\right|$ is a disjoint union of copies of that cell. Via some technical arguments that we omit, this observation shows that $\left|p\right|$ is a covering in the usual sense. Conversely, if $q\colon Y'\rightarrow Y$ is a covering of topological spaces, then $\Sing q\colon \Sing Y'\rightarrow\Sing Y$ is a Kan fibration. Indeed, using the adjunction $\left|\,\cdot\,\right|\dashv \Sing$, every horn lifting problem can be rewritten as a lifting problem
	\begin{equation*}
		\begin{tikzcd}
			\left|\Lambda_i^n\right|\rar\dar & Y'\dar["q"]\\
			\left|\Delta^n\right|\rar\urar[dashed] & Y
		\end{tikzcd}
	\end{equation*}
	Now the pair $(\left|\Delta^n\right|,\left|\Lambda_i^n\right|)$ is homeomorphic to $([0,1]^{n-1}\times[0,1],[0,1]^{n-1}\times\{0\})$, so the existence of a lift follows from the well-known homotopy lifting property of covering spaces (see \cite[Proposition~\href{https://pi.math.cornell.edu/~hatcher/AT/AT.pdf\#page=69}{1.30}]{Hatcher} for example). It remains to show that the fibres of $\Sing q$ are discrete, which is clear since $\Sing$ preserves pullbacks and discrete objects.
	
	We let $\cat{Cov}(X)\subseteq\cat{Left}(X)$ denote the full sub-quasi-category spanned by the coverings of $X$. Under the straightening equivalence from \cref{thm:Straightening}\cref{enum:LeftStraightening}, coverings $p\colon X'\rightarrow X$ corresponds to those functors $F\colon X\rightarrow\cat{An}$ that land in discrete animae, that is, in the full sub-quasi-category $\N(\cat{Set})\subseteq \cat{An}$. Thus, straightening induces an equivalence of quasi-categories
	\begin{equation*}
		\cat{Cov}(X)\overset{\simeq}{\longrightarrow}\F\lef(X,\N(\cat{Set})\righ)\,.
	\end{equation*}
	Now recall $\F(X,\N(\cat{Set}))\cong \N(\Fun(\operatorname{ho}(X),\cat{Set}))$ from \cref{lem:SimplicialHoNerveAdjunction}. But what is $\operatorname{ho}(X)$? We know $X\simeq \Sing \left|X\right|$ from the simplicial approximation theorem, hence $\operatorname{ho}(X)\simeq \operatorname{ho}(\Sing\left|X\right|)$. By the description in \cref{par:HomotopyCategory}, the objects of $\operatorname{ho}(\Sing\left|X\right|)$ are given by $\Sing_0\left|X\right|$, the points of $\left|X\right|$. The morphisms of $\operatorname{ho}(\Sing\left|X\right|)$ are equivalence classes of $\Sing_1\left|X\right|$, that is, equivalence classes of paths in $X$. A quick unravelling of definitions shows that the equivalence relation is precisely for two paths to be homotopic. Hence $\operatorname{ho}(\Sing\left|X\right|)$ is precisely the \emph{fundamental groupoid} $\Pi_1\!\left|X\right|$ of the topological space $\left|X\right|$, and $\operatorname{ho}(X)\simeq \Pi_1\!\left|X\right|$. We have thus proved a classical result from topology:
\end{numpar}
\begin{thm}[Classification of covering animae]
	Let $X$ be an anima. Then $\cat{Cov}(X)$ is equivalent to the nerve of an ordinary category, given by
	\begin{equation*}
		\operatorname{ho}\lef(\cat{Cov}(X)\righ)\simeq \Fun\lef(\Pi_1\!\left|X\right|,\cat{Set}\righ)\,.
	\end{equation*}
\end{thm}

\subsection{Digression: Homotopy pullbacks}
Before we move on to prove Yoneda's lemma, we need to go on a brief detour about \emph{homotopy pullbacks}. This notion will allow us to compute $\Hom_{\Ar(\Cc)}$ and $\Hom_{\Cc_{/y}}$ in terms of $\Hom_\Cc$ for any quasi-category $\Cc$, which will be used countless times throughout the rest of this text. 
\begin{numpar}[\enquote{Definition}.]\label{def:HomotopyPullback}
	Suppose we're given a diagram of Kan complexes or quasi-categories
	\begin{equation*}
		\begin{tikzcd}
			X\rar\dar & X'\dlar[phantom,"\Longleftarrow"{sloped}]\dar\\
			Y\rar & Y'
		\end{tikzcd}\quad\text{or}\quad
		\begin{tikzcd}
			\Cc\rar\dar & \Cc'\dlar[phantom,"\Longleftarrow"{sloped}]\dar\\
			\Dd\rar & \Dd'
		\end{tikzcd}
	\end{equation*}
	that commutes up to homotopy or up to natural equivalence, respectively (so that the corresponding diagram in $\cat{An}$ or $\cat{Cat}_\infty$-commutes; see the discussion in \cref{exm:SimplicialNerve}). We say that the diagram is a \emph{homotopy pullback} if its image in $\cat{An}$ or $\cat{Cat}_\infty$ is a pullback in the $\infty$-categorical sense (which we will only define in \cref{def:Colimits}\cref{enum:Colimit} below).
	
	As stated, this \enquote{definition} doesn't lead to vicious circles, but once you try to prove anything with it, it probably does. So let's just say there is a way to define homotopy pullbacks properly, using model categories. This is done in any sensible treatment of model categories; see \cite[Definition~{\href{https://cisinski.app.uni-regensburg.de/CatLR.pdf\#thm.2.3.22}{2.3.22}}]{Cisinski} or \cite[Definition~VIII.49(vi)]{HigherCatsII}.\hfill$\blacksquare$
\end{numpar}
\begin{numpar}[Model category fact.]\label{par:HomotopyPullback}
	A pullback diagram in a model category is automatically a homotopy pullback diagram if all objects are \emph{fibrant} and at least one of the legs is a \emph{fibration} (whatever these words mean). For a proof see the dual of \cite[Proposition~{\href{https://cisinski.app.uni-regensburg.de/CatLR.pdf\#thm.2.3.27}{2.3.27}}]{Cisinski} for example. In the concrete examples at hand, we deduce:
	\begin{alphanumerate}
		\item A pullback of Kan complexes is automatically a homotopy pullback if at least one if its legs is a Kan fibration.\label{enum:HomotopyPullbackOfKanComplexes}
		\item A pullback of quasi-categories is automatically a homotopy pullback if at least one of its legs is an \emph{isofibration} (or \emph{categorical fibration} in Lurie's terminology). That is, it is an inner fibration and has the lifting property against $\{0\}\rightarrow \N(J)$. Here $J\coloneqq \{\InlineJ\}$ is the category of two objects and a pair of mutually inverse isomorphisms between them, so lifting against $\{0\}\rightarrow \N(J)$ means that we can lift equivalences.\label{enum:HomotopyPullbackOfQuasicategories}
	\end{alphanumerate}
	So homotopy pullbacks, or equivalently, pullbacks in $\cat{An}$ or $\cat{Cat}_\infty$ can be computed as follows: First write down the diagram as a diagram of simplicial sets. Then replace one of its legs by an equivalence followed by a Kan fibration or an isofibration; this can be done by \cref{lem:SmallObjectArgument} and a small variation to account for the fact that $\N(J)$ has countably many non-degenerate simplices rather than finitely many (so, roughly speaking, taking an $\aleph_0$-filtered colimit is no longer sufficient, we need to take an $\aleph_1$-filtered colimit). Finally, take the usual pullback along that Kan or isofibration.
	
	As a consequence, we deduce that homotopy pullbacks can be manipulated in the same way as ordinary pullbacks. We'll use this freely throughout the rest of this section.\hfill$\blacksquare$
\end{numpar}
Before we see homotopy pullbacks in action, we need a technical construction.
\begin{con}\label{con:HomComposition}
	Let $\Cc$ be a quasi-category. We would like to construct a composition map
	\begin{equation*}
		\circ_{x,y,z}\colon \Hom_\Cc(x,y)\times\Hom_\Cc(y,z)\longrightarrow \Hom_\Cc(x,z)
	\end{equation*}
	for arbitrary objects $x,y,z\in\Cc$ (of course, the map will be non-canonical). We already know how to (non-canonically) compose morphisms (see~\cref{par:Composition}), so the problem is to turn this pointwise construction into a (non-canonical) map of Hom anima as above. Consider the pullback diagram
	\begin{equation*}
		\begin{tikzcd}
			P\rar\dar\drar[pullback] & \F(\Delta^2,\Cc)\dar\\
			\Hom_\Cc(x,y)\times\Hom_\Cc(y,z)\rar\dar\drar[pullback] & \F(\Lambda_1^2,\Cc)\dar\\
			\{x\}\times\{y\}\times\{z\}\rar & \Cc\times\Cc\times\Cc
		\end{tikzcd}
	\end{equation*}
	The map $\F(\Delta^2,\Cc)\rightarrow\F(\Lambda_1^2,\Cc)$ is a trivial fibration by \cref{cor:FKanFibration}, hence so is its pullback $P\rightarrow \Hom_\Cc(x,y)\times\Hom_\Cc(y,z)$. Let $s\colon \Hom_\Cc(x,y)\times\Hom_\Cc(y,z)\rightarrow P$ be a homotopy inverse (which exists by an argument as in the proof of \cref{lem:TrivialFibrationHomotopyEquivalence}). Then $\circ_{x,y,z}$ can be constructed as the composition of $s$ with the map $P\rightarrow \Hom_\Cc(x,z)$ induced by $\F(\Delta^2,\Cc)\rightarrow \F(\Delta^{\{0,2\}},\Cc)$.
\end{con}
\begin{lem}\label{lem:HomInArrowCategories}
	Let $\Cc$ be a quasi-category and let $\alpha\colon x\rightarrow y$, $\alpha'\colon x'\rightarrow y'$ be morphisms in $\Cc$. Then there exists a homotopy pullback diagram of animae
	\begin{equation*}
		\begin{tikzcd}[baseline=(H.base)]
			\Hom_{\Ar(\Cc)}\bigl((\alpha\colon x\rightarrow y),(\alpha'\colon x'\rightarrow y')\bigr)\drar[hpullback]\dar\rar & \Hom_\Cc(y,y')\dar["\alpha^*"]\\
			\Hom_\Cc(x,x')\rar["\alpha'_*"] & |[alias=H]| \Hom_\Cc(x,y') 
		\end{tikzcd}
	\end{equation*}
	Here the pre- and postcomposition maps $\alpha^*$ and $\alpha_*'$ are defined as $\alpha^*\coloneqq \circ_{x,y,y'}|_{\{\alpha\}\times\Hom_\Cc(y,y')}$ and $\alpha'_*\coloneqq \circ_{x,x',y'}|_{\Hom_\Cc(x,x')\times\{\alpha'\}}$ for any choices of composition maps $\circ_{x,y,y'}$ and $\circ_{x,x',y'}$ as in \cref{con:HomComposition}.\hfill$\blacksquare$
\end{lem}
\begin{rem}
	In particular, the maps $\alpha^*$ and $\alpha'_*$ in \cref{lem:HomInArrowCategories} are only well-defined up to homotopy. So a homotopy pullback is really the best thing we can hope for!
	
	If you're looking for a proof, Fabian's handwritten notes \cite[Proposition~VIII.5]{HigherCatsII} are the only source I could find. The proof is not particularly difficult: You work directly with the definition of $\Hom_{\Ar(\Cc)}$ to write it as an honest pullback in which both legs are Kan fibrations. Then you check that the corners of the pullback are homotopy equivalent to $\Hom_\Cc(x,x')$, $\Hom_\Cc(y,y')$, and $\Hom_\Cc(x,y')$, respectively.
	
	Also note that in the case where $\Cc$ is an ordinary category, we recover our original description of morphisms in an arrow category from \cref{con:1ArrowCategory}. Indeed, in this case all Hom animae involved are discrete (that is, sets), hence the ambiguity of $\alpha^*$ and $\alpha'_*$ up to homotopy goes away. Furthermore, any map of discrete Kan complexes is automatically a Kan fibration, so the homotopy pullback is a pullback on the nose by model category fact~\cref{par:HomotopyPullback}\cref{enum:HomotopyPullbackOfKanComplexes}. If you think about this pullback briefly, that's exactly how morphisms in $\Ar(\Cc)$ are described.
\end{rem}
\begin{cor}\label{cor:HomInSliceCategories}
	Let $\Cc$ be a quasi-category, let $y\in \Cc$ be an object, and let $\alpha\colon x\rightarrow y$ and $\alpha'\colon x'\rightarrow y$ be morphisms in $\Cc$. Then there exists a homotopy pullback diagram of animae
	\begin{equation*}
		\begin{tikzcd}
			\Hom_{\Cc_{/y}}\bigl((\alpha\colon x\rightarrow y),(\alpha'\colon x'\rightarrow y)\bigr)\drar[hpullback]\dar\rar & \{\alpha\}\dar\\
			\Hom_\Cc(x,x')\rar["\alpha'_*"] & \Hom_\Cc(x,y)
		\end{tikzcd}
	\end{equation*}
	Here the postcomposition map $\alpha'_*$ is again defined via \cref{con:HomComposition}.
\end{cor}
\begin{proof}[Proof sketch]
	We use the pullback square
	\begin{equation*}
		\begin{tikzcd}
			\Cc_{/y}\rar\dar\drar[pullback] & \Ar(\Cc)\dar\\
			\{y\}\rar & \Cc
		\end{tikzcd}
	\end{equation*}
	In general, its straightforward to check that Hom in a pullback of quasi-categories is the pullback of Hom in each component. Then we plug in \cref{lem:HomInArrowCategories} and check that everything works out with homotopy pullbacks too. For a complete proof, see \cite[Corollary~VIII.6]{HigherCatsII}, where Fabian deduces the result from \cref{lem:HomInArrowCategories} as we do here, or \cite[Lemma~\HTTthm{5.5.5.12}]{HTT}, in which Lurie gives a direct argument.
\end{proof}
Homotopy pullbacks can be used to give an equivalent characterisation of cocartesian fibrations. This is due to Lurie; see \cite[Proposition~\HTTthm{2.4.4.3}]{HTT} or \cite[Corollary~3.1.16]{Land}.
\begin{lem}\label{lem:CocartesianMorphisms}
	Let $p\colon \Uu\rightarrow\Cc$ be an inner fibration of quasi-categories. Then a morphism $\varphi\colon u\rightarrow v$ is $p$-cocartesian if and only if the following diagram is a homotopy pullback of animae for every $w\in\Uu$:
	\begin{equation*}
		\begin{tikzcd}
			\Hom_\Uu(v,w)\dar["p"']\rar["\varphi^*"]\drar[hpullback] & \Hom_\Uu(u,w) \dar["p"]\\
			\Hom_\Cc\lef(p(v),p(w)\righ)\rar["p(\varphi)^*"] & \Hom_\Cc\lef(p(u),p(w)\righ)
		\end{tikzcd}
	\end{equation*}
	Here the precomposition maps $\varphi^*$ and $p(\varphi)^*$ are once again defined via \cref{con:HomComposition}.\hfill$\blacksquare$
\end{lem}
\begin{rem}
	In the case where $\Uu$ and $\Cc$ are ordinary categories, the condition from \cref{lem:CocartesianMorphisms} is used to define cocartesian morphisms in the classical theory of stacks.
\end{rem}
To finish our excursion into homotopy pullbacks, we introduce a variant of cocartesian fibrations that is occasionally quite useful, but will only play a very minor role in these notes (so feel free to skip this part).
\begin{defi}\label{def:LocallyCocartesian}
	Let $p\colon \Uu\rightarrow \Cc$ be an inner fibration of quasi-categories.
	\begin{alphanumerate}
		\item Let $\varphi\colon u\rightarrow v$ be a morphism in $\Uu$, corresponding to a map $\varphi\colon \Delta^1\rightarrow \Uu$. We call $\varphi$ a \emph{locally $p$-cocartesian morphism} if it is $p_{p\circ \varphi}$-cocartesian, where $p_{p\circ \varphi}\colon \Delta^1\times_{p\circ \varphi,\Cc}\Uu\rightarrow \Delta^1$ denotes the pullback of $p$ along $p\circ \varphi\colon \Delta^1\rightarrow \Cc$.
		\item We call $p$ a \emph{locally cocartesian fibration} if the pullback $p_\alpha\colon \Delta^1\times_{\alpha,\Cc}\Uu\rightarrow \Delta^1$ is a cocartesian fibration for every $\alpha\colon \Delta^1\rightarrow \Cc$.
	\end{alphanumerate}
	There are dual notions of \emph{locally $p$-cartesian morphisms} and \emph{locally cartesian fibrations}.
\end{defi}
\begin{cor}\label{cor:LocallyCocartesianComposition}
	Let $p\colon \Uu\rightarrow \Cc$ be a locally cocartesian fibration. Then $p$ is a cocartesian fibration if and only if the set of locally $p$-cartesian morphisms is closed under composition.
\end{cor}
\begin{proof}[Proof sketch]
	First assume that $p$ is a cocartesian fibration. Then cocartesian lifts are unique up to equivalence, which is straightforward to see by writing down some lifting problems. A morphism being cocartesian is preserved under pullbacks. Hence every $p$-cocartesian morphism $\varphi$ is also $p_{p\circ \varphi}$-cocartesian. The above-mentioned uniqueness then implies that every locally $p$-cocartesian morphism must also be $p$-cocartesian. So locally $p$-cocartesian morphisms being closed under composition reduces to the same assertion about $p$-cocartesian morphisms, which is easy to check (for example, using \cref{lem:CocartesianMorphisms}).
	
	Conversely, assume that locally $p$-cocartesian morphisms are closed under compositions. Let $\varphi\colon u\rightarrow v$ be locally $p$-cocartesian. We wish to show that $\varphi$ is also $p$-cocartesian. To this end, we'll verify that the diagram from \cref{lem:CocartesianMorphisms} is a homotopy pullback for all $w\in\Uu$. Using \cref{thm:Whitehead}, \cref{lem:LongExactFibrationSequence}, and the five lemma (plus \cref{rem:ExactnessInLowDegrees}), it's enough to show that for every $\alpha\in \Hom_\Cc(p(v),p(w))$, the induced map on homotopy fibres over $\alpha$ is a homotopy equivalence. So fix $\alpha\colon p(v)\rightarrow p(w)$ in $\Cc$. Let $\Uu_\alpha\coloneqq \Delta^1\times_{\alpha,\Cc}\Uu$ be the fibre over $\alpha$. Furthermore, let $\psi\colon v\rightarrow v'$ be a locally $p$-cocartesian lift of $\alpha$ (so that $p(v')=p(w)$). We claim that the homotopy-commutative diagram
	\begin{equation}\label{eq:HomotopyFibre}\tag{$*$}
		\begin{tikzcd}
			\Hom_{\Uu_\alpha}(v',w)\dar\rar["\psi^*"]\drar[hcommutes] & \Hom_\Uu(v,w)\rar["\varphi^*"]\dar["p"]\drar[hcommutes] & \Hom_\Uu(u,w)\dar["p"]\\
			\bigl\{\id_{p(w)}\bigr\}\rar["\alpha^*"] & \Hom_\Cc\lef(p(v),p(w)\righ)\rar["p(\varphi)^*"] & \Hom_\Cc\lef(p(u),p(w)\righ)
		\end{tikzcd}
	\end{equation}
	exhibits $\Hom_{\Uu_{p(w)}}(v',w)$ both as the homotopy fibre of $\Hom_\Uu(v,w)\rightarrow \Hom_\Cc(p(v),p(w))$ over $\{\alpha\}$ and the homotopy fibre of $\Hom_\Uu(u,w)\rightarrow\Hom_\Cc(p(u),p(w))$ over $\{\alpha\circ p(\varphi)\}$. As explained above, if we could show this, we would be done.
	
	To see this, observe that $\Hom$ animae in pullbacks are given as pullbacks of $\Hom$ animae in the respective factors (which is straightforward to see from \cref{par:HomInQuasiCategories} and we'll see a more general assertion in \cref{lem:HomInLimits}). Combining this with the assumption that $\psi$ is locally $p$-cocartesian and \cref{lem:CocartesianMorphisms}, we see that the following diagram consists of a homotopy pullback square and a pullback square on the nose:
	\begin{equation*}
		\begin{tikzcd}
			\Hom_{\Uu_\alpha}(v',w)\dar\rar["\psi^*"]\drar[hpullback] & \Hom_{\Uu_\alpha}(v,w)\rar\dar["p"]\drar[pullback] & \Hom_\Uu(v,w)\dar["p"]\\
			\Hom_{\Delta^1}(0,0)\rar & \Hom_{\Delta^1}(0,1)\rar["\alpha"] & \Hom_\Cc\lef(p(v),p(w)\righ)
		\end{tikzcd}
	\end{equation*}
	Hence the outer rectangle must be a homotopy pullback too. Since $\Hom_{\Delta^1}(0,0)\simeq *\simeq \{\id_{p(w)}\}$, it follows that the left square in \cref{eq:HomotopyFibre} is a homotopy pullback. Since, by assumption, any choice of composition $\psi\circ \varphi$ is locally $p$-cocartesian, the same argument can be used to show that the outer rectangle in \cref{eq:HomotopyFibre} is a homotopy pullback too. This proves that  $\Hom_{\Uu_{p(w)}}(v',w)$ agrees with both homotopy fibres in question and we're done.
\end{proof}

\subsection{Yoneda's lemma}\label{subsec:Yoneda}
\begin{thm}[Quasi-categorical Yoneda lemma]\label{thm:Yoneda}
	Let $\Cc$ be a quasi-category, $x\in \Cc$ an object, and $E\colon \Cc\rightarrow \cat{An}$ a functor. Then evaluation at $\id_x$ induces an equivalence of animae
	\begin{equation*}
		\ev_{\id_x}\colon \Hom_{\F(\Cc,\cat{An})}\lef(\Hom_\Cc(x,-),E\righ)\overset{\simeq}{\longrightarrow} E(x)\,.
	\end{equation*}
	Here $\Hom_\Cc(x,-)\colon \Cc\rightarrow \cat{An}$ is the functor from \cref{exm:Straightening}\cref{enum:SliceLeftFibration}. A dual statement holds for the contravariant Hom functor $\Hom_\Cc(-,x)$ and $\F(\Cc^\op,\cat{An})$.
\end{thm}
For the proof we need, more or less, the fact that $*\simeq \{\id_x\}\rightarrow \Cc_{x/}$ is a left anodyne map. This is proved in \cite[Lemma~4.1.4]{Land} or \cite[Corollary~D.7]{HigherCatsII}. Their proofs use some constructions we haven't mentioned yet, but we can circumvent these at the cost of showing a slightly weaker statement.
\begin{lem}\label{lem:WeaklyLeftAnodyne}
	Let $\Cc$ be a quasi-category and $x\in\Cc$ an object. For every left fibration $X\rightarrow \Cc$, the natural map
	\begin{equation*}
		\F\bigl(\Cc_{x/},X\bigr)\overset{\simeq}{\longrightarrow}\F\!\left(*,X\right)\times_{\F\left(*,\Cc\right)}\F\bigl(\Cc_{x/},\Cc\bigr)
	\end{equation*}
	is an equivalence of quasi-categories.
\end{lem}
\begin{proof}[Proof sketch]
	We call a cofibration $A\rightarrow B$ of simplicial sets \emph{weakly left anodyne} if the natural map $\F(B,X)\rightarrow \F(A,X)\times_{\F(A,\Cc)}\F(B,\Cc)$ is an equivalence of quasi-categories for all left fibrations $X\rightarrow \Cc$. Every left anodyne map is weakly left anodyne by \cref{cor:FKanFibration}.
	
	The identity on $\Ar(\Cc)$ is adjoint to a map $\Ar(\Cc)\times\Delta^1\rightarrow \Cc$. Combining this with the map $\Cc\simeq \F(*,\Cc)\rightarrow \F(\Delta^1,\Cc)\simeq \Ar(\Cc)$ induced by $\Delta^1\rightarrow *$ provides a map $\Ar(\Cc)\times\Delta^1\rightarrow \Ar(\Cc)$; restricting this to $\Cc_{x/}$ yields a map $\eta\colon \Cc_{x/}\times\Delta^1\rightarrow \Cc_{x/}$ which defines a natural transformation from $\Cc_{x/}\rightarrow *\rightarrow \Cc_{x/}$ to $\id_{\Cc_{x/}}\colon \Cc_{x/}\rightarrow \Cc_{x/}$. Putting $\Cc_{x/}^\triangleleft\coloneqq (\Cc_{x/}\times\Delta^1)/(\Cc_{x/}\times\{0\})$, we see that $\eta$ factors through a map $\ov\eta\colon \Cc_{x/}^\triangleleft\rightarrow \Cc_{x/}$. The map $*\rightarrow \Cc_{x/}$ induces a map $\Delta^1\simeq *^\triangleleft\rightarrow \Cc_{x/}^\triangleleft$. This fits into a diagram
	\begin{equation*}
		\begin{tikzcd}
			*\rar\dar\drar[commutes] & \Delta^1\rar\dar\drar[commutes] & *\dar\\
			\Cc_{x/}\rar & \Cc_{x/}^\triangleleft\rar["\ov\eta"] & \Cc_{x/}
		\end{tikzcd}
	\end{equation*}
	which exhibits $*\rightarrow \Cc_{x/}$ as a retract of $\Delta^1\rightarrow \Cc_{x/}^\triangleleft$. Hence to show that $*\rightarrow \Cc_{x/}$ is weakly left anodyne, it's enough to show the same for $\Delta^1\rightarrow \Cc_{x/}^\triangleleft$. For this, note that $\{0\}\rightarrow \Delta^1$ is left anodyne, and so is the composition $\{0\}\rightarrow \Delta^1\rightarrow \Cc_{x/}^\triangleleft$ since it is a pushout of $\Cc_{x/}\times\{0\}\rightarrow \Cc_{x/}\times \Delta^1$. Hence $\Delta^1\rightarrow \Cc_{x/}^\triangleleft$ must be weakly left anodyne.
\end{proof}
\begin{proof}[Proof sketch of \cref{thm:Yoneda}]
	Let $p\colon \Uu\rightarrow\Cc$ be the unstraightening of $E\colon \Cc\rightarrow \cat{An}$. Then
	\begin{align*}
		\Hom_{\F(\Cc,\cat{An})}\lef(\Hom_\Cc(x,-),E\righ)&\simeq \Hom_{\cat{Left}(\Cc)}\bigl(t\colon \Cc_{x/}\rightarrow \Cc,p\colon \Uu\rightarrow\Cc\bigr)\\
		&\simeq \Hom_{\cat{Cat}_{\infty/\Cc}}\bigl(t\colon \Cc_{x/}\rightarrow \Cc,p\colon \Uu\rightarrow\Cc\bigr)
	\end{align*}
	using the straightening equivalence (\cref{thm:Straightening}\cref{enum:LeftStraightening}) and the fact that $\cat{Left}(\Cc)\rightarrow{\cat{Cat}_\infty}_{/\Cc}$ is fully faithful. By \cref{cor:HomInSliceCategories}, the diagram
	\begin{equation*}
		\begin{tikzcd}
			\Hom_{\cat{Cat}_{\infty/\Cc}}\bigl((t\colon \Cc_{x/}\rightarrow \Cc),(p\colon \Uu\rightarrow\Cc)\bigr)\rar\dar\drar[hpullback] & *\dar\\
			\Hom_{\cat{Cat}_\infty}\bigl(\Cc_{x/},\Uu\bigr)\rar & \Hom_{\cat{Cat}_\infty}\bigl(\Cc_{x/},\Cc\bigr)
		\end{tikzcd}
	\end{equation*}
	is a homotopy pullback, where $*$ is sent to $t\colon \Cc_{x/}\rightarrow \Cc$. Now recall from \cref{thm:CordierPorter} $\Hom_{\cat{Cat}_\infty}(-,-)\simeq \core \F(-,-)$. Furthermore, we claim that the following diagrams are homotopy pullbacks:
	\begin{equation*}
		\begin{tikzcd}
			\F\bigl(\Cc_{x/},\Uu\bigr)\rar\dar\drar[hpullback] & \F\bigl(\Cc_{x/},\Cc\bigr)\dar\\
			\Uu\rar & \Cc
		\end{tikzcd}\quad\text{and}\quad \begin{tikzcd}
			\core\F\bigl(\Cc_{x/},\Uu\bigr)\rar\dar\drar[hpullback] & \core\F\bigl(\Cc_{x/},\Cc\bigr)\dar\\
			\core(\Uu)\rar & \core (\Cc)
		\end{tikzcd}
	\end{equation*}
	For the left one, we use \cref{lem:WeaklyLeftAnodyne} and model category fact~\cref{par:HomotopyPullback}\cref{enum:HomotopyPullbackOfQuasicategories}: We only need to check that $p\colon \Uu\rightarrow\Cc$ is an isofibration. This is true for every left fibration, since $\{0\}\rightarrow \N(J)$ is left anodyne. To see that the right square is a homotopy pullback too, we need to check that $\core\colon \cat{QCat}\rightarrow \cat{Kan}$ preserves homotopy pullbacks. The deeper reason for this is of course that $\core\colon \cat{Cat}_\infty\rightarrow\cat{An}$ is right adjoint to the inclusion $\cat{An}\subseteq\cat{Cat}_\infty$ (see \cref{exm:Adjunctions}\cref{enum:AnToCatInfty}). For a direct argument, we can use \cref{par:HomotopyPullback}: By an easy application of Joyal's lifting theorem (\cref{thm:JoyalLifting}), $\core$ transforms isofibrations into Kan fibrations and then by arguments as in the proof of \cref{thm:EquivalenceFullyFaithfulEssentiallySurjective} we can show that $\core$ preserves pullbacks of quasi-categories in which at least one leg is an isofibration.
	
	Combining the homotopy pullbacks so far, we find that
	\begin{equation*}
		\begin{tikzcd}
			\Hom_{\cat{Cat}_{\infty/\Cc}}\bigl((t\colon \Cc_{x/}\rightarrow \Cc),(p\colon \Uu\rightarrow\Cc)\bigr)\rar\dar\drar[hpullback] & *\dar\\
			\core(\Uu)\rar & \core(\Cc)
		\end{tikzcd}
	\end{equation*}
	is a homotopy pullback, where $*$ is sent to $x\in\core (\Cc)$. As observed above, $\Uu\rightarrow\Cc$ is an isofibration and so $\core (\Uu)\rightarrow (\Cc)$ is a Kan fibration. Thus, the homotopy pullback can be computed by the ordinary pullback. Now $\core(\Uu)\times_{\core(\Cc)}\{x\}\cong \core(\Uu\times_\Cc\{x\})\cong \Uu\times_\Cc\{x\}\simeq F(x)$ using that the fibres $\Uu\times_\Cc\{x\}\eqqcolon p^{-1}\{x\}$ of $p$ are animae and compute the values of $F$. This is what we wanted to prove.
\end{proof}
Finally, we would like to construct the functor $\Hom_\Cc\colon \Cc^\op\times\Cc\rightarrow\cat{An}$. There are several ways to do this and we'll outline two possibilities in \cref{con:HomInTwoVariables,con:HomTwAr} below. We won't prove that they are equivalent (they are), but we won't ever need that either. So you can just choose whichever is your favourite.
\begin{con}\label{con:HomInTwoVariables}
	Consider the functor $\Cc_{/-}\colon \Cc\rightarrow \cat{Cat}_\infty$ from \cref{exm:Straightening}\cref{enum:ArCocartesianFibration}. For every $x\in \Cc$ there is a natural functor $\Cc_{/x}\rightarrow \Cc$, so we would expect that $\Cc_{/-}$ lifts to a functor $\Cc_{/-}\colon \Cc\rightarrow \cat{Cat}_{\infty/\Cc}$. To construct such a lift, first note that for all quasi-categories $\Dd$ and all $y\in \Dd$, we have an equivalence  $\F(\Cc,\Dd_{/y})\simeq\F(\Cc,\Dd)_{/\const y}$ (in fact, even an isomorphism of simplicial sets), as can be checked by a simple calculation. Furthermore, \cref{thm:Straightening}\cref{enum:CocartesianStraightening} and \cref{exm:Straightening}\cref{enum:ProjectionsStraightenToConstantFunctors} imply that $\F(\Cc,\cat{Cat}_\infty)_{/\const \Cc}\simeq \cat{Cocart}(\Cc)_{/(\pr_2\colon\Cc\times \Cc\rightarrow \Cc)}$ holds. So to lift our functor $\Cc_{/-}$ to $\cat{Cat}_{\infty/\Cc}$, it suffices to check that the following diagram is a morphism of cocartesian fibrations over $\Cc$:
	\begin{equation*}
		\begin{tikzcd}
			\Ar(\Cc)\ar[r,"{(s,t)}"]\dar["\smash{t}\vphantom{\pr_2}"']\dar[phantom,""{name=A}]\arrow[from=1-2,to=A,commutes,pos=0.7]& \Cc\times\Cc\dlar["\pr_2"]\\
			\Cc &
		\end{tikzcd}
	\end{equation*}
	By the dual of \cref{cor:HomAnima}, $\Cc_{/x}\rightarrow \Cc$ is a right fibration for all $x\in \Cc$, hence $\Cc_{/-}\colon \Cc\rightarrow \cat{Cat}_{\infty/\Cc}$ takes values in the full sub-quasi-category $\cat{Right}(\Cc)\subseteq \cat{Cat}_{\infty/\Cc}$. Since $\cat{Right}(\Cc)\simeq \F(\Cc^\op,\cat{An})$ by the dual of \cref{thm:Straightening}\cref{enum:LeftStraightening}, we obtain a functor
	\begin{equation*}
		\Yo_\Cc\colon \Cc\xrightarrow{\Cc_{/-}} \cat{Right}(\Cc)\xrightarrow{\operatorname{St}^{(\mathrm{right})}}\F(\Cc^\op,\cat{An})\,,
	\end{equation*}
	which we take as our definition of the Yoneda embedding (we'll see in \cref{cor:YonedaEmbeddingFullyFaithful} below that it is indeed fully faithful). Finally, we let $\Hom_\Cc\colon \Cc^\op\times\Cc\rightarrow \cat{An}$ be the image of $\Yo_\Cc$ under the \enquote{currying} equivalence $\F(\Cc,\F(\Cc^\op,\cat{An}))\simeq \F(\Cc^\op\times \Cc,\cat{An})$. We define the \emph{twisted arrow quasi-category} $(s,t)\colon \TwAr(\Cc)\rightarrow\Cc^\op\times\Cc$ to be the unstraightening of $\Hom_\Cc\colon \Cc^\op\times\Cc\rightarrow\cat{An}$ via \cref{thm:Straightening}\cref{enum:LeftStraightening}.
\end{con}
\cref{con:HomInTwoVariables} has the advantage that it allows for a straightforward proof of \cref{cor:YonedaEmbeddingFullyFaithful} below. On the downside, however, $\TwAr(\Cc)$ is very inexplicit in this description. So alternatively, one can write down an explicit simplicial model for $(s,t)\colon\TwAr(\Cc)\rightarrow \Cc^\op\times\Cc$ and define $\Hom_\Cc$ to be its straightening.
\begin{con}\label{con:HomTwAr}
	For an ordinary category $\Cc$, we define $\TwAr(\Cc)$ (the notational overload will be addressed in \cref{rem:TwAr} below) to be the ordinary category whose objects are arrows $\alpha\colon x\rightarrow y$ in $\Cc$ and whose morphisms $(\alpha\colon x\rightarrow y)\rightarrow (\alpha'\colon x'\rightarrow y')$ are \enquote{twisted} commutative squares
	\begin{equation*}
		\begin{tikzcd}
			x\dar["\alpha"']\drar[commutes] & x'\lar\dar["\alpha'"]\\
			y\rar & y'
		\end{tikzcd}
	\end{equation*}
	There are functors $s\colon \TwAr(\Cc)\rightarrow \Cc^\op$ and $t\colon \TwAr(\Cc)\rightarrow \Cc$ that send $\alpha\colon x\rightarrow y$ to $x$ and $y$, respectively. For a quasi-category $\Cc$, we re-define $\TwAr(\Cc)$ to be the simplicial set given by
	\begin{equation*}
		\TwAr(\Cc)_n\coloneqq \Hom_{\cat{sSet}}\bigl(\N\lef([n]^\op\star [n]\righ),\Cc\bigr)\,.
	\end{equation*}
	Here $[n]^\op\star[n]$ is the \emph{join} of the totally ordered sets $[n]^\op$ and $[n]$. In general, if $\Ii$ and $\Jj$ are ordinary categories, we let $\Ii\star\Jj$ be the category obtained from the disjoint union $\Ii\sqcup\Jj$ by adding precisely one morphism $i\rightarrow j$ for all $i\in\Ii$, $j\in\Jj$.
	
	The natural maps $(\Delta^n)^\op\cong \N([n]^\op)\rightarrow \N([n]^\op\star [n])$ and $\Delta^n\cong \N([n])\rightarrow \N([n]^\op\star[n])$ induce maps of simplicial sets $s\colon \TwAr(\Cc)\rightarrow \Cc^\op$ and $t\colon\TwAr(\Cc)\rightarrow \Cc$. It turns out that $(s,t)\colon \TwAr(\Cc)\rightarrow \Cc^\op\times \Cc$ is always a left fibration; in particular, $\TwAr(\Cc)$ is a quasi-category. See \cite[Proposition~\HAthm{5.2.1.3}]{HA} or \cite[Proposition~4.2.4]{Land} for proofs. We can then define $\Hom_\Cc\colon \Cc^\op\times \Cc\rightarrow \cat{An}$ to be the straightening of $(s,t)\colon \TwAr(\Cc)\rightarrow \Cc^\op\times \Cc$.
\end{con}
\begin{rem}\label{rem:TwAr}
	If $\Cc$ is an ordinary category, then $\N(\TwAr(\Cc))\cong \TwAr(\N(\Cc))$, no matter how you define the right-hand side. So the notational overload checks out. If you use \cref{con:HomTwAr}, this isomorphism is straightforward to verify. If you use \cref{con:HomInTwoVariables} instead, the proof is still not too hard, but it requires you to know how straightening/unstraightening works under the hood, at least for ordinary categories (in which case straightening/unstraightening is known as the \emph{Grothendieck construction}). 
\end{rem}
Let's do three quick reality checks for our newly constructed functor $\Hom_\Cc$:
\begin{lem}\label{lem:HomRealityCheck}
	Let $\Hom_\Cc\colon \Cc^\op\times\Cc\rightarrow\cat{An}$ be the functor from \cref{con:HomInTwoVariables} or from \cref{con:HomTwAr}. For all $x,y\in\Cc$, the restrictions
	\begin{equation*}
		\Hom_\Cc|_{\{x\}\times\Cc}\colon \Cc\longrightarrow\cat{An}\quad\text{and}\quad \Hom_\Cc|_{\Cc^\op\times\{y\}}\colon \Cc^\op\longrightarrow \cat{An}
	\end{equation*}
	agree with the functors $\Hom_\Cc(x,-)$ and $\Hom_\Cc(-,y)$ constructed in \cref{exm:Straightening}\cref{enum:SliceLeftFibration}.
\end{lem}
\begin{proof}[Proof sketch, assuming \cref{con:HomInTwoVariables}]
	It's straightforward to see from the construction that $\Hom_\Cc|_{\Cc^\op\times\{y\}}\colon \Cc^\op\rightarrow\cat{An}$ is the straightening of the right fibration $\Cc_{/y}\rightarrow \Cc$, which is also the definition of $\Hom_\Cc(-,y)$ in \cref{exm:Straightening}\cref{enum:SliceLeftFibration}. Now let $\Uu\rightarrow\Cc$ be the unstraightening of $\Hom_\Cc|_{\{x\}\times\Cc}$. Note that evaluating a functor $T\colon\Cc^\op\rightarrow\cat{An}$ at $x\in \Cc^\op$ is the same as restriction along $\F(\Cc^\op,\cat{An})\rightarrow\F(\{x\},\cat{An})\simeq \cat{An}$. By the dual of \cref{thm:Straightening}\cref{enum:LeftStraightening}, this corresponds to the pullback functor $x^*\colon \cat{Right}(\Cc)\rightarrow\cat{Right}(\{x\})\simeq \cat{An}$ under the right straightening equivalence. So $\Hom_\Cc|_{\{x\}\times\Cc}$ can be described as the composition
	\begin{equation*}
		\Hom_\Cc|_{\{x\}\times\Cc}\colon\Cc\xrightarrow{\Cc_{/-}}\cat{Right}(\Cc)\overset{x^*}{\longrightarrow}\cat{Right}\lef(\{x\}\righ)\simeq \cat{An}\,.
	\end{equation*}
	By \enquote{inspection} (we'll elaborate on this below), this means that the following diagram is a homotopy pullback:
	\begin{equation*}
		\begin{tikzcd}
			\Uu\dar\rar\drar[hpullback] & \{x\}\times\Cc\dar\\
			\Ar(\Cc)\rar["{(s,t)}"] & \Cc\times\Cc
		\end{tikzcd}
	\end{equation*}
	To compute this homotopy pullback, we use model category fact~\cref{par:HomotopyPullback}\cref{enum:HomotopyPullbackOfQuasicategories}: We claim that $(s,t)\colon \Ar(\Cc)\rightarrow \Cc\times\Cc$ is already an isofibration. Indeed, it's an inner fibration by \cref{cor:FKanFibration} and lifting of equivalences follows easily from \cref{thm:EquivalencePointwise}. So we can just take the pullback on the nose, which is $\Cc_{x/}$ by \cref{par:HomInQuasiCategories}. But $\Hom_\Cc(x,-)\colon \Cc\rightarrow \cat{An}$ was defined to be the straightening of $t\colon \Cc_{x/}\rightarrow \Cc$. This shows $\Hom_\Cc|_{\{x\}\times\Cc}\simeq \Hom_\Cc(x,-)$.
	
	Unfortunately, the above \enquote{inspection} requires us to know a little more about how the straightening/unstraightening equivalence is constructed. The idea is to rewrite the equivalence $\Hom_\Cc|_{\{x\}\times\Cc}\simeq x^*\circ (\Cc_{/-})$ as a pullback $\Hom_\Cc|_{\{x\}\times\Cc}\simeq (\Cc_{/-})\times_{\const \Cc}\const \{x\}$ in the functor quasi-category $\F(\Cc,\cat{Cat}_\infty)$ and then to transform this into a pullback in $\cat{Cocart}(\Cc)$ via \cref{thm:Straightening}\cref{enum:CocartesianStraightening}, which immediately yields the pullback diagram above. However, to make this pullback argument work as stated, we would need \cref{lem:ColimitsInFunctorCategories} below, which would lead to a circular argument. So instead, we need to show that $\Hom_\Cc|_{\{x\}\times\Cc}$ can be written as a homotopy pullback in a suitable model category and to reformulate \cref{thm:Straightening} as a Quillen equivalence of model categories (which is how people actually prove straightening/unstraightening) \ldots
\end{proof}
\begin{proof}[Proof sketch, assuming \cref{con:HomTwAr}]
	In this case, we need to show that the pullbacks of $(s,t)\colon \TwAr(\Cc)\rightarrow \Cc^\op\times\Cc$ along $\{x\}\times\Cc\rightarrow\Cc^\op\times\Cc$ and $\Cc^\op\times\{y\}\rightarrow\Cc^\op\times\Cc$ are equivalent to $\Cc_{x/}\rightarrow\Cc$ and $(\Cc_{/y})^\op\rightarrow\Cc^\op$, respectively. This is not quite trivial; see \cite[Proposition~\HAthm{5.2.1.10}]{HA} or \cite[Lemma~4.2.7]{Land}.
\end{proof}
\begin{lem}\label{lem:HomFunctorial}
	Let $F\colon \Cc\rightarrow\Dd$ be a functor of quasi-categories. Then the natural maps $\Hom_\Cc(x,y)\rightarrow \Hom_\Dd(F(x),F(y))$ assemble into a natural transformation
	\begin{equation*}
		\Hom_\Cc(-,-)\Longrightarrow \Hom_\Dd\lef(F(-),F(-)\righ)
	\end{equation*}
	in $\F(\Cc^\op\times\Cc,\cat{An})$. Here $\Hom_\Cc$ and $\Hom_\Dd$ are the functors from Constructions~\labelcref{con:HomInTwoVariables} or~\labelcref{con:HomTwAr}.
\end{lem}
\begin{proof}[Proof sketch, assuming \cref{con:HomInTwoVariables}]
	Consider the morphism $t\colon \Cc\times_{F,\Dd,s}\Ar(\Dd)\rightarrow \Dd$. It is a cocartesian fibration, which can be shown using \cref{lem:HomInArrowCategories,lem:CocartesianMorphisms} in the same way as \cref{exm:Straightening}\cref{enum:ArCocartesianFibration}. Hence the following diagram is a diagram of cocartesian fibrations over $\Cc$:
	\begin{equation*}
		\begin{tikzcd}
			\Ar(\Cc)\drar["t"']\rar & \Cc\times_{F,\Dd,s}\Ar(\Dd)\times_{t,\Dd,F}\Cc\dar["t"]\dar[phantom,""{name=A}]\rar["{(s,t)}"]\arrow[from=1-1,to=A,commutes,pos=0.7]\arrow[from=1-3,to=A,commutes,pos=0.7]& \Cc\times\Cc \dlar["\pr_2"]\\
			& \Cc & 
		\end{tikzcd}
	\end{equation*}
	After unravelling \cref{con:HomInTwoVariables} and using the fact that precompositions correspond to pullbacks under straightening/unstraightening (see \cref{thm:Straightening}\cref{enum:CocartesianStraightening}), the diagram above will induce the desired natural transformation $\Hom_\Cc(-,-)\Rightarrow \Hom_\Dd\lef(F(-),F(-)\righ)$, provided we can show the following claim:
	\begin{alphanumerate}\itshape
		\item[\boxtimes] \!The cocartesian straightening of the middle vertical arrow is the composite functor\label{enum:HomNaturalTransformation}
		\begin{equation*}
			\Cc\overset{F}{\longrightarrow}\Dd\xrightarrow{\Dd_{/-}}\cat{Cat}_{\infty/\Dd}\overset{F^*}{\longrightarrow}\cat{Cat}_{\infty/\Cc}\,.
		\end{equation*}
	\end{alphanumerate}
	To prove \cref{enum:HomNaturalTransformation} it's enough to show that the straightening of $t\colon \Cc\times_{F,\Dd,s}\Ar(\Dd)\rightarrow \Dd$ is $F^*\circ \Dd_{/-}$, since once again, precompositions correspond to pullbacks. Now the following diagram is a homotopy pullback:
	\begin{equation*}
		\begin{tikzcd}
			\Cc\times_{F,\Dd,s}\Ar(\Dd)\dar\rar\drar[hpullback] & \Cc\times\Dd\dar["F\times {\id_\Dd}"]\\
			\Ar(\Dd)\rar["{(s,t)}"] & \Dd\times\Dd
		\end{tikzcd}
	\end{equation*}
	(in fact, it's a pullback on the nose, and $(s,t)\colon \Ar(\Dd)\rightarrow \Dd\times\Dd$ is an isofibration; see the argument in the proof of \cref{lem:HomRealityCheck}). By a similar \enquote{inspection} as in the proof of \cref{lem:HomRealityCheck}, this observation shows that the straightening of $t\colon \Cc\times_{F,\Dd,s}\Ar(\Dd)\rightarrow \Dd$ is indeed $F^*\circ \Dd_{/-}$, thus proving \cref{enum:HomNaturalTransformation}.
\end{proof}
\begin{proof}[Proof sketch, assuming \cref{con:HomTwAr}]
	It's clear from the construction that $F$ induces a map $\TwAr(\Cc)\rightarrow\TwAr(\Dd)$. By the universal property of pullbacks, this factors over a map
	\begin{equation*}
		\TwAr(\Cc)\longrightarrow (\Cc^\op\times\Cc)\times_{F^\op\times F,\Dd^\op\times\Dd,(s,t)}\TwAr(\Dd)\,.
	\end{equation*}
	The latter is a morphism of left fibrations over $\Cc^\op\times\Cc$. Since precompositions correspond to pullbacks under straightening/unstraightening (see \cref{thm:Straightening}\cref{enum:CocartesianStraightening}), we get a natural transformation $\Hom_\Cc(-,-)\Rightarrow \Hom_\Dd(-,-)\circ (F^\op\times F)\simeq \Hom_\Dd(F(-),F(-))$, as desired.
\end{proof}
\begin{lem}\label{lem:HomNaturalTransformation}
	Let $F,G\colon \Cc\rightarrow \Dd$ be functors of quasi-categories and let $\eta\colon F\Rightarrow G$ be a natural transformation. Then the natural transformation from \cref{lem:HomFunctorial} as well as $\eta_*$, postcomposition with $\eta$, and $\eta^*$, precomposition with $\eta$, fit into a commutative diagram
	\begin{equation*}
		\begin{tikzcd}
			\Hom_\Cc\!\left(-,-\right)\doublear["F"{black,swap,left=0.1em}]{d}\doublear["G"{black,above=0.1em}]{r}\drar[commutes] & \Hom_\Dd\lef(G(-),G(-)\righ)\doublear["\eta^*"{black,right=0.1em}]{d}\\
			\Hom_\Dd\lef(F(-),F(-)\righ)\doublear["\eta_*"{black,above=0.1em}]{r} & \Hom_\Dd\lef(F(-),G(-)\righ)
		\end{tikzcd}
	\end{equation*}
	in the quasi-category $\F(\Cc^\op\times\Cc,\cat{An})$.
\end{lem}
\begin{proof}[Proof sketch]
	First observe that if $\Cc'$ is another quasi-category, then $\Hom_{\Cc\times\Cc'}\simeq \Hom_\Cc\times\Hom_{\Cc'}$ holds in $\F((\Cc\times\Cc')^\op\times (\Cc\times\Cc'),\cat{An})$. Dependin on whether you use \cref{con:HomInTwoVariables} or \cref{con:HomTwAr}, this basically reduces to the observations that $\Ar(\Cc\times\Cc')\cong \Ar(\Cc)\times\Ar(\Cc')$ and $\TwAr(\Cc\times\Cc')\cong \TwAr(\Cc)\times\TwAr(\Cc')$, respectively, but in each case you need some model-category arguments to do the reduction, similar to the \enquote{inspection} in the proof of \cref{lem:HomRealityCheck}. We'll skip these arguments.
	
	Now we regard $\eta$ as a functor $\eta\colon \Delta^1\times\Cc\rightarrow \Dd$. Then \cref{lem:HomFunctorial} can be applied to $\eta$ to obtain a natural transformation
	\begin{equation*}
		\Hom_{\Delta^1\times\Cc}(-,-)\Longrightarrow \Hom_\Dd\lef(\eta(-),\eta(-)\righ)
	\end{equation*}
	in the functor quasi-category $\F((\Delta^1\times\Cc)^\op\times(\Delta^1\times\Cc),\cat{An})$. Applying the usual \enquote{currying} isomorphism, we obtain $\F((\Delta^1\times\Cc)^\op\times(\Delta^1\times\Cc),\cat{An})\cong \F((\Delta^1)^\op\times\Delta^1,\F(\Cc^\op\times\Cc,\cat{An}))$. Since $(\Delta^1)^\op\times\Delta^1\cong \Delta^1\times\Delta^1\cong \square^2$, an object in $\F((\Delta^1)^\op\times\Delta^1,\F(\Cc^\op\times\Cc,\cat{An}))$ corresponds to a commutative square in $\F(\Cc^\op\times\Cc,\cat{An})$. By unravelling the constructions, $\Hom_{\Delta^1\times\Cc}(-,-)$ corresponds to the following square:
	\begin{equation*}
		\begin{tikzcd}
			\Hom_\Cc(-,-)\times\Hom_{\Delta^1}(1,0)\doublear{r}\doublear{d}\drar[commutes] & \Hom_\Cc(-,-)\times \Hom_{\Delta^1}(1,1)\doublear{d}\\
			\Hom_\Cc(-,-)\times \Hom_{\Delta^1}(0,0)\doublear{r} & \Hom_\Cc(-,-)\times \Hom_{\Delta^1}(0,1)
		\end{tikzcd}
	\end{equation*}
	Indeed, this follows from the fact that $\Hom_{\Delta^1\times\Cc}\simeq \Hom_{\Delta^1}\times\Hom_\Cc$, as we've checked above; also note that $\Hom_{\Delta^1}(1,0)$ sits in the top left corner rather than $\Hom_{\Delta^1}(0,0)$ because of the way in which we identified $(\Delta^1)^\op\times\Delta^1$ with $\square^2$. Now observe that $\Hom_{\Delta^1}(1,0)\cong \emptyset$, whereas $\Hom_{\Delta^1}(0,0)\cong \Hom_{\Delta^1}(0,1)\cong \Hom_{\Delta^1}(1,1)\cong *$. This implies that the top left corner of the diagram above is $\const \emptyset$, whereas the other corners are given by $\Hom_\Cc(-,-)$. Similarly, $\Hom_\Dd(\eta(-),\eta(-))$ corresponds to the following commutative square:
	\begin{equation*}
		\begin{tikzcd}
			\Hom_\Dd\lef(G(-),F(-)\righ)\doublear["\eta_*"{black,above=0.1em}]{r}\doublear["\eta^*"{black,left=0.1em}]{d}\drar[commutes] & \Hom_\Dd\lef(G(-),G(-)\righ)\doublear["\eta^*"{black,right=0.1em}]{d}\\
			\Hom_\Dd\lef(F(-),F(-)\righ)\doublear["\eta_*"{black,above=0.1em}]{r} & \Hom_\Dd\lef(F(-),G(-)\righ)
		\end{tikzcd}
	\end{equation*}
	The natural transformation $\Hom_{\Delta^1\times\Cc}(-,-)\Rightarrow \Hom_\Dd\lef(\eta(-),\eta(-)\righ)$ from \cref{lem:HomFunctorial} corresponds to a morphism between these commutative squares. By inspection, this yields the desired commutative square.
\end{proof}
%The embedding version of Yoneda's lemma is now a simple consequence.
\begin{cor}\label{cor:YonedaEmbeddingFullyFaithful}
	For every quasi-category $\Cc$, the Yoneda embedding $\Yo_\Cc\colon \Cc\rightarrow\F(\Cc^\op,\cat{An})$ is fully faithful.
\end{cor}
\begin{proof}[Proof sketch]
	We must show that $\Yo_\Cc$ induces equivalences
	\begin{equation*}
		\Hom_\Cc(x,y)\overset{\simeq}{\longrightarrow} \Hom_{\F(\Cc^\op,\cat{An})}\lef(\Hom_\Cc(-,x),\Hom_\Cc(-,y)\righ)
	\end{equation*}
	for all $x,y\in\Cc$. It's clear from \cref{thm:Yoneda} that both sides are equivalent via evaluation at $\id_x$. If you go with \cref{con:HomInTwoVariables}, it's straightforward to see that the morphism induced by $\Yo_\Cc$ is an inverse to evaluation at $\id_x$, so it is an equivalence too. If you prefer \cref{con:HomTwAr}, this needs a little more work, which we omit.
\end{proof}
We finish this section with two final remarks.
\begin{numpar}[Model independence.]\label{par:ModelIndependence}
	Recall from \cref{par:ModelIndependenceIntro} that, at least in an ideal version of these notes, we planned to proceed via the following steps:
	\begin{alphanumerate}
		\item First, throughout \crefrange{sec:SimplicialSets}{sec:Straightening}, we would set up the framework of quasi-categories.\label{enum:SetupQuasicategoriesNotIntro}
		\item After that, we would identify a few key model-independent statements and prove (or black box) them in the model of quasi-categories.\label{enum:KeyStatementsNotIntro}
		\item Finally, starting from \cref{sec:InftyCategoryTheory}, all further proofs would be done in a model-independent fashion.\label{enum:AllProofsModelIndependentNotIntro}
	\end{alphanumerate}
	Step~\cref{enum:SetupQuasicategoriesNotIntro} is done by now, whereas step~\cref{enum:AllProofsModelIndependentNotIntro} lays ahead. So let's talk about what the key statements from step~\cref{enum:KeyStatementsNotIntro} are supposed to be. Of course, \cref{thm:EquivalencePointwise,thm:EquivalenceFullyFaithfulEssentiallySurjective} are among them, as are \cref{thm:Yoneda} as well as Lemmas~\labelcref{lem:HomRealityCheck}, \labelcref{lem:HomFunctorial}, and \labelcref{lem:HomNaturalTransformation}. In each of these cases, it's clear that the statement is really a model-independent one, even though we formulated them in the model of quasi-categories. Somewhat surprisingly though, \cref{thm:Straightening} can also be reformulated in a model-independent way. In particular, there are model-independent definitions of cocartesian and left fibrations! Indeed, if $p\colon \Uu\rightarrow \Cc$ is a functor of $\infty$-categories, \cref{lem:CocartesianMorphisms} provides a model-independent definition of a morphism $\varphi\colon u\rightarrow v$ in $\Uu$ being $p$-cocartesian. The condition that cocartesian lifts exist (\cref{def:Cocartesian}\cref{enum:CocartesianFibration}) can be replaced by the condition that
	\begin{equation*}
		\begin{tikzcd}
			\Ar_{p\mhyph\mathrm{cocart}}(\Uu)\rar\dar\drar[pullback] & \Ar(\Cc)\dar["s"]\\
			\Uu\rar["p"] & \Cc
		\end{tikzcd}
	\end{equation*}
	is a pullback in $\cat{Cat}_\infty$, where $\Ar_{p\mhyph\mathrm{cocart}}(\Uu)\subseteq \Ar(\Uu)$ is the full sub-$\infty$-category spanned by the $p$-cocartesian morphisms. Finally, in light of \cref{lem:CocartesianLeft}, we can redefine $p$ to be a \emph{left fibration} if it is a cocartesian fibration and $\Ar_{p\mhyph\mathrm{cocart}}(\Uu)\subseteq \Ar(\Uu)$ is an equivalence of $\infty$-categories. This new definition recovers \cref{def:Cocartesian} in the following sense: A functor $p\colon \Uu\rightarrow \Cc$ of quasi-categories is a cocartesian fibration in the new sense if and only if $\Uu'\rightarrow \Cc$ is a cocartesian fibration in the old sense, where $p\colon \Uu\rightarrow \Uu'\rightarrow \Cc$ is any factorisation into an equivalence followed by an isofibration. A proof of this uses \cref{thm:EquivalenceFullyFaithfulEssentiallySurjective} and is not particularly difficult. You can find it in my notes on Fabian's $\K$-Theory lecture, see \cite[Lemma*~\href{https://florianadler.github.io/AlgebraBonn/KTheory.pdf\#smallerdummy.1.24.2}{I.24$b$}]{KTheory}.
	
	In particular, \cref{thm:Straightening} can be reinterpreted as a model-independent statement about an equivalence of $\infty$-categories $\cat{Cocart}(\Cc)\simeq \Fun(\Cc,\cat{Cat}_\infty)$ for any $\infty$-category $\Cc$. This statement absolutely belongs to step~\cref{enum:KeyStatementsNotIntro} and it will play a much more prominent role in our treatment of $\infty$-categories than it does in ordinary category theory.
	
	The example of cocartesian and left fibrations is only the first of many instances where our constructions with quasi-categories can be retconned into model-independent constructions. We'll see more of that in model category fact~\cref{par:HomotopyPushout}.
	%Furthermore, once we know how to define pullbacks in $\infty$-categories (\cref{def:Colimits}), we see that the pullback diagram from \cref{par:HomInQuasiCategories} defining $\Cc_{x/}$ and $\Hom_\Cc(x,y)$ is also a pullback in $\cat{Cat}_\infty$; this follows from model category fact~\cref{par:HomotopyPullback} since $(s,t)\colon\Ar(\Cc)\rightarrow \Cc\times\Cc$ is an isofibration (see the argument in the proof of \cref{lem:HomRealityCheck}). So our definitions of $\Cc_{x/}$ and $\Hom_\Cc(x,y)$ immediately generalise to any other model.
\end{numpar}
\begin{numpar}[Functoriality of the Yoneda lemma.]\label{par:YonedaFunctorial}
	Let $\Cc$ be a quasi-category. Let's write $\Fun(\Cc^\op,\cat{An})\eqqcolon \PSh(\Cc)$ for the \emph{$\infty$-category of presheaves on $\Cc$} (note that this is \emph{not} compatible with the previous definition if $\Cc$ is an ordinary category). For an object $x\in\Cc$ and a presheaf $E\colon \Cc^\op\rightarrow \cat{An}$, the dual of \cref{thm:Yoneda} tells us that
	\begin{equation*}
		\ev_{\id_x}\colon \Hom_{\PSh(\Cc)}\lef(\Yo_\Cc(x),E\righ)\overset{\simeq}{\longrightarrow}E(x)
	\end{equation*}
	is an equivalence. It turns out that this equivalence is functorial both in $x$ and in $E$. Of course, thanks to \cref{thm:EquivalencePointwise}, the only difficulty lies in making the map $\ev_{\id_x}$ functorial. It's straightforward to make it functorial in $E$, but I couldn't find any easy argument for functoriality in $x$. So if you do, please tell me!
	
	One way of producing this natural transformation is to construct it on the level of simplicially enriched functors. Implicitly, this also requires that the construction of $\Hom_\Cc\colon \Cc^\op\times\Cc\rightarrow \cat{An}$ via simplicially enriched functors agrees with our construction; at least in the case of \cref{con:HomTwAr}, this was done by Lurie \cite[Proposition~\HAthm{5.2.1.11}]{HA}. A somewhat nicer argument, which is at least model-independent (but uses results from \cref{sec:InftyCategoryTheory}), goes as follows: Let's instead construct an inverse of $\ev_{\id_x}$ in a functorial way. That is, we are looking for a natural transformation
	\begin{equation*}
		\eta\colon\id_{\PSh(\Cc)}\Longrightarrow\Hom_{\PSh(\Cc)}\lef(\Yo_\Cc(-),-\righ)\,.
	\end{equation*}
	We'll see in \cref{lem:PresheafColimitOfRepresentables} that $\id_{\PSh(\Cc)}$ is the $\infty$-categorical left Kan extension of $\Yo_\Cc$ along itself. So it's enough to construct a natural transformation $\Yo_\Cc\Rightarrow \Yo_\Cc^*\Hom_{\PSh(\Cc)}(\Yo_\Cc(-),-)$; this can be taken to be the image of the natural transformation $\Hom_\Cc(-,-)\Rightarrow \Hom_{\PSh(\Cc)}(\Yo_\Cc(-),\Yo_\Cc(-))$ from \cref{lem:HomFunctorial} under the \enquote{currying} equivalence $\Fun(\Cc^\op\times\Cc,\cat{An})\simeq \Fun(\Cc,\PSh(\Cc))$. As far as I can see, this should work and it shouldn't lead to any circular arguments.
\end{numpar}



